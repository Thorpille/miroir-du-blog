<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Sam &#38; Max &#187; variables</title>
	<atom:link href="http://sametmax.com/tag/variables/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Du code, du cul</description>
	<lastBuildDate>Sat, 07 Nov 2015 10:56:13 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=4.1</generator>
	<item>
		<title>Si vous ne savez pas ce que contient une variable, vous ne comprenez pas le programme 11</title>
		<link>http://sametmax.com/si-vous-ne-savez-pas-ce-que-contient-une-variable-vous-ne-comprenez-pas-le-programme/</link>
		<comments>http://sametmax.com/si-vous-ne-savez-pas-ce-que-contient-une-variable-vous-ne-comprenez-pas-le-programme/#comments</comments>
		<pubDate>Tue, 12 Feb 2013 13:41:27 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Philo et culture]]></category>
		<category><![CDATA[Programmation]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[variables]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=4521</guid>
		<description><![CDATA[L'immense majorité des questions qu'on me pose sur le fonctionnement d'un programme (ou sur des détails dans les tutos) peut être résolu d'une seule manière. ]]></description>
				<content:encoded><![CDATA[<p>L&#8217;immense majorité des questions qu&#8217;on me pose sur le fonctionnement d&#8217;un programme (ou sur des détails dans les tutos) peut être résolu d&#8217;une seule manière. </p>
<p>En sachant ce qu&#8217;il y a dans les variables.</p>
<p>Un ordinateur est une machine à états. Les variables représentent cet état. Le seul moyen de comprendre ce que fait un programme, c&#8217;est de savoir à quel moment il est dans quel état.</p>
<p>Quand vous ne comprenez pas ce que fait un programme, la première et plus importante question à vous poser et donc :</p>
<p><strong>Que contient cette variable ?</strong></p>
<h2>Répondre à la question</h2>
<p>La beauté de Python, c&#8217;est qu&#8217;il vous permet de très facilement répondre à cette question par vous même. Tout ce que vous avez à faire c&#8217;est copier le code, le mettre dans un fichier (ou un shell), et le lancer.</p>
<p><strong>Ne restez pas passif devant un tuto.</strong> Vous n&#8217;en comprendrez que la moitié (au mieux).</p>
<p>Un tuto, une doc, un cours, un snippet ne se lit pas, il se travaille. </p>
<p>Voici tout ce que vous pouvez faire à une variable pour obtenir des informations sur elle :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> i <span style="color: #66cc66;">=</span> <span style="color: #ff4500;">1</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># afficher la variable</span>
<span style="color: #ff4500;">1</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #008000;">type</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># afficher son type</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'int'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>i.__class__<span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># afficher la classe dont elle est issue</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'int'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>i.__class__.__name__<span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># affiche le nom de sa classe</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #008000;">dir</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># afficher les méthodes de cet objet</span>
<span style="color: black;">&#91;</span><span style="color: #483d8b;">'__abs__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__add__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__and__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__class__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__cmp__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__coerce__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__delattr__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__div__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__divmod__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__doc__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__float__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__floordiv__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__format__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__getattribute__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__getnewargs__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__hash__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__hex__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__index__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__init__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__int__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__invert__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__long__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__lshift__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__mod__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__mul__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__neg__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__new__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__nonzero__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__oct__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__or__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__pos__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__pow__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__radd__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rand__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rdiv__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rdivmod__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__reduce__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__reduce_ex__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__repr__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rfloordiv__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rlshift__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rmod__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rmul__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__ror__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rpow__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rrshift__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rshift__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rsub__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rtruediv__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__rxor__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__setattr__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__sizeof__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__str__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__sub__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__subclasshook__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__truediv__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__trunc__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'__xor__'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'bit_length'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'conjugate'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'denominator'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'imag'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'numerator'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'real'</span><span style="color: black;">&#93;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">help</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># aide sur cet objet</span>
Help on <span style="color: #008000;">int</span> <span style="color: #008000;">object</span>:
&nbsp;
<span style="color: #ff7700;font-weight:bold;">class</span> <span style="color: #008000;">int</span><span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>
 |  <span style="color: #008000;">int</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#91;</span><span style="color: #66cc66;">,</span> base<span style="color: black;">&#93;</span><span style="color: black;">&#41;</span> -<span style="color: #66cc66;">&gt;</span> integer
 |  
 |  Convert a <span style="color: #dc143c;">string</span> <span style="color: #ff7700;font-weight:bold;">or</span> number to an integer<span style="color: #66cc66;">,</span> <span style="color: #ff7700;font-weight:bold;">if</span> possible.  <span style="color: black;">A</span> floating point
 |  argument will be truncated towards zero <span style="color: black;">&#40;</span>this does <span style="color: #ff7700;font-weight:bold;">not</span> include a <span style="color: #dc143c;">string</span>
 |  representation of a floating point number<span style="color: #66cc66;">!</span><span style="color: black;">&#41;</span>  When converting a <span style="color: #dc143c;">string</span><span style="color: #66cc66;">,</span> use
 |  the optional base.  <span style="color: black;">It</span> <span style="color: #ff7700;font-weight:bold;">is</span> an error to supply a base when converting a
 |  non-<span style="color: #dc143c;">string</span>.  <span style="color: black;">If</span> base <span style="color: #ff7700;font-weight:bold;">is</span> zero<span style="color: #66cc66;">,</span> the proper base <span style="color: #ff7700;font-weight:bold;">is</span> guessed based on the
 |  <span style="color: #dc143c;">string</span> content.  <span style="color: black;">If</span> the argument <span style="color: #ff7700;font-weight:bold;">is</span> outside the integer <span style="color: #008000;">range</span> a
 |  <span style="color: #008000;">long</span> <span style="color: #008000;">object</span> will be returned instead.
 |  
 |  Methods defined here:
 |  
 |  <span style="color: #0000cd;">__abs__</span><span style="color: black;">&#40;</span>...<span style="color: black;">&#41;</span>
 |      x.<span style="color: #0000cd;">__abs__</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: #66cc66;">&lt;==&gt;</span> <span style="color: #008000;">abs</span><span style="color: black;">&#40;</span>x<span style="color: black;">&#41;</span>
...</pre></td></tr></table></div>

<p>Ces informations répondent à la question &#8220;qu&#8217;est-ce que c&#8217;est&#8221;, &#8220;comment c&#8217;est configuré&#8221; et &#8220;qu&#8217;est-ce que ça peut faire&#8221;.</p>
<p>C&#8217;est très important. Vous ne pouvez pas comprendre ce que fait un programme sans ces informations.</p>
<h2>En Python une variable peut contenir n&#8217;importe quoi</h2>
<p>J&#8217;ai dis <strong>n&#8217;importe quoi</strong>.</p>
<p>Pas juste les types de base :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> i <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'a'</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'str'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> i <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'dict'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> i <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: black;">&#93;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'list'</span><span style="color: #66cc66;">&gt;</span></pre></td></tr></table></div>

<p>Ni même juste des résultats de fonctions :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> i <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">test</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'int'</span><span style="color: #66cc66;">&gt;</span></pre></td></tr></table></div>

<p>Non. Les variables Python peuvent contenir <strong>les fonctions elles-même</strong> !</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">test</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'function'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> i <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">test</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> i<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #ff4500;">1</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'function'</span><span style="color: #66cc66;">&gt;</span></pre></td></tr></table></div>

<p>Et là ça devient important de savoir de quoi on parle :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> i.__name__
<span style="color: #483d8b;">'test'</span></pre></td></tr></table></div>

<p>Mais les variables peuvent aussi contenir des instances de vos classes :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">class</span> Essai<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
...     <span style="color: #ff7700;font-weight:bold;">pass</span>
... 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> i <span style="color: #66cc66;">=</span> Essai<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>i<span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #ff7700;font-weight:bold;">class</span> <span style="color: #483d8b;">'__main__.Essai'</span><span style="color: #66cc66;">&gt;</span></pre></td></tr></table></div>

<p>Sauf que les variables peuvent aussi contenir <strong>les classes elles-même</strong> !</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>Essai<span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># les classes sont de type 'type'. Funky !</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'type'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> i <span style="color: #66cc66;">=</span> Essai <span style="color: #808080; font-style: italic;"># ceci n'est PAS une instance. Ce n'est PAS Essai().</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>Essai<span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'type'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> i.__class__
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'type'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> i.__name__
<span style="color: #483d8b;">'Essai'</span></pre></td></tr></table></div>

<p>Les fonctions et les classes ne sont pas juste des noms en Python. Ce sont des choses que vous pouvez manipuler. Donc on les retrouve dans des variables.   </p>
<p>Donc vous n&#8217;avez pas le choix. Vous devez savoir de quoi on parle. Et il faut donc bien comprendre ce qu&#8217;est un type, et qu&#8217;est-ce qui est de quel type :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span><span style="color: #008000;">str</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># str est une classe</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'type'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span><span style="color: #008000;">str</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># le résultat de l'appel de str est une string</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'str'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>Essai<span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># Essai est une classe</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'type'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>Essai<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># le résultat de l'appel de Essai est un objet Essai</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #ff7700;font-weight:bold;">class</span> <span style="color: #483d8b;">'__main__.Essai'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'1'</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># '1' est une string</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'str'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># 1 est un int</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'int'</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span><span style="color: #008000;">True</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&lt;</span><span style="color: #008000;">type</span> <span style="color: #483d8b;">'bool'</span><span style="color: #66cc66;">&gt;</span> <span style="color: #808080; font-style: italic;"># True est un boolean</span></pre></td></tr></table></div>

<p>Si vous ne comprenez pas les types, vous ne pouvez PAS comprendre un programme. </p>
<p>Ce n&#8217;est pas honteux. Arrêtez d&#8217;essayer un truc impossible, c&#8217;est tout. Revenez en arrière. Allez apprendre ce qu&#8217;est un type x ou z. </p>
<p>Puis retournez essayer de comprendre le programme. </p>
<p>Il n&#8217;y a PAS d&#8217;alternative.</p>
<p> <strong>Quand vous lisez un programme, vous devez savoir ce qu&#8217;il y a dans une variable</strong> :</p>
<ul>
<li>quel est son type ?</li>
<li>quelle est sa valeur ?</li>
<li>qu&#8217;est-ce que je peux faire avec (méthodes, attributs, etc) ?</li>
</ul>
<h2>Pdb à la rescousse</h2>
<p>Donc quand vous lisez un tuto, vous allez copier / coller du code. Vous allez le lancer. Si vous ne le faites pas, vous ne comprendrez pas.</p>
<p>Maintenant, dans un premier temps vous allez utiliser des print.</p>
<p><code>print type(truc)<br />
print truc.__class__<br />
print dir(truc)</code></p>
<p>Et pour les fonctions et les classes :</p>
<p><code>print truc.__name__</code></p>
<p>Mais on peut faire mieux. Utilisez le debugger de Python intégré : PDB. J&#8217;ai écrit <a href="http://sametmax.com/debugger-en-python-les-bases-de-pdb/">un bon article sur la question</a>, mais pour résumer, quand vous voulez avoir des informations sur une variable dans un programme, juste avant la variable faites :</p>
<p><code>import ipdb; ipdb.set_trace()</code></p>
<p>Puis lancez le programme. Un shell va s&#8217;ouvrir, bloquant le programme à cet endroit. Et vous pourrez manipuler la variable <strong>à ce moment du programme</strong>.</p>
<p>Pour quitter, entrez <code>q</code>.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/si-vous-ne-savez-pas-ce-que-contient-une-variable-vous-ne-comprenez-pas-le-programme/feed/</wfw:commentRss>
		<slash:comments>11</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2013/02/inside-a-jet-engine.jpg" length="694476" type="image/jpg" />	</item>
		<item>
		<title>Valeurs et références en Python 21</title>
		<link>http://sametmax.com/valeurs-et-references-en-python/</link>
		<comments>http://sametmax.com/valeurs-et-references-en-python/#comments</comments>
		<pubDate>Mon, 12 Nov 2012 19:28:28 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[variables]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=2869</guid>
		<description><![CDATA[Il y a plusieurs manière de passer une variable en informatique: par valeur ou par référence. Et dans les langages bas niveau comme le C, on se pose la question: "passe-t-on la valeur ? un pointer ? un pointer vers un pointer ?"

En Python ce n'est pas la question puisque tout se passe référence. Tous les objets. Dans tous les cas.

La question est donc plutôt: "ça veut dire quoi passer par référence ?"]]></description>
				<content:encoded><![CDATA[<p>Petit article en complément de <a href="http://sametmax.com/id-none-et-bidouilleries-memoire-en-python/">l&#8217;article de Réchèr</a>.</p>
<p>Il y a plusieurs manières de passer une variable en informatique: par valeur ou par référence. Et dans les langages bas niveau comme le C, on se pose la question: &#8220;passe-t-on la valeur ? un pointer ? un pointer vers un pointer ?&#8221;</p>
<p>En Python ce n&#8217;est pas la question puisque tout se passe par référence. Tous les objets. Dans tous les cas.</p>
<p>La question est donc plutôt: &#8220;ça veut dire quoi passer par référence ?&#8221;</p>
<h2>Assignation et référence</h2>
<p>Une référence est comme une adresse qui dit où la donnée se trouve en mémoire.</p>
<p>Quand vous faites ceci:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;">a <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">2</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span></pre></td></tr></table></div>

<p>Vous n&#8217;assignez pas la liste à la variable &#8220;a&#8221;, vous assignez une référence vers la liste, donc une sorte d&#8217;adresse qui indique où elle se trouve en mémoire. (en vérité vous n&#8217;assignez rien, les variables sont des étiquettes en Python, mais on va ignorer ce détail ici).</p>
<p>Et quand vous faites:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">print</span> a</pre></td></tr></table></div>

<p>Python va chercher dans <code>a</code> la référence, et retrouver la liste en suivant &#8220;l&#8217;adresse&#8221;.</p>
<p>C&#8217;est important car ça veut dire deux choses.</p>
<p>1. Quand vous faites ça:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;">b <span style="color: #66cc66;">=</span> a</pre></td></tr></table></div>

<p>Vous ne copiez pas la liste. Vous copiez la référence. Du coup, on ne prend pas deux fois la place en mémoire, et la copie est très rapide</p>
<p>2. Quand vous faites ça:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;">b <span style="color: #66cc66;">=</span> a</pre></td></tr></table></div>

<p>Vous ne copiez pas la liste. Vous copiez la référence. Bis.</p>
<p>Et si vous faites:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;">b.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Alors:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">print</span> a</pre></td></tr></table></div>

<p>Va donner&#8230;</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">2</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">3</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span></pre></td></tr></table></div>

<p>Car en faisant <code>append()</code> sur <code>b</code>, Python va trouver une référence, retrouver la liste derrière la référence, et faire un <code>append()</code> sur la liste. Comme c&#8217;est la même réference dans <code>a</code> et <code>b</code> (puisqu&#8217;on l&#8217;a copié), c&#8217;est la même liste derrière. Tout ce qu&#8217;on applique à <code>a</code>, s&#8217;applique donc à <code>b</code>, et vice-versa.</p>
<p>Si vous voulez faire une vraie copie, alors il faut recréer une toute nouvelle liste. Par exemple:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;">b <span style="color: #66cc66;">=</span> <span style="color: #008000;">list</span><span style="color: black;">&#40;</span>a<span style="color: black;">&#41;</span></pre></td></tr></table></div>

<h2>Mutable et non mutable</h2>
<p>L&#8217;assignation par référence n&#8217;a vraiment d&#8217;importance que dans le cas où un objet est mutable. En Python, il existe en effet deux types d&#8217;objets: les mutables (listes, dictionnaires, sets, objets custo, etc) et les nons mutables (strings, int, floats, tuples, etc).</p>
<p>Les mutables sont ceux qu&#8217;on peut modifier après leur création. Les non mutables sont ceux qu&#8217;on ne peut pas modifier après création.</p>
<p>On ne peut pas modifier <code>152</code> un fois que l&#8217;objet int est créé. Mais on peut rajouter des éléments à une liste après qu&#8217;elle soit créé. Les ints sont non mutables. Les lists sont mutables.</p>
<p>Cela peut surprendre, mais les strings sont non mutables. Même quand vous faites:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> pa <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">&quot;papa&quot;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> pi <span style="color: #66cc66;">=</span> pa.<span style="color: black;">replace</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;a&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">&quot;i&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span> pa
papa
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span> pi
pipi</pre></td></tr></table></div>

<p>Vous ne modifiez pas la chaîne originale: vous créé une copie de la chaîne, et la chaîne de départ n&#8217;a pas bougé.</p>
<p>C&#8217;est important car si on fait une référence vers un type non mutable, on s&#8217;en oint le pourtour anale avec pelle à tarte: il ne peut pas être modifié. Peu importe que la référence soit copiée à droite et à gauche. Mais si l&#8217;objet est mutable, chaque copie de la référence ajoute un endroit dans le programme duquel on peut modifier l&#8217;objet.</p>
<p>Cela a des implications parfois assez coquines.</p>
<p>Ainsi:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> l <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span> * <span style="color: #ff4500;">3</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> l <span style="color: #808080; font-style: italic;"># une liste de 3 zéros</span>
<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> l<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span> +<span style="color: #66cc66;">=</span> <span style="color: #ff4500;">1</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> l
<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span></pre></td></tr></table></div>

<p>Ici tout se comporte comme prévu. Les ints sont non mutables, donc on ne s’aperçoit pas d&#8217;un détail important: <code>[0] * 3</code> copie la référence à <code>0</code> trois fois. Quand on fait <code>+=</code>, ça remplace l&#8217;ancien int par un nouveau, donc un seul item de la liste est changé.</p>
<p>Mais si on fait vicieusement:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> l <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#93;</span> * <span style="color: #ff4500;">3</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> l <span style="color: #808080; font-style: italic;"># une liste de listes d'un seul zéro chacune</span>
<span style="color: black;">&#91;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> <span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> <span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#93;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> l<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span> +<span style="color: #66cc66;">=</span> <span style="color: #ff4500;">1</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> l
<span style="color: black;">&#91;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> <span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> <span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#93;</span></pre></td></tr></table></div>

<p>Ici on a copié 3 fois la référence vers la même liste. Du coup une modification affecte les 3 items. Doh.</p>
<p>Rappels: les tuples ne sont pas mutables. Et on peut passer d&#8217;un tuple à une liste avec <code>tuple(l)</code> et <code>list(t)</code>. Pensez-y si vous rencontrez ce genre de problème.</p>
<h2>Passage des arguments de fonction par référence</h2>
<p>Quand vous faites cela:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> encore_une_fonction_d_exemple_inutile<span style="color: black;">&#40;</span>l<span style="color: black;">&#41;</span>:
    l.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> l
&nbsp;
<span style="color: #66cc66;">&gt;&gt;&gt;</span> l1 <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">2</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> encore_une_fonction_d_exemple_inutile<span style="color: black;">&#40;</span>l1<span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span> l1
<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">2</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">3</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span></pre></td></tr></table></div>

<p>Vous noterez que la liste a été modifiée. C&#8217;est parce que l&#8217;on passe une référence à la liste quand on la passe en argument. Toute modification de la liste dans la fonction est donc visible en dehors de la fonction. Si le paramètre était immutable, encore une fois on s&#8217;en ficherait. Mais là, comme liste est mutable, notre fonction possède ce qu&#8217;on nomme un effet de bord: quand on l&#8217;appelle, elle a des conséquences sur des objets qui existe en dehors d&#8217;elle même.</p>
<p>Il est généralement de bon ton d&#8217;éviter les effets de bord, aussi, essayez toujours de travailler sur des copies: utilisez le slicing, les listes en intention, les générateurs, etc., pour retourner les nouvelles valeurs plutôt que de modifier l&#8217;objet original.</p>
<p>Ici:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> encore_une_fonction_d_exemple_inutile<span style="color: black;">&#40;</span>l<span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">return</span> l1 + <span style="color: black;">&#91;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span></pre></td></tr></table></div>

<p>Nous permet de retourner une nouvelle liste. Si la liste prend beaucoup de place en mémoire, on peut faire ça:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> encore_une_fonction_d_exemple_inutile<span style="color: black;">&#40;</span>l<span style="color: black;">&#41;</span>:
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">for</span> x <span style="color: #ff7700;font-weight:bold;">in</span> l:
        <span style="color: #ff7700;font-weight:bold;">yield</span> x
    <span style="color: #ff7700;font-weight:bold;">yield</span> <span style="color: #ff4500;">4</span></pre></td></tr></table></div>

<p>Ce qui aurait pour effet de retourner un itérable similaire, sans prendre plus de mémoire.</p>
<h2>Valeurs par défaut et référence</h2>
<p>Quand on utilise une valeur par défaut, par exemple dans la déclaration des paramètres d&#8217;une fonction, on initialise une référence qui va rester la même pour toute la durée du programme.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> encore_une_fonction_d_exemple_inutile<span style="color: black;">&#40;</span>l<span style="color: #66cc66;">=</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">2</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span>:
    l.<span style="color: black;">append</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">4</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> l
&nbsp;
<span style="color: #66cc66;">&gt;&gt;&gt;</span> encore_une_fonction_d_exemple_inutile<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> encore_une_fonction_d_exemple_inutile<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span> l1
<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">2</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">3</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">4</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">4</span><span style="color: black;">&#93;</span></pre></td></tr></table></div>

<p>On constate ici que <code>4</code> a été ajouté deux fois dans la liste. En effet, l est l&#8217;argument par défaut, et ici, il est initialisé à la référence pointant sur une liste <code>[1, 2, 3]</code>. Pas sur la valeur <code>[1, 2, 3]</code>. <code>[1, 2, 3]</code> est stocké quelque part dans un monde invisible que seul Guido Van Rossum connait, et <code>l</code> contient juste la référence à cette liste.</p>
<p>Cette référence est gardée, et à chaque appel, c&#8217;est la même liste qui est utilisée. Si on appelle deux fois la fonction, la première fois c&#8217;est la liste <code>[1, 2, 3, 4]</code> à laquelle on ajoute <code>4</code>. Puis comme c&#8217;est la même référence, on ajoute ensuite <code>4</code> à la même liste, à laquelle on avait déjà ajouté <code>4</code>.</p>
<p>Bref, évitez les mutables dans les paramètres par défaut à moins de savoir ce que vous faites (cache ou memoization).</p>
<h2>Variables de classe et références</h2>
<p>La même problématique existe pour les classes. Si vous faites:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">class</span> AuChocolat<span style="color: black;">&#40;</span>objet<span style="color: black;">&#41;</span>:
&nbsp;
    supplements <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: #483d8b;">'chantilly'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'praline'</span><span style="color: black;">&#93;</span>
&nbsp;
<span style="color: #66cc66;">&gt;&gt;&gt;</span> g1 <span style="color: #66cc66;">=</span> AuChocolat<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> g2 <span style="color: #66cc66;">=</span> AuChocolat<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> g1.<span style="color: black;">supplements</span>.<span style="color: black;">pop</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #483d8b;">'praline'</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> g2.<span style="color: black;">supplements</span>
<span style="color: black;">&#91;</span><span style="color: #483d8b;">'chantilly'</span><span style="color: black;">&#93;</span></pre></td></tr></table></div>

<p>Même principe: toute variable de classe pointe pour toute la durée du programme sur la même réference. La référence va être partagée entre toutes les instances de la classe. C&#8217;est donc la même liste !</p>
<h2>Maintient d&#8217;une référence</h2>
<p>Python garde un objet en mémoire tant qu&#8217;il existe une référence vers cet objet.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> a <span style="color: #66cc66;">=</span> <span style="color: #ff4500;">1</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> b <span style="color: #66cc66;">=</span> a
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">del</span> a
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span> b
<span style="color: #ff4500;">1</span></pre></td></tr></table></div>

<p>Si je supprime <code>a</code>, il reste <code>b</code>, donc l&#8217;objet est toujours en mémoire. Si je supprime <code>b</code> également, Python va lancer le processus de nettoyage pour effacer l&#8217;objet de la mémoire.</p>
<p>Une référence existe toujours dans le cadre d&#8217;un scope. Par exemple, si une référence est copiée dans une fonction, quand la fonction se termine, la copie de la référence est supprimée, et ne compte plus comme une voix pour le maintient de l&#8217;objet en mémoire.</p>
<p>En Python, il n&#8217;existe donc aucun moyen de supprimer un objet. On peut juste supprimer toutes ses références, et attendre que Python s&#8217;aperçoive que tout le monde s&#8217;en branle à présent de l&#8217;objet, et le supprime.</p>
<p>Dans certains cas particuliers, on veut qu&#8217;une référence à un objet ne compte pas comme une voix. On peut le faire en utilisant le module <code>weakref</code>, mais cela ne marche qu&#8217;avec les classes que l&#8217;on code soit-même.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">class</span> ALaVanille<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">pass</span>
&nbsp;
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">weakref</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> g1 <span style="color: #66cc66;">=</span> ALaVanille<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> g2 <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">weakref</span>.<span style="color: black;">proxy</span><span style="color: black;">&#40;</span>g1<span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> g2
<span style="color: #66cc66;">&lt;</span>weakproxy at <span style="color: #ff4500;">0x7f5f26994730</span> to ALaVanille at <span style="color: #ff4500;">0x7f5f26992d90</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> g1.<span style="color: black;">foo</span> <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">&quot;bar&quot;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> g2.<span style="color: black;">foo</span>
<span style="color: #483d8b;">'bar'</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">del</span> g1
<span style="color: #66cc66;">&gt;&gt;&gt;</span> g2
<span style="color: #66cc66;">&lt;</span>weakproxy at <span style="color: #ff4500;">0x7f5f26994730</span> to NoneType at <span style="color: #ff4500;">0x859380</span><span style="color: #66cc66;">&gt;</span></pre></td></tr></table></div>

<p>Dès qu&#8217;on supprime <code>g1</code>, <code>g2</code> proxy vers <code>None</code>, car la référence vers l&#8217;instance de <code>ALaVanille</code> ne compte pas pour garder en vie l&#8217;objet.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/valeurs-et-references-en-python/feed/</wfw:commentRss>
		<slash:comments>21</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2012/11/th1.jpeg" length="8700" type="image/jpg" />	</item>
	</channel>
</rss>

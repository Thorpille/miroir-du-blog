<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Sam &#38; Max &#187; bottlepy</title>
	<atom:link href="http://sametmax.com/tag/bottlepy/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Du code, du cul</description>
	<lastBuildDate>Sat, 07 Nov 2015 10:56:13 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=4.1</generator>
	<item>
		<title>Créer un site avec bottle en 5 minutes (parceque 7 c&#8217;est impossible voyons !) 17</title>
		<link>http://sametmax.com/creer-un-site-avec-bottle-en-5-minutes-parceque-7-cest-impossible-voyons/</link>
		<comments>http://sametmax.com/creer-un-site-avec-bottle-en-5-minutes-parceque-7-cest-impossible-voyons/#comments</comments>
		<pubDate>Mon, 13 Aug 2012 03:55:28 +0000</pubDate>
		<dc:creator><![CDATA[Max]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[bottle]]></category>
		<category><![CDATA[bottlepy]]></category>
		<category><![CDATA[framework]]></category>
		<category><![CDATA[micro-framework]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=1660</guid>
		<description><![CDATA[On a tous plein d'idées, et souvent des idées de petits sites qu'on aimerait réaliser dans la nuit, sans se faire chier, et si possible que quand on revient dans 3 mois on sache s'y retrouver. Bottle est là pour vous, vos prières ont été exhaussées, Amen...]]></description>
				<content:encoded><![CDATA[<p>Aller bande de feignasses c&#8217;est Lundi on oublie la murge du week-end et on se secoue les neuronnes !</p>
<p><a href="http://bottlepy.org/">Bottle</a> est un micro-framework python sur lequel Sam m&#8217;a obligé de bosser après Django, (il me force à évoluer c&#8217;est une horreur). Je dois dire que je le regrette pas car c&#8217;est diablement efficace, mignon et tout et tout.</p>
<p>En début de semaine je me suis dit qu&#8217;il fallait que j&#8217;en parle, je vais donc vous montrer comment on peut développer un &#8220;site&#8221; simple en 5 minutes structuré et sans se prendre le choux. Sam viendra compléter mes oublis.</p>
<p>Je ne vais pas aborder la base de données mais il y a plein de <a href="http://bottlepy.org/docs/dev/plugins/index.html">plugins bottle ici</a> dont un ORM pour sqlite qu&#8217;on détaillera dans un article le jour où on s&#8217;en servira ;)</p>
<p>Avant de commencer: Pourquoi je l&#8217;aime ?</p>
<ul>
<li>Simple à comprendre</li>
<li>bien structuré (des vues des templates, un routing clair)</li>
<li>gestion des urls fastoches</li>
<li>un petit serveur web intégré, on démarre son site en 10 secondes et on debug avec <a href="http://sametmax.com/debugger-en-python-les-bases-de-pdb/" >ipdb</a></li>
<li>une <a href="http://bottlepy.org/docs/dev/tutorial.html#quickstart-hello-world">doc</a> formidabuleuse avec des exemples concrets</li>
<li>il cracke les watts</li>
</ul>
<p><b>En route simone !</b></p>
<p>On prend la bite rude de créer un environnement virtuel et on fait un <code><a href="http://sametmax.com/votre-python-aime-les-pip/">pip</a> install bottl</code>e. Pour ceux qui veulent tout saloper faites juste un <code>pip install bottle,</code> pour ceux qui savent pas ce qu&#8217;est &#8220;pip&#8221; faites un &#8220;wget http://bottlepy.org/bottle.py&#8221; dans le dossier de votre projet.</p>
<p><b>je veux que ça marche tout de suite !</b></p>
<p>Editez un fichier python start.py à la racine de votre projet et collez ça dedans:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">from</span> bottle <span style="color: #ff7700;font-weight:bold;">import</span> Bottle<span style="color: #66cc66;">,</span> run
&nbsp;
app <span style="color: #66cc66;">=</span> Bottle<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #66cc66;">@</span>app.<span style="color: black;">route</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'/'</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> hello<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">&quot;Max est le plus beau!&quot;</span>
&nbsp;
run<span style="color: black;">&#40;</span>app<span style="color: #66cc66;">,</span> host<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'localhost'</span><span style="color: #66cc66;">,</span> port<span style="color: #66cc66;">=</span><span style="color: #ff4500;">8080</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>maintenant dans le shell tapez dans le dossier de votre projet où se trouve start.py:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">python start.py 
Bottle server starting up <span style="color: #7a0874; font-weight: bold;">&#40;</span>using WSGIRefServer<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>...
Listening on http:<span style="color: #000000; font-weight: bold;">//</span>localhost:<span style="color: #000000;">8080</span><span style="color: #000000; font-weight: bold;">/</span>
Hit Ctrl-C to quit.
&nbsp;
localhost - - <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">12</span><span style="color: #000000; font-weight: bold;">/</span>Aug<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">2012</span> <span style="color: #000000;">23</span>:<span style="color: #000000;">12</span>:<span style="color: #000000;">15</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #ff0000;">&quot;GET / HTTP/1.1&quot;</span> <span style="color: #000000;">200</span> <span style="color: #000000;">21</span>
localhost - - <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">12</span><span style="color: #000000; font-weight: bold;">/</span>Aug<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">2012</span> <span style="color: #000000;">23</span>:<span style="color: #000000;">12</span>:<span style="color: #000000;">16</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #ff0000;">&quot;GET /favicon.ico HTTP/1.1&quot;</span> <span style="color: #000000;">404</span> <span style="color: #000000;">742</span></pre></td></tr></table></div>

<p>Ouvrez le navigateur Internet explorer bourré de toolbars à l&#8217;adresse <a href="http://127.0.0.1:8080">127.0.0.1:8080</a></p>
<p>C&#8217;est bon ça marche, c&#8217;est fini, vous êtes un pro du pot. Quand on voit ça on se dit que franchement ça sert à rien de se faire chier plus que ça&#8230; :)</p>
<p>Moi quand je vois ça ça me fait chialer à chaque fois tellement c&#8217;est simple, je me dis que je vais révolutionner le monde, conquérir la planète, me taper les plus belles meufs&#8230;</p>
<p>Avant d&#8217;aller plus loin je reprends le code et je note ce qu&#8217;il faut retenir</p>
<p><b>1. le routing</b></p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>app.<span style="color: black;">route</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'/'</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>@app.route(&#8216;/&#8217;) prend tout ce qui arrive à la racine de l&#8217;url et le traite dans la vue hello qui est une fonction de base toute simple. si j&#8217;avais voulu faire une url du genre 127.0.0.1:8080/samapoil j&#8217;aurais mis @app.route(&#8216;/samapoil&#8217;)</p>
<p><b>2. les vues</b></p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> hello<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">&quot;Max est le plus beau!&quot;</span></pre></td></tr></table></div>

<p>la vue est une fonction que l&#8217;ont défini et qui peut prendre n&#8217;importe quel nom, dedans on traite l&#8217;information qui arrivera de l&#8217;url routée par le <a href="http://sametmax.com/comprendre-les-decorateurs-python-pas-a-pas-partie-1/">décorateur</a> &#8220;@app.route(&#8216;/&#8217;)&#8221;. Cette vue peut recevoir des infos d&#8217;un formulaire ou des variables passées dans l&#8217;url (qu&#8217;on va voir plus bas)</p>
<p>Voilà votre premier site bottle marche, c&#8217;est rigolo. Maintenant on va aller un peu plus loin et utiliser les templates.</p>
<p><b>Les templates c&#8217;est quoi ?</b><br />
Les templates c&#8217;est juste du code HTML avec dedans des &#8220;variables&#8221; que l&#8217;on va peupler dans notre vue. ça sert à ne pas trop mélanger code python et html et c&#8217;est plutôt une bonne idée.</p>
<p><b>Création d&#8217;un template:</b><br />
éditez un fichier template.tpl et mettez dedans</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">&lt;</span>div <span style="color: #007800;">align</span>=<span style="color: #ff0000;">&quot;center&quot;</span><span style="color: #000000; font-weight: bold;">&gt;</span><span style="color: #7a0874; font-weight: bold;">&#123;</span><span style="color: #7a0874; font-weight: bold;">&#123;</span> title <span style="color: #7a0874; font-weight: bold;">&#125;</span><span style="color: #7a0874; font-weight: bold;">&#125;</span><span style="color: #000000; font-weight: bold;">&lt;/</span>div<span style="color: #000000; font-weight: bold;">&gt;</span></pre></td></tr></table></div>

<p><b>Maintenant on va assembler le template et la vue comme un légo:</b><br />
Ouvrez le fichier start.py et collez</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">from</span> bottle <span style="color: #ff7700;font-weight:bold;">import</span> Bottle<span style="color: #66cc66;">,</span> run<span style="color: #66cc66;">,</span> view
&nbsp;
app <span style="color: #66cc66;">=</span> Bottle<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #66cc66;">@</span>app.<span style="color: black;">route</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'/'</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">@</span>view<span style="color: black;">&#40;</span><span style="color: #483d8b;">'template.tpl'</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> hello<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    context <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: #483d8b;">'title'</span>: <span style="color: #483d8b;">&quot;Max est le plus beau&quot;</span><span style="color: black;">&#125;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: black;">&#40;</span>context<span style="color: black;">&#41;</span>
&nbsp;
run<span style="color: black;">&#40;</span>app<span style="color: #66cc66;">,</span> host<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'localhost'</span><span style="color: #66cc66;">,</span> port<span style="color: #66cc66;">=</span><span style="color: #ff4500;">8080</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Relancez le serveur (python start.py) et allez sur à l&#8217;adresse <a href="http://127.0.0.1:8080/127.0.0.1:8080">127.0.0.1:8080</a></p>
<p>Et voilà notre template utilisé par notre vue auquel on a passé un title. Ceci ce fait grace au décorateur &#8220;@view&#8221; auquel on donne le chemin du template. Les templates offrent pas mal de <a href="http://bottlepy.org/docs/dev/tutorial.html#templates">possibilitées</a></p>
<p>Les bases sont posées ce n&#8217;est vraiment pas sorcier, je rajoute quelques exemples pratiques mais tout ceci figure dans la <a href="http://bottlepy.org/docs/dev/tutorial.html#quickstart-hello-world">doc</a></p>
<p><b>Mettre un id dans l&#8217;url:</b></p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;">#!/usr/bin/env python</span>
<span style="color: #808080; font-style: italic;"># -*- coding: utf-8 -*-</span>
<span style="color: #ff7700;font-weight:bold;">from</span> bottle <span style="color: #ff7700;font-weight:bold;">import</span> Bottle<span style="color: #66cc66;">,</span> run<span style="color: #66cc66;">,</span> view
app <span style="color: #66cc66;">=</span> Bottle<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #66cc66;">@</span>app.<span style="color: black;">route</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'/:mon_id'</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">@</span>view<span style="color: black;">&#40;</span><span style="color: #483d8b;">'template.tpl'</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> hello<span style="color: black;">&#40;</span>mon_id<span style="color: black;">&#41;</span>:
    <span style="color: #483d8b;">&quot;&quot;&quot;
        Récupre la variable mon_id passée dans l'url sous la forme 127.0.0.1:8080/1 et la transmet au template via le context
    &quot;&quot;&quot;</span>
    context <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: #483d8b;">'title'</span>: <span style="color: #483d8b;">&quot;Max est le plus beau %s&quot;</span> % mon_id<span style="color: black;">&#125;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: black;">&#40;</span>context<span style="color: black;">&#41;</span>
&nbsp;
run<span style="color: black;">&#40;</span>app<span style="color: #66cc66;">,</span> host<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'localhost'</span><span style="color: #66cc66;">,</span> port<span style="color: #66cc66;">=</span><span style="color: #ff4500;">8080</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p><b>Récupérer une variable dans l&#8217;url:</b></p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;">#!/usr/bin/env python</span>
<span style="color: #808080; font-style: italic;"># -*- coding: utf-8 -*-</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">from</span> bottle <span style="color: #ff7700;font-weight:bold;">import</span> Bottle<span style="color: #66cc66;">,</span> run<span style="color: #66cc66;">,</span> view<span style="color: #66cc66;">,</span> request
&nbsp;
app <span style="color: #66cc66;">=</span> Bottle<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #66cc66;">@</span>app.<span style="color: black;">route</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'/jemesure'</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">@</span>view<span style="color: black;">&#40;</span><span style="color: #483d8b;">'template.tpl'</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> hello<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    <span style="color: #483d8b;">&quot;&quot;&quot;
        Récupère la variable taille à l'aide de l'objet request pour l'url 
        http://127.0.0.1:8080/jemesure?taille=133
    &quot;&quot;&quot;</span>
    context <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: #483d8b;">'title'</span>: <span style="color: #483d8b;">&quot;Je mesure %s cm&quot;</span> % request.<span style="color: black;">params</span>.<span style="color: black;">taille</span><span style="color: black;">&#125;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: black;">&#40;</span>context<span style="color: black;">&#41;</span>
&nbsp;
run<span style="color: black;">&#40;</span>app<span style="color: #66cc66;">,</span> host<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'localhost'</span><span style="color: #66cc66;">,</span> port<span style="color: #66cc66;">=</span><span style="color: #ff4500;">8080</span><span style="color: #66cc66;">,</span> reloader<span style="color: #66cc66;">=</span><span style="color: #008000;">True</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Notez le &#8220;reloader=True&#8221; qui permet au serveur de redémarrer à chaque modif du code, hyper pratique.</p>
<p><b>Edit:</b></p>
<p><b>Servir les images, js, css (appelé contenu statique):</b></p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;">#!/usr/bin/env python</span>
<span style="color: #808080; font-style: italic;"># -*- coding: utf-8 -*-</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">from</span> bottle <span style="color: #ff7700;font-weight:bold;">import</span> Bottle<span style="color: #66cc66;">,</span> run<span style="color: #66cc66;">,</span> static_file
app <span style="color: #66cc66;">=</span> Bottle<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #66cc66;">@</span>app.<span style="color: black;">route</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'/static/&lt;filename:path&gt;'</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> server_static<span style="color: black;">&#40;</span>filename<span style="color: black;">&#41;</span>:
    <span style="color: #483d8b;">&quot;&quot;&quot;
        Sert les fichiers statiques tel que .js, .css, .jpeg, etc...
    &quot;&quot;&quot;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> static_file<span style="color: black;">&#40;</span>filename<span style="color: #66cc66;">,</span> root<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'.'</span><span style="color: black;">&#41;</span>
&nbsp;
run<span style="color: black;">&#40;</span>app<span style="color: #66cc66;">,</span> host<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'localhost'</span><span style="color: #66cc66;">,</span> port<span style="color: #66cc66;">=</span><span style="color: #ff4500;">8080</span><span style="color: #66cc66;">,</span> reloader<span style="color: #66cc66;">=</span><span style="color: #008000;">True</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Grace à static_file vous pourrez servir vos images, faire télécharger des fichiers, etc, simplement. Dans l&#8217;exemple ci-dessus si vous allez sur l&#8217;url <a href="http://127.0.0.1:8080/static/template.tpl">http://127.0.0.1:8080/static/template.tpl</a> vous allez télécharger le template template.tpl, si c&#8217;est une image, votre navigateur affichera une image, etc&#8230;</p>
<p>Je vous conseille d&#8217;aller voir la doc histoire de vous mettre l&#8217;eau à la bouche. JE déteste les docs en général mais là je la trouve presque parfaite.</p>
<p>Sam vous fera un article bientôt sur comment mettre tout ça en prod car le petit serveur web compris dans bottle ne peut bien sur pas assurer une charge en prod.<br />
Mais comme dit ma grand-mère ça se goupille comme un doigt au cul.</p>
<p>Bottle est vraiment pour moi l&#8217;outil parfait pour concrétiser rapidement une idée, un site qui ne demande pas une grosse structure, bref un projet qui doit se torcher rapidement ;)</p>
<p>Et pour illustrer ce que j&#8217;ai pu faire en quelques jours de taf avec bottle et un peu de Jquery je vous mettrai en ligne dans la semaine un petit site fort symphatique je pense&#8230;</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/creer-un-site-avec-bottle-en-5-minutes-parceque-7-cest-impossible-voyons/feed/</wfw:commentRss>
		<slash:comments>17</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2012/08/sancerre-comte-lafond-grande.jpeg" length="8312" type="image/jpg" />	</item>
	</channel>
</rss>

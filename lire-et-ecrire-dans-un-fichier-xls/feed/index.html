<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	
	>
<channel>
	<title>Comments on: Lire et écrire dans un fichier XLS avec Python</title>
	<atom:link href="http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/</link>
	<description>Du code, du cul</description>
	<lastBuildDate>Sat, 07 Nov 2015 11:08:18 +0000</lastBuildDate>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=4.1</generator>
	<item>
		<title>By: Sam</title>
		<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/#comment-8467</link>
		<dc:creator><![CDATA[Sam]]></dc:creator>
		<pubDate>Fri, 26 Apr 2013 06:26:46 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=5793#comment-8467</guid>
		<description><![CDATA[Très sympas tout ça.]]></description>
		<content:encoded><![CDATA[<p>Très sympas tout ça.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: kage</title>
		<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/#comment-8460</link>
		<dc:creator><![CDATA[kage]]></dc:creator>
		<pubDate>Thu, 25 Apr 2013 17:17:29 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=5793#comment-8460</guid>
		<description><![CDATA[Cette lib m&#039;a bien sauvée today &lt;a href=&quot;https://github.com/brianray/mm&quot; rel=&quot;nofollow&quot;&gt; elle en plus très facile à prendre en main, création d&#039;un fichier xls en 2minutes chrono!]]></description>
		<content:encoded><![CDATA[<p>Cette lib m&#8217;a bien sauvée today <a href="https://github.com/brianray/mm" rel="nofollow"> elle en plus très facile à prendre en main, création d&#8217;un fichier xls en 2minutes chrono!</a></p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Poulet 2.0</title>
		<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/#comment-8427</link>
		<dc:creator><![CDATA[Poulet 2.0]]></dc:creator>
		<pubDate>Wed, 24 Apr 2013 15:16:20 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=5793#comment-8427</guid>
		<description><![CDATA[@Fred: je peux me tromper (lourdement, j&#039;ai l&#039;habitude), mais &lt;em&gt;PyExcelerator&lt;/em&gt; n&#039;est plus maintenu. Les légendes numériques racontent que &lt;em&gt;xlrd/xlwt&lt;/em&gt; a demarré comme un fork de &lt;em&gt;PyExcelerator&lt;/em&gt;, il est maintenu et la transition devrait se faire en douceur.]]></description>
		<content:encoded><![CDATA[<p>@Fred: je peux me tromper (lourdement, j&#8217;ai l&#8217;habitude), mais <em>PyExcelerator</em> n&#8217;est plus maintenu. Les légendes numériques racontent que <em>xlrd/xlwt</em> a demarré comme un fork de <em>PyExcelerator</em>, il est maintenu et la transition devrait se faire en douceur.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Sam</title>
		<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/#comment-8229</link>
		<dc:creator><![CDATA[Sam]]></dc:creator>
		<pubDate>Sat, 20 Apr 2013 20:11:47 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=5793#comment-8229</guid>
		<description><![CDATA[@Guts: a priori, je dirais que unicode(s) devrait être s.decode(&#039;un_encoding&#039;) et qu&#039;il faudrait le connaitre (et éviter le try / except généraliste qui cache surement un bug d&#039;encoding du à la méconnaissance du format). Sinon, comme il n&#039;y a pas le code de la sauvegarde dans posgres, si le code de récupération de la donnée depuis posgress (deux autres points ou ça peut foirer), on ne peut pas savoir. Un article sur l&#039;encoding en Python arrive demain, si tu te sens d&#039;attendre.]]></description>
		<content:encoded><![CDATA[<p>@Guts: a priori, je dirais que unicode(s) devrait être s.decode(&#8216;un_encoding&#8217;) et qu&#8217;il faudrait le connaitre (et éviter le try / except généraliste qui cache surement un bug d&#8217;encoding du à la méconnaissance du format). Sinon, comme il n&#8217;y a pas le code de la sauvegarde dans posgres, si le code de récupération de la donnée depuis posgress (deux autres points ou ça peut foirer), on ne peut pas savoir. Un article sur l&#8217;encoding en Python arrive demain, si tu te sens d&#8217;attendre.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Fred</title>
		<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/#comment-8226</link>
		<dc:creator><![CDATA[Fred]]></dc:creator>
		<pubDate>Sat, 20 Apr 2013 18:45:28 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=5793#comment-8226</guid>
		<description><![CDATA[Mouais. Moi j&#039;utilise pyexcelerator (http://pyexcelerator.sourceforge.net). Je ne sais pas s&#039;il est mieux ou moins bien mais comme j&#039;étais seul quand il m&#039;a fallu me dém... pour crer de l&#039;Excel ben c&#039;est lui que j&#039;ai choisi...]]></description>
		<content:encoded><![CDATA[<p>Mouais. Moi j&#8217;utilise pyexcelerator (<a href="http://pyexcelerator.sourceforge.net" rel="nofollow">http://pyexcelerator.sourceforge.net</a>). Je ne sais pas s&#8217;il est mieux ou moins bien mais comme j&#8217;étais seul quand il m&#8217;a fallu me dém&#8230; pour crer de l&#8217;Excel ben c&#8217;est lui que j&#8217;ai choisi&#8230;</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Guts</title>
		<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/#comment-8224</link>
		<dc:creator><![CDATA[Guts]]></dc:creator>
		<pubDate>Sat, 20 Apr 2013 17:03:50 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=5793#comment-8224</guid>
		<description><![CDATA[Salut,

@sil : +1000 sur windows tu peux ajouter 5 ans d&#039;études supplémentaires

@Poulet 2.0 : il y a également &lt;a href=&quot;https://github.com/mikemaccana/python-docx&quot; rel=&quot;nofollow&quot;&gt;Python-docx&lt;/a&gt; qui se base sur le puissant lxml.

L&#039;API COM est réellement une autoflagellation à l&#039;acide pour faire le moindre truc.

ceci étant dit, je rencontre actuellement un souci sur une fonction d&#039;export d&#039;un xls vers csv, au niveau de l&#039;encoding. L&#039;idée étant d&#039;exporter un fichier d&#039;adresses (hispanophones) au format .xls en entrée vers du .csv afin de pouvoir l&#039;importer dans postgresql (9.2) dont l&#039;encoding  de la table est nécessairement fixé sur LATIN1. Les caractères spéciaux, correctement encodés dans le excel finissent par apparaître merdiquement dans la table pg en sortie. Et a priori, ça chie dans la colle au moment de l&#039;export en csv, malgré un encodage à la volée.

Ex d&#039;adresse :
dans le excel : Av. Carlos Alberto Izaguirre Nº 813
dans pg : &quot;Av. Carlos Alberto Izaguirre NÂº 813&quot;

Ci-dessous la fonction d&#039;export :

&lt;pre lang=&quot;python&quot;&gt;import csv, xlrd, xlwt
    def xls2csv(self, xlspath):
        u&quot;&quot;&quot; export an Excel 2003 file (.xls) to a CSV file
        see: http://stackoverflow.com/a/10803229 &quot;&quot;&quot;
        with xlrd.open_workbook(xlspath) as book:
            sheet = book.sheet_by_index(0)
            with open(&#039;temp/&#039; + path.splitext(path.basename(xlspath))[0] + &#039;.csv&#039;, &#039;wb&#039;) as f:
                out = csv.writer(f, delimiter=&#039;\t&#039;, dialect = &#039;excel&#039;)
                for row in range(sheet.nrows):
                    try:
                        out.writerow(sheet.row_values(row))
                    except:
                         out.writerow([unicode(s).encode(&quot;utf-8&quot;) for s in sheet.row_values(row)])

        # End of function
        return book, f&lt;/pre&gt;


J&#039;ai bien essayé d&#039;utiliser le paramètre encoding override mais sans succès... Une ch&#039;tite idée dans l&#039;assistance ?]]></description>
		<content:encoded><![CDATA[<p>Salut,</p>
<p>@sil : +1000 sur windows tu peux ajouter 5 ans d&#8217;études supplémentaires</p>
<p>@Poulet 2.0 : il y a également <a href="https://github.com/mikemaccana/python-docx" rel="nofollow">Python-docx</a> qui se base sur le puissant lxml.</p>
<p>L&#8217;API COM est réellement une autoflagellation à l&#8217;acide pour faire le moindre truc.</p>
<p>ceci étant dit, je rencontre actuellement un souci sur une fonction d&#8217;export d&#8217;un xls vers csv, au niveau de l&#8217;encoding. L&#8217;idée étant d&#8217;exporter un fichier d&#8217;adresses (hispanophones) au format .xls en entrée vers du .csv afin de pouvoir l&#8217;importer dans postgresql (9.2) dont l&#8217;encoding  de la table est nécessairement fixé sur LATIN1. Les caractères spéciaux, correctement encodés dans le excel finissent par apparaître merdiquement dans la table pg en sortie. Et a priori, ça chie dans la colle au moment de l&#8217;export en csv, malgré un encodage à la volée.</p>
<p>Ex d&#8217;adresse :<br />
dans le excel : Av. Carlos Alberto Izaguirre Nº 813<br />
dans pg : &#8220;Av. Carlos Alberto Izaguirre NÂº 813&#8243;</p>
<p>Ci-dessous la fonction d&#8217;export :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">csv</span><span style="color: #66cc66;">,</span> xlrd<span style="color: #66cc66;">,</span> xlwt
    <span style="color: #ff7700;font-weight:bold;">def</span> xls2csv<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> xlspath<span style="color: black;">&#41;</span>:
        u<span style="color: #483d8b;">&quot;&quot;&quot; export an Excel 2003 file (.xls) to a CSV file
        see: http://stackoverflow.com/a/10803229 &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">with</span> xlrd.<span style="color: black;">open_workbook</span><span style="color: black;">&#40;</span>xlspath<span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">as</span> book:
            sheet <span style="color: #66cc66;">=</span> book.<span style="color: black;">sheet_by_index</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">with</span> <span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'temp/'</span> + path.<span style="color: black;">splitext</span><span style="color: black;">&#40;</span>path.<span style="color: black;">basename</span><span style="color: black;">&#40;</span>xlspath<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span> + <span style="color: #483d8b;">'.csv'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'wb'</span><span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">as</span> f:
                out <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">csv</span>.<span style="color: black;">writer</span><span style="color: black;">&#40;</span>f<span style="color: #66cc66;">,</span> delimiter<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\t</span>'</span><span style="color: #66cc66;">,</span> dialect <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'excel'</span><span style="color: black;">&#41;</span>
                <span style="color: #ff7700;font-weight:bold;">for</span> row <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">range</span><span style="color: black;">&#40;</span>sheet.<span style="color: black;">nrows</span><span style="color: black;">&#41;</span>:
                    <span style="color: #ff7700;font-weight:bold;">try</span>:
                        out.<span style="color: black;">writerow</span><span style="color: black;">&#40;</span>sheet.<span style="color: black;">row_values</span><span style="color: black;">&#40;</span>row<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
                    <span style="color: #ff7700;font-weight:bold;">except</span>:
                         out.<span style="color: black;">writerow</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: #008000;">unicode</span><span style="color: black;">&#40;</span>s<span style="color: black;">&#41;</span>.<span style="color: black;">encode</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;utf-8&quot;</span><span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">for</span> s <span style="color: #ff7700;font-weight:bold;">in</span> sheet.<span style="color: black;">row_values</span><span style="color: black;">&#40;</span>row<span style="color: black;">&#41;</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span>
&nbsp;
        <span style="color: #808080; font-style: italic;"># End of function</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> book<span style="color: #66cc66;">,</span> f</pre></td></tr></table></div>

<p>J&#8217;ai bien essayé d&#8217;utiliser le paramètre encoding override mais sans succès&#8230; Une ch&#8217;tite idée dans l&#8217;assistance ?</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: panchua</title>
		<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/#comment-8189</link>
		<dc:creator><![CDATA[panchua]]></dc:creator>
		<pubDate>Fri, 19 Apr 2013 07:40:11 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=5793#comment-8189</guid>
		<description><![CDATA[Pour écrire du xls ou xlsx, tablib fait du très bon boulot (xlwt en backend). Par contre il n&#039;a pas l&#039;air de pouvoir les lire.]]></description>
		<content:encoded><![CDATA[<p>Pour écrire du xls ou xlsx, tablib fait du très bon boulot (xlwt en backend). Par contre il n&#8217;a pas l&#8217;air de pouvoir les lire.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Poulet 2.0</title>
		<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/#comment-8186</link>
		<dc:creator><![CDATA[Poulet 2.0]]></dc:creator>
		<pubDate>Fri, 19 Apr 2013 07:01:11 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=5793#comment-8186</guid>
		<description><![CDATA[Il manque à cet article un paragraphe sur le format &quot;.xlsx&quot; (le format &quot;ouvert&quot; de Microsoft):
Depuis récemment (?), le module &lt;a href=&quot;https://pypi.python.org/pypi/xlrd&quot; rel=&quot;nofollow&quot;&gt;xlrd&lt;/a&gt; sait lire un fichier Excel 2010, mais son jumeau &lt;a href=&quot;https://pypi.python.org/pypi/xlwt&quot; rel=&quot;nofollow&quot;&gt;xlwt&lt;/a&gt; ne sait pas encore écrire dans ce format.
Pour cà, il existe la librairie &lt;a href=&quot;https://pypi.python.org/pypi/openpyxl&quot; rel=&quot;nofollow&quot;&gt;openpyxl&lt;/a&gt;, le peu que j&#039;en ai testé c&#039;est qu&#039;elle est moins réactive pour lire un fichier (la faute au format, XML compressé), mais elle semble stable et complète.

La librairie &lt;a href=&quot;http://pandas.pydata.org/&quot; rel=&quot;nofollow&quot;&gt;Pandas&lt;/a&gt; utilise d&#039;ailleurs ces 3 modules en interne selon le format Excel utilisé.]]></description>
		<content:encoded><![CDATA[<p>Il manque à cet article un paragraphe sur le format &#8220;.xlsx&#8221; (le format &#8220;ouvert&#8221; de Microsoft):<br />
Depuis récemment (?), le module <a href="https://pypi.python.org/pypi/xlrd" rel="nofollow">xlrd</a> sait lire un fichier Excel 2010, mais son jumeau <a href="https://pypi.python.org/pypi/xlwt" rel="nofollow">xlwt</a> ne sait pas encore écrire dans ce format.<br />
Pour cà, il existe la librairie <a href="https://pypi.python.org/pypi/openpyxl" rel="nofollow">openpyxl</a>, le peu que j&#8217;en ai testé c&#8217;est qu&#8217;elle est moins réactive pour lire un fichier (la faute au format, XML compressé), mais elle semble stable et complète.</p>
<p>La librairie <a href="http://pandas.pydata.org/" rel="nofollow">Pandas</a> utilise d&#8217;ailleurs ces 3 modules en interne selon le format Excel utilisé.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: sil</title>
		<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/#comment-8174</link>
		<dc:creator><![CDATA[sil]]></dc:creator>
		<pubDate>Thu, 18 Apr 2013 20:55:58 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=5793#comment-8174</guid>
		<description><![CDATA[Mouais, il faut avoir Bac+12 pour comprendre l&#039;API UNO.]]></description>
		<content:encoded><![CDATA[<p>Mouais, il faut avoir Bac+12 pour comprendre l&#8217;API UNO.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: kontre</title>
		<link>http://sametmax.com/lire-et-ecrire-dans-un-fichier-xls/#comment-8173</link>
		<dc:creator><![CDATA[kontre]]></dc:creator>
		<pubDate>Thu, 18 Apr 2013 20:01:55 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=5793#comment-8173</guid>
		<description><![CDATA[C&#039;est rigolo qu&#039;on puisse écrire les formules mais pas les lire !

Pour les scientifiques (ou les autres, je suis pas ségrégationniste) qui chargent des données depuis des fichiers xls (ou csv, ou texte, ou hdf5, ou...), je vous conseille plus que fortement d&#039;utiliser la librairie pandas. Ça sort directement des tableaux numpy avec les noms des entêtes, ça gère les points manquants, c&#039;est magique. Et ça utilise xlrd en backend, bien entendu. C&#039;est &quot;plus puissant mais aussi beaucoup plus contraignant&quot;. J&#039;ai découvert ça après avoir parsé des fichiers à la main, la différence est radicale !

http://pandas.pydata.org/
http://pandas.pydata.org/pandas-docs/stable/io.html#excel-files]]></description>
		<content:encoded><![CDATA[<p>C&#8217;est rigolo qu&#8217;on puisse écrire les formules mais pas les lire !</p>
<p>Pour les scientifiques (ou les autres, je suis pas ségrégationniste) qui chargent des données depuis des fichiers xls (ou csv, ou texte, ou hdf5, ou&#8230;), je vous conseille plus que fortement d&#8217;utiliser la librairie pandas. Ça sort directement des tableaux numpy avec les noms des entêtes, ça gère les points manquants, c&#8217;est magique. Et ça utilise xlrd en backend, bien entendu. C&#8217;est &#8220;plus puissant mais aussi beaucoup plus contraignant&#8221;. J&#8217;ai découvert ça après avoir parsé des fichiers à la main, la différence est radicale !</p>
<p><a href="http://pandas.pydata.org/" rel="nofollow">http://pandas.pydata.org/</a><br />
<a href="http://pandas.pydata.org/pandas-docs/stable/io.html#excel-files" rel="nofollow">http://pandas.pydata.org/pandas-docs/stable/io.html#excel-files</a></p>
]]></content:encoded>
	</item>
</channel>
</rss>

<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Sam &#38; Max &#187; classe</title>
	<atom:link href="http://sametmax.com/tag/classe/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Du code, du cul</description>
	<lastBuildDate>Sat, 07 Nov 2015 10:56:13 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=4.1</generator>
	<item>
		<title>Le guide ultime et définitif sur la programmation orientée objet en Python à l’usage des débutants qui sont rassurés par les textes détaillés qui prennent le temps de tout expliquer. Partie 7. 24</title>
		<link>http://sametmax.com/le-guide-ultime-et-definitif-sur-la-programmation-orientee-objet-en-python-a-lusage-des-debutants-qui-sont-rassures-par-les-textes-detailles-qui-prennent-le-temps-de-tout-expliquer-partie-7/</link>
		<comments>http://sametmax.com/le-guide-ultime-et-definitif-sur-la-programmation-orientee-objet-en-python-a-lusage-des-debutants-qui-sont-rassures-par-les-textes-detailles-qui-prennent-le-temps-de-tout-expliquer-partie-7/#comments</comments>
		<pubDate>Sun, 28 Apr 2013 05:47:17 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[classe]]></category>
		<category><![CDATA[classes]]></category>
		<category><![CDATA[heritage]]></category>
		<category><![CDATA[path.py]]></category>
		<category><![CDATA[poo]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=5912</guid>
		<description><![CDATA[L'orienté object est particulièrement adapté à la création de belles APIs. Nous allons donc étudier aujourd'hui un cas réel de mise en pratique réussi avec la lib <a href="https://github.com/jaraco/path.py">path.py</a>.]]></description>
				<content:encoded><![CDATA[<p>Un peu de rock à l&#8217;anglaise pour faire passer la pilule :</p>

<!-- iframe plugin v.2.9 wordpress.org/plugins/iframe/ -->
<iframe width="420" height="315" src="http://www.youtube.com/embed/wcb4gCJ9da0" frameborder="0" scrolling="no" class="iframe-class"></iframe>

<p>Après avoir lu <a href="http://sametmax.com/le-guide-ultime-et-definitif-sur-la-programmation-orientee-objet-en-python-a-lusage-des-debutants-qui-sont-rassures-par-les-textes-detailles-qui-prennent-le-temps-de-tout-expliquer-partie-6">la partie précédente</a>, vous avez dû vous demander comment mettre tout ça en application.</p>
<p>Comme je vous l&#8217;avais expliqué, l&#8217;orienté objet est particulièrement adapté à la création de belles APIs. Nous allons donc étudier aujourd&#8217;hui un cas réel de mise en pratique réussi avec la lib <a href="https://github.com/jaraco/path.py">path.py</a>.</p>
<p>J&#8217;ai choisi cette lib car :</p>
<ul>
<li>Le code tient dans un seul fichier.</li>
<li>Il y a plein de patterns utilisés dedans qui sont intéressants à expliquer.</li>
<li>C&#8217;est une source propre qui suit globalement les bonnes pratiques.</li>
<li>Path.py a une API élégante, donc le résultat à l&#8217;usage est un bon exemple.</li>
</ul>
<p>Petit rappel, path.py est une surcouche au dessus des modules <a href="http://docs.python.org/2/library/tempfile.html?highlight=tempfile#tempfile">tempfile</ ahref=>, <a href="http://docs.python.org/2/library/os.html?highlight=os#os">os</a> ou encore <a href="http://docs.python.org/2/library/shutil.html?highlight=shutils">shutil</a>, c&#8217;est à dire qu&#8217;elle permet de faire exactement la même chose, en plus pratique.</p>
<p>C&#8217;est donc typiquement un bibliothèque de confort, et elle n&#8217;aurait aucun intérêt si elle n&#8217;était pas agréable à utiliser puisque l&#8217;on peut déjà faire tout ce qu&#8217;elle fait avec Python en standard. Son attractivité réside dans la beauté de son interface qui rend la manipulation de fichiers très intuitive :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;"># elle permet de manipuler des chemins facilement</span>
<span style="color: #ff7700;font-weight:bold;">from</span> path <span style="color: #ff7700;font-weight:bold;">import</span> path
dossier <span style="color: #66cc66;">=</span> path<span style="color: black;">&#40;</span><span style="color: #483d8b;">'/etc'</span><span style="color: black;">&#41;</span>
fichier <span style="color: #66cc66;">=</span> dossier / <span style="color: #483d8b;">'postgresql/9.1/main/pg_hba.conf'</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># d'obtenir des informations sur le fichier</span>
fichier.<span style="color: black;">exists</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;">## True</span>
fichier.<span style="color: black;">parent</span>
<span style="color: #808080; font-style: italic;">## path(u'/etc/postgresql/9.1/main')</span>
fichier.<span style="color: black;">basename</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;">## path(u'pg_hba.conf')</span>
fichier.<span style="color: black;">dirname</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;">## path(u'/etc/postgresql/9.1/main')</span>
fichier.<span style="color: black;">spli</span>
fichier.<span style="color: black;">split</span>       fichier.<span style="color: black;">splitall</span>    fichier.<span style="color: black;">splitdrive</span>  fichier.<span style="color: black;">splitext</span>    fichier.<span style="color: black;">splitlines</span>  fichier.<span style="color: black;">splitpath</span>   fichier.<span style="color: black;">splitunc</span>
fichier.<span style="color: black;">splitext</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;">## (path(u'/etc/postgresql/9.1/main/pg_hba'), u'.conf')</span>
&nbsp;
&nbsp;
<span style="color: #808080; font-style: italic;"># lister les fichiers dans un dossier</span>
<span style="color: #ff7700;font-weight:bold;">for</span> fichier <span style="color: #ff7700;font-weight:bold;">in</span> dossier.<span style="color: black;">listdir</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
...     <span style="color: #ff7700;font-weight:bold;">print</span> fichier
...
<span style="color: #808080; font-style: italic;">## /etc/thunderbird</span>
<span style="color: #808080; font-style: italic;">## /etc/libpaper.d</span>
<span style="color: #808080; font-style: italic;">## /etc/mtools.conf</span>
<span style="color: #808080; font-style: italic;">## ...</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># lister récursivement les fichiers dans un dossier</span>
<span style="color: #ff7700;font-weight:bold;">for</span> fichier <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: black;">&#40;</span>dossier / <span style="color: #483d8b;">'apt/'</span><span style="color: black;">&#41;</span>.<span style="color: black;">walkfiles</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span> fichier
...
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.save</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/trusted.gpg</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/trusted.gpg~</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/indicator-brightness-ppa-raring.list.save</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/tualatrix-ppa-raring.list</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/webupd8team-sublime-text-2-raring.list</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/fossfreedom-byzanz-raring.list.save</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/hotot-team-ppa-raring.list.save</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/webupd8team-y-ppa-manager-raring.list</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/pitti-postgresql-raring.list.save</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/pitti-postgresql-raring.list</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/yorba-ppa-raring.list.save</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/indicator-brightness-ppa-raring.list</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/webupd8team-sublime-text-2-raring.list.save</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/yorba-ppa-raring.list</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/webupd8team-y-ppa-manager-raring.list.save</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/sources.list.d/fossfreedom-byzanz-raring.list</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/trustdb.gpg</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/20dbus</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/10periodic</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/99synaptic</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/70debconf</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/05aptitude</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/20archive</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/01autoremove</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/50unattended-upgrades</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/00aptitude</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/99update-notifier</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/15update-stamp</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/00trustcdrom</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/20changelog</span>
<span style="color: #808080; font-style: italic;">## /etc/apt/apt.conf.d/01autoremove-kernels</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># et bien d'autres choses</span></pre></td></tr></table></div>

<p>Nous allons donc commenter son code, dans le cadre du tuto (on ne va pas voir les algos en détail). Je mettrai mes commentaires entre <code>#< sm ></ sm ></code> afin de les distinguer du reste.</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;">&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># On commence par un bon gros bloc de copyright, sachant que path.py est</span>
<span style="color: #808080; font-style: italic;"># sous MIT License. Le plus inhabituel c'est l'absence de déclaration</span>
<span style="color: #808080; font-style: italic;"># d'encoding en en-tête, qui s'explique par le fait que toute la lib est</span>
<span style="color: #808080; font-style: italic;"># écrite uniquement avec des caractères ASCII, ce qui est l'encodage par</span>
<span style="color: #808080; font-style: italic;"># défaut de Python 2.7. Python 3 a UTF8 en encodage par défaut, mais ASCII</span>
<span style="color: #808080; font-style: italic;"># est un sous-ensemble de UTF8, donc ça ne pose pas de problème.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Notez qu'avec mes commentaires en plus, ça ferait planter le script puisque</span>
<span style="color: #808080; font-style: italic;"># j'utilise des accents.</span>
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
<span style="color: #808080; font-style: italic;">#</span>
<span style="color: #808080; font-style: italic;"># Copyright (c) 2010 Mikhail Gusarov</span>
<span style="color: #808080; font-style: italic;">#</span>
<span style="color: #808080; font-style: italic;"># Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span style="color: #808080; font-style: italic;"># of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span style="color: #808080; font-style: italic;"># in the Software without restriction, including without limitation the rights</span>
<span style="color: #808080; font-style: italic;"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span style="color: #808080; font-style: italic;"># copies of the Software, and to permit persons to whom the Software is</span>
<span style="color: #808080; font-style: italic;"># furnished to do so, subject to the following conditions:</span>
<span style="color: #808080; font-style: italic;">#</span>
<span style="color: #808080; font-style: italic;"># The above copyright notice and this permission notice shall be included in all</span>
<span style="color: #808080; font-style: italic;"># copies or substantial portions of the Software.</span>
<span style="color: #808080; font-style: italic;">#</span>
<span style="color: #808080; font-style: italic;"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span style="color: #808080; font-style: italic;"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span style="color: #808080; font-style: italic;"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span style="color: #808080; font-style: italic;"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span style="color: #808080; font-style: italic;"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span style="color: #808080; font-style: italic;"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span style="color: #808080; font-style: italic;"># SOFTWARE.</span>
<span style="color: #808080; font-style: italic;">#</span>
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># La docstring du module qui documente l'usage général du module. En</span>
<span style="color: #808080; font-style: italic;"># l'occurence au moins l'existence de la classe principale et son usage. Les</span>
<span style="color: #808080; font-style: italic;"># symboles comme '\x40' sont juste une autre représentation d'un caractère</span>
<span style="color: #808080; font-style: italic;"># via sa valeur dans la table ASCII.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Par exemple, '@' est à la case 64 dans la table ASCII, et 64 se note 40 en</span>
<span style="color: #808080; font-style: italic;"># hexadécimal:</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># &gt;&gt;&gt; ord('@')</span>
<span style="color: #808080; font-style: italic;"># 64</span>
<span style="color: #808080; font-style: italic;"># &gt;&gt;&gt; int('40', base=16)</span>
<span style="color: #808080; font-style: italic;"># 64</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Du coup on peut écrire '@' juste avec un caractère d’échappement en Python</span>
<span style="color: #808080; font-style: italic;"># qui va faire le lien. Cette technique est utile si on veut faire passer</span>
<span style="color: #808080; font-style: italic;"># du texte avec des caractères spéciaux dans certains protocoles, par exemple</span>
<span style="color: #808080; font-style: italic;"># quand on veut rentrer un email dans une URL. En l’occurrence je ne vois</span>
<span style="color: #808080; font-style: italic;"># absolument pas ce que ça vient foutre ici.</span>
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
&nbsp;
<span style="color: #483d8b;">&quot;&quot;&quot; path.py - An object representing a path to a file or directory.
&nbsp;
Original author:
 Jason Orendorff &lt;jason.orendorff<span style="color: #000099; font-weight: bold;">\x</span>40gmail<span style="color: #000099; font-weight: bold;">\x</span>2ecom&gt;
&nbsp;
Current maintainer:
 Jason R. Coombs &lt;jaraco@jaraco.com&gt;
&nbsp;
Contributors:
 Mikhail Gusarov &lt;dottedmag@dottedmag.net&gt;
 Marc Abramowitz &lt;marc@marc-abramowitz.com&gt;
 Jason R. Coombs &lt;jaraco@jaraco.com&gt;
 Jason Chu &lt;jchu@xentac.net&gt;
 Vojislav Stojkovic &lt;vstojkovic@syntertainment.com&gt;
&nbsp;
Example::
&nbsp;
    from path import path
    d = path('/home/guido/bin')
    for f in d.files('*.py'):
        f.chmod(0755)
&nbsp;
path.py requires Python 2.5 or later.
&quot;&quot;&quot;</span>
&nbsp;
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># Import du mot clé with, car cette lib est compatible avec Python 2.5</span>
<span style="color: #808080; font-style: italic;"># et le keyword est apparu en 2.6. Il a été backporté dans __future__</span>
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">__future__</span> <span style="color: #ff7700;font-weight:bold;">import</span> with_statement
&nbsp;
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">sys</span> <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Informations sur le système&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">warnings</span> <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Alertes techniques à d'autres dev&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">os</span> <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Manipulation du File System&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">fnmatch</span> <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Pattern matching comme dans un shell&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">glob</span> <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Lister des fichier avec la syntax shell&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">shutil</span> <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Manipulation de fichiers de haut niveau&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">codecs</span> <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Encoding&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> hashlib <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Sommes de contrôle&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">errno</span> <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Les codes d'erreurs liées aux fichiers.&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">tempfile</span> <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Création de fichiers temporaires&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">import</span> functools <span style="color: #808080; font-style: italic;">#&lt;sm&gt;Manipulation des fonctions&lt;/sm&gt;</span>
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># Tentative d'utilisation de la lib win32security qui sert à gérer</span>
<span style="color: #808080; font-style: italic;"># des aspects sécuritaires du FS sous Windows. C'est une lib tierce partie,</span>
<span style="color: #808080; font-style: italic;"># et une dépendance optionelle, donc l'import est géré pour ne pas faire</span>
<span style="color: #808080; font-style: italic;"># d'erreur si la lib n'est pas disponible.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Idem pour pwd qui est dans la lib standard mais uniquement sur les distribs</span>
<span style="color: #808080; font-style: italic;"># unix et qui donne accès aux infos sur l'utilisateur du système, tester</span>
<span style="color: #808080; font-style: italic;"># son mot de passe, etc.</span>
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">try</span>:
    <span style="color: #ff7700;font-weight:bold;">import</span> win32security
<span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">ImportError</span>:
    <span style="color: #ff7700;font-weight:bold;">pass</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">try</span>:
    <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">pwd</span>
<span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">ImportError</span>:
    <span style="color: #ff7700;font-weight:bold;">pass</span>
&nbsp;
&nbsp;
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># Manière standard de lister la version de la lib dans un module Python.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># __all__ est une variable magique qui peut contenir une liste des noms de</span>
<span style="color: #808080; font-style: italic;"># tout ce qui est importable dans le module, de telle sorte que si</span>
<span style="color: #808080; font-style: italic;"># quelqu'un fait : from path import *, seul le contenu de __all__ soit</span>
<span style="color: #808080; font-style: italic;"># importé.</span>
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
__version__ <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'3.0'</span>
__all__ <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: #483d8b;">'path'</span><span style="color: black;">&#93;</span>
&nbsp;
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># Les warnings ressemblent beaucoup aux exceptions excepté qu'ils ne font</span>
<span style="color: #808080; font-style: italic;"># pas planter le programme. Ici donc, ou hérite de la base des warnings</span>
<span style="color: #808080; font-style: italic;"># comme on le ferait pour créer son Exception personnalisée, ce qui va</span>
<span style="color: #808080; font-style: italic;"># permettre à l'utilisateur de la lib path.py de, plus tard, pouvoir filter</span>
<span style="color: #808080; font-style: italic;"># ce warning en particulier.</span>
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
&nbsp;
<span style="color: #ff7700;font-weight:bold;">class</span> TreeWalkWarning<span style="color: black;">&#40;</span><span style="color: #008000;">Warning</span><span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">pass</span>
&nbsp;
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># Un décorateur de mémorisation, c'est à dire qui va mettre en cache les</span>
<span style="color: #808080; font-style: italic;"># résultats de la fonction sur lequel il est appliqué afin que les prochains</span>
<span style="color: #808080; font-style: italic;"># appels avec les mêmes paramètres lisent les valeurs du cache en mémoire</span>
<span style="color: #808080; font-style: italic;"># plutôt que de refaire l'opération.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Il est utilisé plus bas sur :</span>
&nbsp;
<span style="color: #808080; font-style: italic;">#     @classmethod</span>
<span style="color: #808080; font-style: italic;">#     @simple_cache</span>
<span style="color: #808080; font-style: italic;">#     def using_module(cls, module):</span>
<span style="color: #808080; font-style: italic;">#         subclass_name = cls.__name__ + '_' + module.__name__</span>
<span style="color: #808080; font-style: italic;">#         bases = (cls,)</span>
<span style="color: #808080; font-style: italic;">#         ns = {'module': module}</span>
<span style="color: #808080; font-style: italic;">#         return type(subclass_name, bases, ns)</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Ça évitera plusieurs traitements de using_module() si le paramètre de</span>
<span style="color: #808080; font-style: italic;"># 'module' ne change pas.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Et oui, on peut mélanger plusieurs classes et fonctions dans un même module,</span>
<span style="color: #808080; font-style: italic;"># ça n'a pas d'importance.</span>
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> simple_cache<span style="color: black;">&#40;</span>func<span style="color: black;">&#41;</span>:
    <span style="color: #483d8b;">&quot;&quot;&quot;
    Save results for the 'using_module' classmethod.
    When Python 3.2 is available, use functools.lru_cache instead.
    &quot;&quot;&quot;</span>
    saved_results <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> wrapper<span style="color: black;">&#40;</span>cls<span style="color: #66cc66;">,</span> module<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">if</span> module <span style="color: #ff7700;font-weight:bold;">in</span> saved_results:
            <span style="color: #ff7700;font-weight:bold;">return</span> saved_results<span style="color: black;">&#91;</span>module<span style="color: black;">&#93;</span>
        saved_results<span style="color: black;">&#91;</span>module<span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> func<span style="color: black;">&#40;</span>cls<span style="color: #66cc66;">,</span> module<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> saved_results<span style="color: black;">&#91;</span>module<span style="color: black;">&#93;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> wrapper
&nbsp;
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># Nous avons vu que les propriétés permettaient de déguiser une méthode</span>
<span style="color: #808080; font-style: italic;"># en attribut. Cela ne marche pas sur une méthode de classe car dans ce cas</span>
<span style="color: #808080; font-style: italic;"># la propriété va se retourner elle-même.</span>
<span style="color: #808080; font-style: italic;"># Cette classe hérite de property pour écraser ce comportement et bien</span>
<span style="color: #808080; font-style: italic;"># retourner la valeur de la méthode de classe.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Elle est utilisée plus loin dans:</span>
&nbsp;
<span style="color: #808080; font-style: italic;">#     @ClassProperty</span>
<span style="color: #808080; font-style: italic;">#     @classmethod</span>
<span style="color: #808080; font-style: italic;">#     def _next_class(cls):</span>
<span style="color: #808080; font-style: italic;">#         &quot;&quot;&quot;</span>
<span style="color: #808080; font-style: italic;">#         What class should be used to construct new instances from this class</span>
<span style="color: #808080; font-style: italic;">#         &quot;&quot;&quot;</span>
<span style="color: #808080; font-style: italic;">#         return cls</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Ce qui va permettre de faire path._next_class au lieu de path._next_class().</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># C'est cosmétique, mais c'est le but de la lib d'être jolie.</span>
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">class</span> ClassProperty<span style="color: black;">&#40;</span><span style="color: #008000;">property</span><span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__get__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> cls<span style="color: #66cc66;">,</span> owner<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">fget</span>.<span style="color: #0000cd;">__get__</span><span style="color: black;">&#40;</span><span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> owner<span style="color: black;">&#41;</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># Encore un décorateur, cette fois sous forme de classe (on ne les a pas vu)</span>
<span style="color: #808080; font-style: italic;"># Celui-ci, quand il est appliqué, sert à ce qu'une méthode soit à la fois</span>
<span style="color: #808080; font-style: italic;"># une méthode d'instance et une méthode de classe, le choix se faisant</span>
<span style="color: #808080; font-style: italic;"># dynamiquement selon la situation.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Par exemple dans:</span>
&nbsp;
<span style="color: #808080; font-style: italic;">#     @multimethod</span>
<span style="color: #808080; font-style: italic;">#     def joinpath(cls, first, *others):</span>
<span style="color: #808080; font-style: italic;">#         &quot;&quot;&quot;</span>
<span style="color: #808080; font-style: italic;">#         Join first to zero or more path components, adding a separator</span>
<span style="color: #808080; font-style: italic;">#         character (first.module.sep) if needed.  Returns a new instance of</span>
<span style="color: #808080; font-style: italic;">#         first._next_class.</span>
<span style="color: #808080; font-style: italic;">#         &quot;&quot;&quot;</span>
<span style="color: #808080; font-style: italic;">#         if not isinstance(first, cls):</span>
<span style="color: #808080; font-style: italic;">#             first = cls(first)</span>
<span style="color: #808080; font-style: italic;">#         return first._next_class(first.module.join(first, *others))</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># 'cls' sera une instance ou une classe selon que l'appel se fasse depuis la</span>
<span style="color: #808080; font-style: italic;"># classe ou l'instance.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Notez le nom de la classe qui n'est pas en CamelCase (pas de majuscule)</span>
<span style="color: #808080; font-style: italic;"># alors qu'il s'agit bien d'un classe. Comme c'est un décorateur, on a</span>
<span style="color: #808080; font-style: italic;"># l'habitude de les voir en minuscule, donc on laisse ce nom en minuscule.</span>
<span style="color: #808080; font-style: italic;"># C'est une des rares exceptions au PEP8 (on en verra d'autres plus bas)</span>
<span style="color: #808080; font-style: italic;"># qu'on peut se permettre quand on sait ce qu'on fait :-)</span>
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">class</span> multimethod<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
    <span style="color: #483d8b;">&quot;&quot;&quot;
    Acts like a classmethod when invoked from the class and like an
    instancemethod when invoked from the instance.
    &quot;&quot;&quot;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__init__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> func<span style="color: black;">&#41;</span>:
        <span style="color: #008000;">self</span>.<span style="color: black;">func</span> <span style="color: #66cc66;">=</span> func
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__get__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> instance<span style="color: #66cc66;">,</span> owner<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: black;">&#40;</span>
            functools.<span style="color: black;">partial</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">func</span><span style="color: #66cc66;">,</span> owner<span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">if</span> instance <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #008000;">None</span>
            <span style="color: #ff7700;font-weight:bold;">else</span> functools.<span style="color: black;">partial</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">func</span><span style="color: #66cc66;">,</span> owner<span style="color: #66cc66;">,</span> instance<span style="color: black;">&#41;</span>
        <span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># La classe principale, et le plus gros morceau de code. Une classe peut</span>
<span style="color: #808080; font-style: italic;"># tout à fait faire plusieurs centaines de lignes.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># En général je recommande de ne pas avoir de fichiers qui fait plus de 500</span>
<span style="color: #808080; font-style: italic;"># lignes en Python, mais ici le but est clairement de faire une lib qui tient</span>
<span style="color: #808080; font-style: italic;"># dans un fichier pour l'auteur.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># La classe hérite du type unicode (hé oui, on peut hériter des types</span>
<span style="color: #808080; font-style: italic;"># built-in !); ainsi le path peut être manipulé comme une chaîne et reste</span>
<span style="color: #808080; font-style: italic;"># compatible avec tous les outils existants de manipulation de nom de fichiers</span>
<span style="color: #808080; font-style: italic;"># car ils utilisent les chaînes.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># L'héritage est une techno qui sert donc aussi à conserver des compatibilités</span>
<span style="color: #808080; font-style: italic;"># et des comportements existants / attendus.</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Encore une fois le nom est en minuscule alors que c'est une classe, c'est une</span>
<span style="color: #808080; font-style: italic;"># autre exception : quand on crée un type de base, on le met en minuscule</span>
<span style="color: #808080; font-style: italic;"># car c'est ce que fait la lib standard (int(), str(), list(), datetime(),</span>
<span style="color: #808080; font-style: italic;"># unicode(), etc, sont en fait des classes).</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># La docstring pourrait être meilleure.</span>
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
<span style="color: #ff7700;font-weight:bold;">class</span> path<span style="color: black;">&#40;</span><span style="color: #008000;">unicode</span><span style="color: black;">&#41;</span>:
    <span style="color: #483d8b;">&quot;&quot;&quot; Represents a filesystem path.
&nbsp;
    For documentation on individual methods, consult their
    counterparts in os.path.
    &quot;&quot;&quot;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Probablement mon désaccord principal avec cette lib, l'init vérifie</span>
    <span style="color: #808080; font-style: italic;"># qu'on lui passe bien une chaîne alors que j'aurais choisi le duck typing.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__init__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> other<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #008000;">isinstance</span><span style="color: black;">&#40;</span>other<span style="color: #66cc66;">,</span> <span style="color: #008000;">basestring</span><span style="color: black;">&#41;</span>:
            <span style="color: #ff7700;font-weight:bold;">raise</span> <span style="color: #008000;">TypeError</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;path must be a string&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># L'auteur stocke la référence de os.path ici, et l'utilise partout à la</span>
    <span style="color: #808080; font-style: italic;"># place d'utiliser os.path directement. Cela permet de changer ce module à</span>
    <span style="color: #808080; font-style: italic;"># la volée, par exemple pour utiliser spécifiquement le module dédié à</span>
    <span style="color: #808080; font-style: italic;"># Windows ou à unix au lieu de celui choisit automatiquement.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># C'est un exemple de pattern stratégie.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Et non, la docstring n'a aucun effet. Ça pourrait être un comment.</span>
    <span style="color: #808080; font-style: italic;"># En revanche, comme spécifié en comment, certains outils comme sphinx</span>
    <span style="color: #808080; font-style: italic;"># prennent les docstring en compte sur les variables.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    module <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">path</span>
    <span style="color: #483d8b;">&quot;The path module to use for path operations.&quot;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Une méthode retourne une classe path dont le module est</span>
    <span style="color: #808080; font-style: italic;"># celui passé en paramètre. Pratique si vous voulez</span>
    <span style="color: #808080; font-style: italic;"># utiliser un module spécifique à un OS depuis un autre</span>
    <span style="color: #808080; font-style: italic;"># mais juste ponctuellement.</span>
    <span style="color: #808080; font-style: italic;"># Par exemple sous Windows, vous voulez traiter un chemin</span>
    <span style="color: #808080; font-style: italic;"># (mais un seul, le reste est sous Windows) Unix, vous</span>
    <span style="color: #808080; font-style: italic;"># pouvez faire :</span>
    <span style="color: #808080; font-style: italic;">#</span>
    <span style="color: #808080; font-style: italic;"># &gt;&gt;&gt; import posixpath</span>
    <span style="color: #808080; font-style: italic;"># &gt;&gt;&gt; p = path.using_module(posixpath)('/etc')</span>
    <span style="color: #808080; font-style: italic;"># &gt;&gt;&gt; print p</span>
    <span style="color: #808080; font-style: italic;"># /etc</span>
    <span style="color: #808080; font-style: italic;"># &gt;&gt;&gt; p</span>
    <span style="color: #808080; font-style: italic;"># path_posixpath(u'/etc')</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># ce qui crée un objet path() dont l'attribut 'module' est le module</span>
    <span style="color: #808080; font-style: italic;">#  posixpath. C'est une application concrète de l'injection de dépendance.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
    <span style="color: #66cc66;">@</span><span style="color: #008000;">classmethod</span>
    <span style="color: #66cc66;">@</span>simple_cache
    <span style="color: #ff7700;font-weight:bold;">def</span> using_module<span style="color: black;">&#40;</span>cls<span style="color: #66cc66;">,</span> module<span style="color: black;">&#41;</span>:
        subclass_name <span style="color: #66cc66;">=</span> cls.__name__ + <span style="color: #483d8b;">'_'</span> + module.__name__
        bases <span style="color: #66cc66;">=</span> <span style="color: black;">&#40;</span>cls<span style="color: #66cc66;">,</span><span style="color: black;">&#41;</span>
        ns <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: #483d8b;">'module'</span>: module<span style="color: black;">&#125;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>subclass_name<span style="color: #66cc66;">,</span> bases<span style="color: #66cc66;">,</span> ns<span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Une propriété qui retourne la classe (oui, on peut retourner une CLASSE)</span>
    <span style="color: #808080; font-style: italic;"># à utiliser si on veut créer une nouvelle instance de cette classe.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># C'est très abstrait, vous n'aurez pas à faire ça tous les jours.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># C'est une méthode placée là pour permettre un maximum de configurabilité</span>
    <span style="color: #808080; font-style: italic;"># : si vous changez cette classe, certaines méthodes renverront un autre</span>
    <span style="color: #808080; font-style: italic;"># type plutôt que le type en cours. Utile pour certains cas où vous voulez</span>
    <span style="color: #808080; font-style: italic;"># hériter de path() mais désirez un comportement spécial pour la création</span>
    <span style="color: #808080; font-style: italic;"># de nouveaux path.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
    <span style="color: #66cc66;">@</span>ClassProperty
    <span style="color: #66cc66;">@</span><span style="color: #008000;">classmethod</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> _next_class<span style="color: black;">&#40;</span>cls<span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot;
        What class should be used to construct new instances from this class
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> cls
&nbsp;
    <span style="color: #808080; font-style: italic;"># --- Special Python methods.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Là on attaque la définition de toutes les méthodes magiques.</span>
    <span style="color: #808080; font-style: italic;"># Essentiellement pour overrider le comportement par défaut des chaînes</span>
    <span style="color: #808080; font-style: italic;"># unicode et exposer une API sympa.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Dans le shell, un path s'affichera path('chemin') et non 'chemin'</span>
    <span style="color: #808080; font-style: italic;"># L'auteur affiche en fait le nom du type en cours (en cas d'héritage</span>
    <span style="color: #808080; font-style: italic;"># cela changera) et ensuite la représentation du parent, en l'occurence</span>
    <span style="color: #808080; font-style: italic;"># la classe unicode().</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__repr__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #483d8b;">'%s(%s)'</span> % <span style="color: black;">&#40;</span><span style="color: #008000;">type</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>.__name__<span style="color: #66cc66;">,</span> <span style="color: #008000;">super</span><span style="color: black;">&#40;</span>path<span style="color: #66cc66;">,</span> <span style="color: #008000;">self</span><span style="color: black;">&#41;</span>.<span style="color: #0000cd;">__repr__</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Override l'addition.</span>
    <span style="color: #808080; font-style: italic;"># path('truc') + 'machin' donne path('trucmachin')</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Adding a path and a string yields a path.</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__add__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> more<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #008000;">super</span><span style="color: black;">&#40;</span>path<span style="color: #66cc66;">,</span> <span style="color: #008000;">self</span><span style="color: black;">&#41;</span>.<span style="color: #0000cd;">__add__</span><span style="color: black;">&#40;</span>more<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">TypeError</span>:  <span style="color: #808080; font-style: italic;"># Python bug</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">NotImplemented</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># 'machin' + path('truc') donne path('trucmachin')</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__radd__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> other<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #008000;">isinstance</span><span style="color: black;">&#40;</span>other<span style="color: #66cc66;">,</span> <span style="color: #008000;">basestring</span><span style="color: black;">&#41;</span>:
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">NotImplemented</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>other.<span style="color: #0000cd;">__add__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Override la division.</span>
    <span style="color: #808080; font-style: italic;"># path('truc') / 'machin' donne path('truc/machin')</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># The / operator joins paths.</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__div__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> rel<span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; fp.__div__(rel) == fp / rel == fp.joinpath(rel)
&nbsp;
        Join two path components, adding a separator character if
        needed.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> rel<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Petite astuce de compatibilité si le mec a fait</span>
    <span style="color: #808080; font-style: italic;"># from __future__ import division ou si on est en Python 3</span>
    <span style="color: #808080; font-style: italic;">#</span>
    <span style="color: #808080; font-style: italic;"># Remarque : on peut définir des attributs de classe n'importe où, et pas</span>
    <span style="color: #808080; font-style: italic;"># seulement en haut de la classe.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Make the / operator work even when true division is enabled.</span>
    __truediv__ <span style="color: #66cc66;">=</span> <span style="color: #0000cd;">__div__</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># path() est aussi un context manager qu'on peut utiliser avec with !</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># with path('truc'):</span>
    <span style="color: #808080; font-style: italic;">#     tout ce qui est ici se fait dans le dossier truc</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># *_ n'est pas une notation qui a un effet spécial. '_' est un nom de</span>
    <span style="color: #808080; font-style: italic;"># variable valide, c'est une convention pour dire 'je ne vais pas me</span>
    <span style="color: #808080; font-style: italic;"># servir de cet argument, je le déclare juste pour respecter la signature'</span>
    <span style="color: #808080; font-style: italic;"># et '*' est l'opérateur de paramétrage dynamique. '*_' est donc l'auteur</span>
    <span style="color: #808080; font-style: italic;"># signalant qu'il accepte n'importe quels paramètres positionnels, mais</span>
    <span style="color: #808080; font-style: italic;"># qu'ils ne les utilisera pas.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> __enter__<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #008000;">self</span>._old_dir <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">getcwd</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #dc143c;">os</span>.<span style="color: black;">chdir</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> __exit__<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> *_<span style="color: black;">&#41;</span>:
        <span style="color: #dc143c;">os</span>.<span style="color: black;">chdir</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>._old_dir<span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Le résultat de os.getcwdu(), mais retourne un objet path().</span>
    <span style="color: #808080; font-style: italic;"># Une bonne part du travail de la lib consiste à wrapper les méthodes</span>
    <span style="color: #808080; font-style: italic;"># ordinaires des autres modules pour qu'elles retournent un type path()</span>
    <span style="color: #808080; font-style: italic;"># pour qu'après on puisse faire des '.parent' ou utiliser '/' dessus</span>
    <span style="color: #808080; font-style: italic;"># sans y penser.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #66cc66;">@</span><span style="color: #008000;">classmethod</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> getcwd<span style="color: black;">&#40;</span>cls<span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Return the current working directory as a path object. &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> cls<span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span>.<span style="color: black;">getcwdu</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#</span>
    <span style="color: #808080; font-style: italic;"># --- Operations on path strings.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># On enchaine ici des wrappers sur des méthodes de os.path (ou son</span>
    <span style="color: #808080; font-style: italic;"># remplaçant dans self.module), que l'objet s'applique à lui-même (self).</span>
    <span style="color: #808080; font-style: italic;"># Comme la classe hérite de 'unicode', toutes ces méthodes marchent.</span>
    <span style="color: #808080; font-style: italic;"># Et comme self._next_class retourne la classe pour créer le prochain</span>
    <span style="color: #808080; font-style: italic;"># path, on retourne toujours un objet de type 'path'.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Si on fait fi des abstractions et qu'on lit les valeurs par défaut,</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#     self._next_class(self.module.abspath(self))</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># fait en fait:</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#     path(os.path.abspath('ton_chemin'))</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Ce qui donne l'API suivante quand on utilise la lib :</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#     &gt;&gt;&gt; path('/etc/nginx/..').abspath()</span>
    <span style="color: #808080; font-style: italic;">#     path(u'/etc')</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> abspath<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">abspath</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> normcase<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">normcase</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> normpath<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">normpath</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> realpath<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">realpath</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> expanduser<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">expanduser</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> expandvars<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">expandvars</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> dirname<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">dirname</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> basename<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">basename</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Là on rentre dans les méthodes utilitaires. L'auteur a constaté qu'on</span>
    <span style="color: #808080; font-style: italic;"># appelait très souvent ces trois méthodes sur les chemin des fichiers de</span>
    <span style="color: #808080; font-style: italic;"># config genre '~/toto' pour obtenir '/home/sam/toto' et propose donc</span>
    <span style="color: #808080; font-style: italic;"># un shortcut pour le faire car honnêtement, qui se souvient du nom</span>
    <span style="color: #808080; font-style: italic;"># de ces 3 méthodes à enchaîner pour obtenir un truc bullet proof ?</span>
    <span style="color: #808080; font-style: italic;"># Règle d'or d'une belle API : si il faut regarder dans la doc à chaque</span>
    <span style="color: #808080; font-style: italic;"># fois qu'on utilise quelque chose, il faut écrire un meilleur code.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> expand<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Clean up a filename by calling expandvars(),
        expanduser(), and normpath() on it.
&nbsp;
        This is commonly everything needed to clean up a filename
        read from a configuration file, for example.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">expandvars</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: black;">expanduser</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: black;">normpath</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Les méthodes suivantes sont préfixées d'un '_', donc elle n'apparaîtront</span>
    <span style="color: #808080; font-style: italic;"># pas dans les résultats d'outils avec complétion du code. Cela nous</span>
    <span style="color: #808080; font-style: italic;"># indique qu'il s'agit d'un détail d'implémentation, et que l'on ne devrait</span>
    <span style="color: #808080; font-style: italic;"># pas l'utiliser en dehors de la classe. Rien n'empêche de le faire</span>
    <span style="color: #808080; font-style: italic;"># cependant si vous avez envie de faire un beau hack bien gras.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Ici l'auteur fait ce choix car il va enrober ces appels dans des</span>
    <span style="color: #808080; font-style: italic;"># propriétés pour les déguiser en attributs.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Ces 3 méthodes retournent respectivement l'extension de fichier, le nom</span>
    <span style="color: #808080; font-style: italic;"># de fichier sans extension, et la lettre de lecteur sur les chemins</span>
    <span style="color: #808080; font-style: italic;"># windows.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> _get_namebase<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        base<span style="color: #66cc66;">,</span> ext <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">splitext</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">name</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> base
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> _get_ext<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        f<span style="color: #66cc66;">,</span> ext <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">splitext</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> ext
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> _get_drive<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        drive<span style="color: #66cc66;">,</span> r <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">splitdrive</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>drive<span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Malgré l'indentation bizarre, il s'agit bien de :</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#     attribut_de_classe = function(arg1, arg2, arg3, arg4)</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;"># Dans les tutos précédents vous avez vu comment créer une propriété avec</span>
    <span style="color: #808080; font-style: italic;"># le décorateur @property.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Ici l'auteur utilise l'ancienne façon de faire, car il veut garder la</span>
    <span style="color: #808080; font-style: italic;"># compatibilité avec python 2.5.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># C'est globalement la même chose, par exemple ici l'attribut 'namebase'</span>
    <span style="color: #808080; font-style: italic;"># est défini comme une property et y accéder en lecture va appeler la</span>
    <span style="color: #808080; font-style: italic;"># méthode '_get_namebase'. Le second et le troisième argument de</span>
    <span style="color: #808080; font-style: italic;"># property() sont les setter et les deleter qui ne sont pas ici définis et</span>
    <span style="color: #808080; font-style: italic;"># mis à None (donc l'attribut est en lecture seule). Le dernier argument</span>
    <span style="color: #808080; font-style: italic;"># est la docstring.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    parent <span style="color: #66cc66;">=</span> <span style="color: #008000;">property</span><span style="color: black;">&#40;</span>
        dirname<span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span>
        <span style="color: #483d8b;">&quot;&quot;&quot; This path's parent directory, as a new path object.
&nbsp;
        For example, path('/usr/local/lib/libpython.so').parent == path('/usr/local/lib')
        &quot;&quot;&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    name <span style="color: #66cc66;">=</span> <span style="color: #008000;">property</span><span style="color: black;">&#40;</span>
        basename<span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span>
        <span style="color: #483d8b;">&quot;&quot;&quot; The name of this file or directory without the full path.
&nbsp;
        For example, path('/usr/local/lib/libpython.so').name == 'libpython.so'
        &quot;&quot;&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    namebase <span style="color: #66cc66;">=</span> <span style="color: #008000;">property</span><span style="color: black;">&#40;</span>
        _get_namebase<span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span>
        <span style="color: #483d8b;">&quot;&quot;&quot; The same as path.name, but with one file extension stripped off.
&nbsp;
        For example, path('/home/guido/python.tar.gz').name     == 'python.tar.gz',
        but          path('/home/guido/python.tar.gz').namebase == 'python.tar'
        &quot;&quot;&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    ext <span style="color: #66cc66;">=</span> <span style="color: #008000;">property</span><span style="color: black;">&#40;</span>
        _get_ext<span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span>
        <span style="color: #483d8b;">&quot;&quot;&quot; The file extension, for example '.py'. &quot;&quot;&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    drive <span style="color: #66cc66;">=</span> <span style="color: #008000;">property</span><span style="color: black;">&#40;</span>
        _get_drive<span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span>
        <span style="color: #483d8b;">&quot;&quot;&quot; The drive specifier, for example 'C:'.
        This is always empty on systems that don't use drive specifiers.
        &quot;&quot;&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Encore des wrappers pour retourner des objets path(). La structure</span>
    <span style="color: #808080; font-style: italic;"># est classique: définition de méthodes courtes avec docstring.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># L'auteur retourne un tuple comme les méthodes originales (autant</span>
    <span style="color: #808080; font-style: italic;"># changer le comportement attendu le moins possible), mais cast la</span>
    <span style="color: #808080; font-style: italic;"># première partie du tuple en objet path().</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> splitpath<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; p.splitpath() -&gt; Return (p.parent, p.name). &quot;&quot;&quot;</span>
        parent<span style="color: #66cc66;">,</span> child <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">split</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>parent<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> child
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> splitdrive<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; p.splitdrive() -&gt; Return (p.drive, &lt;the rest of p&gt;).
&nbsp;
        Split the drive specifier from this path.  If there is
        no drive specifier, p.drive is empty, so the return value
        is simply (path(''), p).  This is always the case on Unix.
        &quot;&quot;&quot;</span>
        drive<span style="color: #66cc66;">,</span> rel <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">splitdrive</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>drive<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> rel
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> splitext<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; p.splitext() -&gt; Return (p.stripext(), p.ext).
&nbsp;
        Split the filename extension from this path and return
        the two parts.  Either part may be empty.
&nbsp;
        The extension is everything from '.' to the end of the
        last path segment.  This has the property that if
        (a, b) == p.splitext(), then a + b == p.
        &quot;&quot;&quot;</span>
        filename<span style="color: #66cc66;">,</span> ext <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">splitext</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>filename<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> ext
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Ici on a des méthodes légèrement différentes de celles qu'elles wrappent.</span>
    <span style="color: #808080; font-style: italic;"># C'est vraiment pour se faciliter la tâche sur les opérations courantes</span>
    <span style="color: #808080; font-style: italic;"># et sauver quelques caractères à la frappe.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> stripext<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; p.stripext() -&gt; Remove one file extension from the path.
&nbsp;
        For example, path('/home/guido/python.tar.gz').stripext()
        returns path('/home/guido/python.tar').
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">splitext</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> splitunc<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        unc<span style="color: #66cc66;">,</span> rest <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">splitunc</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>unc<span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span> rest
&nbsp;
    <span style="color: #66cc66;">@</span><span style="color: #008000;">property</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> uncshare<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot;
        The UNC mount point for this path.
        This is empty for paths on local drives.
        &quot;&quot;&quot;</span>
        unc<span style="color: #66cc66;">,</span> r <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">splitunc</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>unc<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># joinpath cast le premier argument si il n'est pas du même type que la</span>
    <span style="color: #808080; font-style: italic;"># classe en cours. Il n'y a pas de raison apparente, donc je suppose que</span>
    <span style="color: #808080; font-style: italic;"># c'est pour éviter une bug qu'ils ont découvert dans une situation</span>
    <span style="color: #808080; font-style: italic;"># borderline</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #66cc66;">@</span>multimethod
    <span style="color: #ff7700;font-weight:bold;">def</span> joinpath<span style="color: black;">&#40;</span>cls<span style="color: #66cc66;">,</span> first<span style="color: #66cc66;">,</span> *others<span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot;
        Join first to zero or more path components, adding a separator
        character (first.module.sep) if needed.  Returns a new instance of
        first._next_class.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #008000;">isinstance</span><span style="color: black;">&#40;</span>first<span style="color: #66cc66;">,</span> cls<span style="color: black;">&#41;</span>:
            first <span style="color: #66cc66;">=</span> cls<span style="color: black;">&#40;</span>first<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> first._next_class<span style="color: black;">&#40;</span>first.<span style="color: black;">module</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span>first<span style="color: #66cc66;">,</span> *others<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Puis on arrive enfin dans les méthodes métiers qui ne sont pas dans les</span>
    <span style="color: #808080; font-style: italic;"># modules. Typiquement ce seront des méthodes plus longues et inconnues</span>
    <span style="color: #808080; font-style: italic;"># car n'existant pas dans les autres modules donc :</span>
    <span style="color: #808080; font-style: italic;"># - on les met à la fin</span>
    <span style="color: #808080; font-style: italic;"># - la docstring est plus explicite.</span>
    <span style="color: #808080; font-style: italic;"># Ici splitall permet de faire :</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># &gt;&gt;&gt; path('/usr/lib/python2.7/fnmatch.pyc').splitall()</span>
    <span style="color: #808080; font-style: italic;"># [path(u'/'), u'usr', u'lib', u'python2.7', u'fnmatch.pyc']</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Ce que os.path ne permet pas de faire directement.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> splitall<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        r<span style="color: #483d8b;">&quot;&quot;&quot; Return a list of the path components in this path.
&nbsp;
        The first item in the list will be a path.  Its value will be
        either os.curdir, os.pardir, empty, or the root directory of
        this path (for example, ``'/'`` or ``'C:<span style="color: #000099; font-weight: bold;">\\</span>'``).  The other items in
        the list will be strings.
&nbsp;
        ``path.path.joinpath(*result)`` will yield the original path.
        &quot;&quot;&quot;</span>
        parts <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: black;">&#93;</span>
        loc <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>
        <span style="color: #ff7700;font-weight:bold;">while</span> loc <span style="color: #66cc66;">!=</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">curdir</span> <span style="color: #ff7700;font-weight:bold;">and</span> loc <span style="color: #66cc66;">!=</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">pardir</span>:
            prev <span style="color: #66cc66;">=</span> loc
            loc<span style="color: #66cc66;">,</span> child <span style="color: #66cc66;">=</span> prev.<span style="color: black;">splitpath</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">if</span> loc <span style="color: #66cc66;">==</span> prev:
                <span style="color: #ff7700;font-weight:bold;">break</span>
            parts.<span style="color: black;">append</span><span style="color: black;">&#40;</span>child<span style="color: black;">&#41;</span>
        parts.<span style="color: black;">append</span><span style="color: black;">&#40;</span>loc<span style="color: black;">&#41;</span>
        parts.<span style="color: black;">reverse</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> parts
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Voici une bonne pratique, avoir une méthode complexe (ici relpathto(),</span>
    <span style="color: #808080; font-style: italic;"># qui crée un chemin relatif du path() courant vers un autre dossier), et</span>
    <span style="color: #808080; font-style: italic;"># son opposée plus simple (ici relpath(), qui crée un chemin relatif d'un</span>
    <span style="color: #808080; font-style: italic;"># dossier vers le path courant) qui utilise la méthode précédente en en</span>
    <span style="color: #808080; font-style: italic;"># inversant juste les paramètres.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># En effet ça ne sert à rien d'écrire deux fois la même méthode, on</span>
    <span style="color: #808080; font-style: italic;"># factorise ainsi du code et respecte le principe DRY (don't repeat</span>
    <span style="color: #808080; font-style: italic;"># yourself).</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># relpathto() est un bon exemple d'un code assez complexe pour une</span>
    <span style="color: #808080; font-style: italic;"># opération qui parait pourtant assez simple. C'est aussi un très bon</span>
    <span style="color: #808080; font-style: italic;"># exemple de comment écrire des commentaires : on ne décrit pas les</span>
    <span style="color: #808080; font-style: italic;"># opérations évidentes mais on explique les choses ambiguës et on met des</span>
    <span style="color: #808080; font-style: italic;"># avertissements</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> relpath<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> start<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'.'</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Return this path as a relative path,
        based from start, which defaults to the current working directory.
        &quot;&quot;&quot;</span>
        cwd <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>start<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> cwd.<span style="color: black;">relpathto</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> relpathto<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> dest<span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Return a relative path from self to dest.
&nbsp;
        If there is no relative path from self to dest, for example if
        they reside on different drives in Windows, then this returns
        dest.abspath().
        &quot;&quot;&quot;</span>
        origin <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">abspath</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        dest <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>dest<span style="color: black;">&#41;</span>.<span style="color: black;">abspath</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
        orig_list <span style="color: #66cc66;">=</span> origin.<span style="color: black;">normcase</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: black;">splitall</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #808080; font-style: italic;"># Don't normcase dest!  We want to preserve the case.</span>
        dest_list <span style="color: #66cc66;">=</span> dest.<span style="color: black;">splitall</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">if</span> orig_list<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span> <span style="color: #66cc66;">!=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">normcase</span><span style="color: black;">&#40;</span>dest_list<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span>:
            <span style="color: #808080; font-style: italic;"># Can't get here from there.</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> dest
&nbsp;
        <span style="color: #808080; font-style: italic;"># Find the location where the two paths start to differ.</span>
        i <span style="color: #66cc66;">=</span> <span style="color: #ff4500;">0</span>
        <span style="color: #ff7700;font-weight:bold;">for</span> start_seg<span style="color: #66cc66;">,</span> dest_seg <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">zip</span><span style="color: black;">&#40;</span>orig_list<span style="color: #66cc66;">,</span> dest_list<span style="color: black;">&#41;</span>:
            <span style="color: #ff7700;font-weight:bold;">if</span> start_seg <span style="color: #66cc66;">!=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">normcase</span><span style="color: black;">&#40;</span>dest_seg<span style="color: black;">&#41;</span>:
                <span style="color: #ff7700;font-weight:bold;">break</span>
            i +<span style="color: #66cc66;">=</span> <span style="color: #ff4500;">1</span>
&nbsp;
        <span style="color: #808080; font-style: italic;"># Now i is the point where the two paths diverge.</span>
        <span style="color: #808080; font-style: italic;"># Need a certain number of &quot;os.pardir&quot;s to work up</span>
        <span style="color: #808080; font-style: italic;"># from the origin to the point of divergence.</span>
        segments <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: #dc143c;">os</span>.<span style="color: black;">pardir</span><span style="color: black;">&#93;</span> * <span style="color: black;">&#40;</span><span style="color: #008000;">len</span><span style="color: black;">&#40;</span>orig_list<span style="color: black;">&#41;</span> - i<span style="color: black;">&#41;</span>
        <span style="color: #808080; font-style: italic;"># Need to add the diverging part of dest_list.</span>
        segments +<span style="color: #66cc66;">=</span> dest_list<span style="color: black;">&#91;</span>i:<span style="color: black;">&#93;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">len</span><span style="color: black;">&#40;</span>segments<span style="color: black;">&#41;</span> <span style="color: #66cc66;">==</span> <span style="color: #ff4500;">0</span>:
            <span style="color: #808080; font-style: italic;"># If they happen to be identical, use os.curdir.</span>
            relpath <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">curdir</span>
        <span style="color: #ff7700;font-weight:bold;">else</span>:
            relpath <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span>*segments<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>relpath<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># --- Listing, searching, walking, and matching</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># un simple wrapper mais qui rajoute un argument en plus : un pattern à la</span>
    <span style="color: #808080; font-style: italic;"># unix. C'est une extension naturelle, et c'est le genre de chose que vous</span>
    <span style="color: #808080; font-style: italic;"># vouliez faire et vous vous êtes toujours demandé : &quot;mais pourquoi</span>
    <span style="color: #808080; font-style: italic;"># c'est pas par défaut ?&quot; ou &quot;comment on fait ça facilement ?&quot; Si vous</span>
    <span style="color: #808080; font-style: italic;"># vous posez ce genre de question, étendez un peu les comportements</span>
    <span style="color: #808080; font-style: italic;"># initiaux. Rajouter un argument ne rend pas le comportement différent du</span>
    <span style="color: #808080; font-style: italic;"># précédent grâce au paramètre par défaut mis à None, donc c'est tout</span>
    <span style="color: #808080; font-style: italic;"># bénef.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> listdir<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> pattern<span style="color: #66cc66;">=</span><span style="color: #008000;">None</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; D.listdir() -&gt; List of items in this directory.
&nbsp;
        Use D.files() or D.dirs() instead if you want a listing
        of just files or just subdirectories.
&nbsp;
        The elements of the list are path objects.
&nbsp;
        With the optional 'pattern' argument, this only lists
        items whose names match the given pattern.
        &quot;&quot;&quot;</span>
        names <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">listdir</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> pattern <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #008000;">None</span>:
            names <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">fnmatch</span>.<span style="color: #008000;">filter</span><span style="color: black;">&#40;</span>names<span style="color: #66cc66;">,</span> pattern<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: black;">&#91;</span><span style="color: #008000;">self</span> / child <span style="color: #ff7700;font-weight:bold;">for</span> child <span style="color: #ff7700;font-weight:bold;">in</span> names<span style="color: black;">&#93;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Dans la même lignée de ce qu'on a vu plus haut: utiliser une fonction</span>
    <span style="color: #808080; font-style: italic;"># plus complexe (qui déjà étend un comportement par défaut) pour en</span>
    <span style="color: #808080; font-style: italic;"># faire encore une méthode plus spécialisée.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># L'avantage de cette approche c'est que le code est plein de petites</span>
    <span style="color: #808080; font-style: italic;"># briques:</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># vous avez listdir(), qui est assez court (mais déjà plus puissant),</span>
    <span style="color: #808080; font-style: italic;"># puis dirs() et files(), qui font la même chose en plus spécialisés.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># L'alternative aurait été d'ajouter une param à listdir() et ne pas</span>
    <span style="color: #808080; font-style: italic;"># créer dirs() et files(), mais ça aurait rajouté un if dans le code et</span>
    <span style="color: #808080; font-style: italic;"># un paramètre qui fait rechercher dans la doc celui qui l'utilise et</span>
    <span style="color: #808080; font-style: italic;"># celui qui lit le code.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Avec l'approche actuelle, l'API est très claire :</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># for d in path('/etc').dirs()</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># On s'attend à lire tous les dossiers de /etc. Et les</span>
    <span style="color: #808080; font-style: italic;"># méthodes restent courtes.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> dirs<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> pattern<span style="color: #66cc66;">=</span><span style="color: #008000;">None</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; D.dirs() -&gt; List of this directory's subdirectories.
&nbsp;
        The elements of the list are path objects.
        This does not walk recursively into subdirectories
        (but see path.walkdirs).
&nbsp;
        With the optional 'pattern' argument, this only lists
        directories whose names match the given pattern.  For
        example, ``d.dirs('build-*')``.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: black;">&#91;</span>p <span style="color: #ff7700;font-weight:bold;">for</span> p <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">self</span>.<span style="color: black;">listdir</span><span style="color: black;">&#40;</span>pattern<span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">if</span> p.<span style="color: black;">isdir</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#93;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> files<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> pattern<span style="color: #66cc66;">=</span><span style="color: #008000;">None</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; D.files() -&gt; List of the files in this directory.
&nbsp;
        The elements of the list are path objects.
        This does not walk into subdirectories (see path.walkfiles).
&nbsp;
        With the optional 'pattern' argument, this only lists files
        whose names match the given pattern.  For example,
        ``d.files('*.pyc')``.
        &quot;&quot;&quot;</span>
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: black;">&#91;</span>p <span style="color: #ff7700;font-weight:bold;">for</span> p <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">self</span>.<span style="color: black;">listdir</span><span style="color: black;">&#40;</span>pattern<span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">if</span> p.<span style="color: black;">isfile</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#93;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># walk() et ses pendants walkdirs() et walkfiles() sont des alternatives</span>
    <span style="color: #808080; font-style: italic;"># au très peu intuitif os.path.walk qui permet de traverser récursivement</span>
    <span style="color: #808080; font-style: italic;"># un répertoire.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># En effet, en Python les callbacks sont quelque chose qu'on utilise peu,</span>
    <span style="color: #808080; font-style: italic;"># et à l'inverse, on itère beaucoup.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Cela permet de faire:</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># for f in path('/etc').walk_files():</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Pour lister récursivement tous les fichiers de /etc et de ses sous</span>
    <span style="color: #808080; font-style: italic;"># (et sous, sous, sous) dossiers.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># C'est clair, c'est simple à comprendre et facile à utiliser.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># L'auteur utilise ici 'yield', et c'est l'outil parfait pour cela.</span>
    <span style="color: #808080; font-style: italic;"># Souvenez vous de 'yield' comme un très bon moyen de parcourir des choses</span>
    <span style="color: #808080; font-style: italic;"># imbriquées comme si c'était une structure plate à une dimension.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Yield permet de transformer n'importe quelle méthode d'un objet en</span>
    <span style="color: #808080; font-style: italic;"># un générateur sur un algorithme qui peut être très complexe, simplifiant</span>
    <span style="color: #808080; font-style: italic;"># son utilisation. Pensez-y !</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Sous le capot, c'est presque un appel récursif, si ce n'est qu'un nouvel</span>
    <span style="color: #808080; font-style: italic;"># objet path() est créé à chaque fois, depuis lequel on fait walk().</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Notez également que sur une méthode comme ça qui peut foirer facilement</span>
    <span style="color: #808080; font-style: italic;"># (une opération sur des centaines de fichiers...), un paramètre permet</span>
    <span style="color: #808080; font-style: italic;"># de choisir une gestion des erreurs parmi :</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># - lever une exception (qui est dans un code propre le choix par défaut)</span>
    <span style="color: #808080; font-style: italic;"># - ignorer (pour faire un code tolérant aux erreurs)</span>
    <span style="color: #808080; font-style: italic;"># - ou faire un retour sans erreur, mais avec un warning technique (utile</span>
    <span style="color: #808080; font-style: italic;">#     pour le scripting)</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Encore une fois, faire une classe, c'est l'occasion de penser à</span>
    <span style="color: #808080; font-style: italic;"># l'utilisateur de la classe, ce qui a été ici bien fait.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Enfin, contrairement à ce qu'on pourrait attendre, walkdirs et walkfiles</span>
    <span style="color: #808080; font-style: italic;"># n'utilisent pas walk(), ce qui est généralement fait pour des raisons de</span>
    <span style="color: #808080; font-style: italic;"># performances (on sacrifie le DRY pour éviter un appel de callback</span>
    <span style="color: #808080; font-style: italic;"># ou un test sur des grosses boucles), même si ici c'est une supposition.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> walk<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> pattern<span style="color: #66cc66;">=</span><span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> errors<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'strict'</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; D.walk() -&gt; iterator over files and subdirs, recursively.
&nbsp;
        The iterator yields path objects naming each child item of
        this directory and its descendants.  This requires that
        D.isdir().
&nbsp;
        This performs a depth-first traversal of the directory tree.
        Each directory is returned just before all its children.
&nbsp;
        The errors= keyword argument controls behavior when an
        error occurs.  The default is 'strict', which causes an
        exception.  The other allowed values are 'warn', which
        reports the error via warnings.warn(), and 'ignore'.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> errors <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: black;">&#40;</span><span style="color: #483d8b;">'strict'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'warn'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'ignore'</span><span style="color: black;">&#41;</span>:
            <span style="color: #ff7700;font-weight:bold;">raise</span> <span style="color: #008000;">ValueError</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;invalid errors parameter&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            childList <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">listdir</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">Exception</span>:
            <span style="color: #ff7700;font-weight:bold;">if</span> errors <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'ignore'</span>:
                <span style="color: #ff7700;font-weight:bold;">return</span>
            <span style="color: #ff7700;font-weight:bold;">elif</span> errors <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'warn'</span>:
                <span style="color: #dc143c;">warnings</span>.<span style="color: black;">warn</span><span style="color: black;">&#40;</span>
                    <span style="color: #483d8b;">&quot;Unable to list directory '%s': %s&quot;</span>
                    % <span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">sys</span>.<span style="color: black;">exc_info</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span>
                    TreeWalkWarning<span style="color: black;">&#41;</span>
                <span style="color: #ff7700;font-weight:bold;">return</span>
            <span style="color: #ff7700;font-weight:bold;">else</span>:
                <span style="color: #ff7700;font-weight:bold;">raise</span>
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">for</span> child <span style="color: #ff7700;font-weight:bold;">in</span> childList:
            <span style="color: #ff7700;font-weight:bold;">if</span> pattern <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #008000;">None</span> <span style="color: #ff7700;font-weight:bold;">or</span> child.<span style="color: #dc143c;">fnmatch</span><span style="color: black;">&#40;</span>pattern<span style="color: black;">&#41;</span>:
                <span style="color: #ff7700;font-weight:bold;">yield</span> child
            <span style="color: #ff7700;font-weight:bold;">try</span>:
                isdir <span style="color: #66cc66;">=</span> child.<span style="color: black;">isdir</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">Exception</span>:
                <span style="color: #ff7700;font-weight:bold;">if</span> errors <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'ignore'</span>:
                    isdir <span style="color: #66cc66;">=</span> <span style="color: #008000;">False</span>
                <span style="color: #ff7700;font-weight:bold;">elif</span> errors <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'warn'</span>:
                    <span style="color: #dc143c;">warnings</span>.<span style="color: black;">warn</span><span style="color: black;">&#40;</span>
                        <span style="color: #483d8b;">&quot;Unable to access '%s': %s&quot;</span>
                        % <span style="color: black;">&#40;</span>child<span style="color: #66cc66;">,</span> <span style="color: #dc143c;">sys</span>.<span style="color: black;">exc_info</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span>
                        TreeWalkWarning<span style="color: black;">&#41;</span>
                    isdir <span style="color: #66cc66;">=</span> <span style="color: #008000;">False</span>
                <span style="color: #ff7700;font-weight:bold;">else</span>:
                    <span style="color: #ff7700;font-weight:bold;">raise</span>
&nbsp;
            <span style="color: #ff7700;font-weight:bold;">if</span> isdir:
                <span style="color: #ff7700;font-weight:bold;">for</span> item <span style="color: #ff7700;font-weight:bold;">in</span> child.<span style="color: black;">walk</span><span style="color: black;">&#40;</span>pattern<span style="color: #66cc66;">,</span> errors<span style="color: black;">&#41;</span>:
                    <span style="color: #ff7700;font-weight:bold;">yield</span> item
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> walkdirs<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> pattern<span style="color: #66cc66;">=</span><span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> errors<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'strict'</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; D.walkdirs() -&gt; iterator over subdirs, recursively.
&nbsp;
        With the optional 'pattern' argument, this yields only
        directories whose names match the given pattern.  For
        example, ``mydir.walkdirs('*test')`` yields only directories
        with names ending in 'test'.
&nbsp;
        The errors= keyword argument controls behavior when an
        error occurs.  The default is 'strict', which causes an
        exception.  The other allowed values are 'warn', which
        reports the error via warnings.warn(), and 'ignore'.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> errors <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: black;">&#40;</span><span style="color: #483d8b;">'strict'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'warn'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'ignore'</span><span style="color: black;">&#41;</span>:
            <span style="color: #ff7700;font-weight:bold;">raise</span> <span style="color: #008000;">ValueError</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;invalid errors parameter&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            dirs <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">dirs</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">Exception</span>:
            <span style="color: #ff7700;font-weight:bold;">if</span> errors <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'ignore'</span>:
                <span style="color: #ff7700;font-weight:bold;">return</span>
            <span style="color: #ff7700;font-weight:bold;">elif</span> errors <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'warn'</span>:
                <span style="color: #dc143c;">warnings</span>.<span style="color: black;">warn</span><span style="color: black;">&#40;</span>
                    <span style="color: #483d8b;">&quot;Unable to list directory '%s': %s&quot;</span>
                    % <span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">sys</span>.<span style="color: black;">exc_info</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span>
                    TreeWalkWarning<span style="color: black;">&#41;</span>
                <span style="color: #ff7700;font-weight:bold;">return</span>
            <span style="color: #ff7700;font-weight:bold;">else</span>:
                <span style="color: #ff7700;font-weight:bold;">raise</span>
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">for</span> child <span style="color: #ff7700;font-weight:bold;">in</span> dirs:
            <span style="color: #ff7700;font-weight:bold;">if</span> pattern <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #008000;">None</span> <span style="color: #ff7700;font-weight:bold;">or</span> child.<span style="color: #dc143c;">fnmatch</span><span style="color: black;">&#40;</span>pattern<span style="color: black;">&#41;</span>:
                <span style="color: #ff7700;font-weight:bold;">yield</span> child
            <span style="color: #ff7700;font-weight:bold;">for</span> subsubdir <span style="color: #ff7700;font-weight:bold;">in</span> child.<span style="color: black;">walkdirs</span><span style="color: black;">&#40;</span>pattern<span style="color: #66cc66;">,</span> errors<span style="color: black;">&#41;</span>:
                <span style="color: #ff7700;font-weight:bold;">yield</span> subsubdir
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> walkfiles<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> pattern<span style="color: #66cc66;">=</span><span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> errors<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'strict'</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; D.walkfiles() -&gt; iterator over files in D, recursively.
&nbsp;
        The optional argument, pattern, limits the results to files
        with names that match the pattern.  For example,
        ``mydir.walkfiles('*.tmp')`` yields only files with the .tmp
        extension.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> errors <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: black;">&#40;</span><span style="color: #483d8b;">'strict'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'warn'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'ignore'</span><span style="color: black;">&#41;</span>:
            <span style="color: #ff7700;font-weight:bold;">raise</span> <span style="color: #008000;">ValueError</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;invalid errors parameter&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            childList <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">listdir</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">Exception</span>:
            <span style="color: #ff7700;font-weight:bold;">if</span> errors <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'ignore'</span>:
                <span style="color: #ff7700;font-weight:bold;">return</span>
            <span style="color: #ff7700;font-weight:bold;">elif</span> errors <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'warn'</span>:
                <span style="color: #dc143c;">warnings</span>.<span style="color: black;">warn</span><span style="color: black;">&#40;</span>
                    <span style="color: #483d8b;">&quot;Unable to list directory '%s': %s&quot;</span>
                    % <span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">sys</span>.<span style="color: black;">exc_info</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span>
                    TreeWalkWarning<span style="color: black;">&#41;</span>
                <span style="color: #ff7700;font-weight:bold;">return</span>
            <span style="color: #ff7700;font-weight:bold;">else</span>:
                <span style="color: #ff7700;font-weight:bold;">raise</span>
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">for</span> child <span style="color: #ff7700;font-weight:bold;">in</span> childList:
            <span style="color: #ff7700;font-weight:bold;">try</span>:
                isfile <span style="color: #66cc66;">=</span> child.<span style="color: black;">isfile</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
                isdir <span style="color: #66cc66;">=</span> <span style="color: #ff7700;font-weight:bold;">not</span> isfile <span style="color: #ff7700;font-weight:bold;">and</span> child.<span style="color: black;">isdir</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">except</span>:
                <span style="color: #ff7700;font-weight:bold;">if</span> errors <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'ignore'</span>:
                    <span style="color: #ff7700;font-weight:bold;">continue</span>
                <span style="color: #ff7700;font-weight:bold;">elif</span> errors <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'warn'</span>:
                    <span style="color: #dc143c;">warnings</span>.<span style="color: black;">warn</span><span style="color: black;">&#40;</span>
                        <span style="color: #483d8b;">&quot;Unable to access '%s': %s&quot;</span>
                        % <span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">sys</span>.<span style="color: black;">exc_info</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span>
                        TreeWalkWarning<span style="color: black;">&#41;</span>
                    <span style="color: #ff7700;font-weight:bold;">continue</span>
                <span style="color: #ff7700;font-weight:bold;">else</span>:
                    <span style="color: #ff7700;font-weight:bold;">raise</span>
&nbsp;
            <span style="color: #ff7700;font-weight:bold;">if</span> isfile:
                <span style="color: #ff7700;font-weight:bold;">if</span> pattern <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #008000;">None</span> <span style="color: #ff7700;font-weight:bold;">or</span> child.<span style="color: #dc143c;">fnmatch</span><span style="color: black;">&#40;</span>pattern<span style="color: black;">&#41;</span>:
                    <span style="color: #ff7700;font-weight:bold;">yield</span> child
            <span style="color: #ff7700;font-weight:bold;">elif</span> isdir:
                <span style="color: #ff7700;font-weight:bold;">for</span> f <span style="color: #ff7700;font-weight:bold;">in</span> child.<span style="color: black;">walkfiles</span><span style="color: black;">&#40;</span>pattern<span style="color: #66cc66;">,</span> errors<span style="color: black;">&#41;</span>:
                    <span style="color: #ff7700;font-weight:bold;">yield</span> f
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #dc143c;">fnmatch</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> pattern<span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Return True if self.name matches the given pattern.
&nbsp;
        pattern - A filename pattern with wildcards,
            for example ``'*.py'``.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #dc143c;">fnmatch</span>.<span style="color: #dc143c;">fnmatch</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">name</span><span style="color: #66cc66;">,</span> pattern<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #dc143c;">glob</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> pattern<span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Return a list of path objects that match the pattern.
&nbsp;
        pattern - a path relative to this directory, with wildcards.
&nbsp;
        For example, path('/users').glob('*/bin/*') returns a list
        of all the files users have in their bin directories.
        &quot;&quot;&quot;</span>
        cls <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>._next_class
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: black;">&#91;</span>cls<span style="color: black;">&#40;</span>s<span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">for</span> s <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #dc143c;">glob</span>.<span style="color: #dc143c;">glob</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span> / pattern<span style="color: black;">&#41;</span><span style="color: black;">&#93;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#</span>
    <span style="color: #808080; font-style: italic;"># --- Reading or writing an entire file at once.</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'r'</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Open this file.  Return a file object. &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># L'avantage d'avoir une classe comme point de départ de tout c'est que</span>
    <span style="color: #808080; font-style: italic;"># c'est facile à manipuler dans le shell, surtout en autocompletion.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Donc il est bon de mettre quelques outils qui sont pratiques dans les</span>
    <span style="color: #808080; font-style: italic;"># usages type shell.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Ici c'est exactement le cas : on fait des méthodes un peu bourrines (</span>
    <span style="color: #808080; font-style: italic;"># globalement ça dump en mémoire ou ça écrit tout le fichier d'un coup),</span>
    <span style="color: #808080; font-style: italic;"># mais très pratiques pour manipuler les objets dans un terminal.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Notez aussi le nettoyage opéré:</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#             return (t.replace(u'\r\n', u'\n')</span>
    <span style="color: #808080; font-style: italic;">#                  .replace(u'\r\x85', u'\n')</span>
    <span style="color: #808080; font-style: italic;">#                  .replace(u'\r', u'\n')</span>
    <span style="color: #808080; font-style: italic;">#                  .replace(u'\x85', u'\n')</span>
    <span style="color: #808080; font-style: italic;">#                  .replace(u'\u2028', u'\n'))</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Ce n'est pas particulièrement lié à la POO, mais l'encapsulation de</span>
    <span style="color: #808080; font-style: italic;"># ce genre de process est toujours le bienvenu. L'idée est que l'objet</span>
    <span style="color: #808080; font-style: italic;"># puisse être utilisé comme une boîte noire en laquelle on a totalement</span>
    <span style="color: #808080; font-style: italic;"># confiance.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #dc143c;">bytes</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Open this file, read all bytes, return them as a string. &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">with</span> <span style="color: #008000;">self</span>.<span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'rb'</span><span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">as</span> f:
            <span style="color: #ff7700;font-weight:bold;">return</span> f.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> write_bytes<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">bytes</span><span style="color: #66cc66;">,</span> append<span style="color: #66cc66;">=</span><span style="color: #008000;">False</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Open this file and write the given bytes to it.
&nbsp;
        Default behavior is to overwrite any existing file.
        Call p.write_bytes(bytes, append=True) to append instead.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> append:
            mode <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'ab'</span>
        <span style="color: #ff7700;font-weight:bold;">else</span>:
            mode <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'wb'</span>
        <span style="color: #ff7700;font-weight:bold;">with</span> <span style="color: #008000;">self</span>.<span style="color: #008000;">open</span><span style="color: black;">&#40;</span>mode<span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">as</span> f:
            f.<span style="color: black;">write</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">bytes</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> text<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> encoding<span style="color: #66cc66;">=</span><span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> errors<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'strict'</span><span style="color: black;">&#41;</span>:
        r<span style="color: #483d8b;">&quot;&quot;&quot; Open this file, read it in, return the content as a string.
&nbsp;
        This method uses 'U' mode, so '<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>' and '<span style="color: #000099; font-weight: bold;">\r</span>' are automatically
        translated to '<span style="color: #000099; font-weight: bold;">\n</span>'.
&nbsp;
        Optional arguments:
&nbsp;
        encoding - The Unicode encoding (or character set) of
            the file.  If present, the content of the file is
            decoded and returned as a unicode object; otherwise
            it is returned as an 8-bit str.
        errors - How to handle Unicode errors; see help(str.decode)
            for the options.  Default is 'strict'.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> encoding <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #008000;">None</span>:
            <span style="color: #808080; font-style: italic;"># 8-bit</span>
            <span style="color: #ff7700;font-weight:bold;">with</span> <span style="color: #008000;">self</span>.<span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'U'</span><span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">as</span> f:
                <span style="color: #ff7700;font-weight:bold;">return</span> f.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">else</span>:
            <span style="color: #808080; font-style: italic;"># Unicode</span>
            <span style="color: #ff7700;font-weight:bold;">with</span> <span style="color: #dc143c;">codecs</span>.<span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'r'</span><span style="color: #66cc66;">,</span> encoding<span style="color: #66cc66;">,</span> errors<span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">as</span> f:
                <span style="color: #808080; font-style: italic;"># (Note - Can't use 'U' mode here, since codecs.open</span>
                <span style="color: #808080; font-style: italic;"># doesn't support 'U' mode.)</span>
                t <span style="color: #66cc66;">=</span> f.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: black;">&#40;</span>t.<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span>
                     .<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\x</span>85'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span>
                     .<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span>'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span>
                     .<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\x</span>85'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span>
                     .<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\u</span>2028'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Sur des méthodes avec de nombreux paramètres, ne pas hésiter</span>
    <span style="color: #808080; font-style: italic;"># à mettre un maximum de valeurs par défaut &quot;saines&quot; (c'est à dire la</span>
    <span style="color: #808080; font-style: italic;"># valeur du cas le plus courant ou pragmatique).</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Comme c'est une grosse fonction très configurable, la docstring</span>
    <span style="color: #808080; font-style: italic;"># est écrite en conséquence. Ne soyez pas timide avec la dosctring,</span>
    <span style="color: #808080; font-style: italic;"># on peut la faire très très très longue, ce n'est pas une mauvaise</span>
    <span style="color: #808080; font-style: italic;"># chose.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Notez que la docstring est préfixée d'un &quot;r&quot; ici, pour que Python</span>
    <span style="color: #808080; font-style: italic;"># n'interprète pas les \n et \r.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> write_text<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> text<span style="color: #66cc66;">,</span> encoding<span style="color: #66cc66;">=</span><span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> errors<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'strict'</span><span style="color: #66cc66;">,</span> linesep<span style="color: #66cc66;">=</span><span style="color: #dc143c;">os</span>.<span style="color: black;">linesep</span><span style="color: #66cc66;">,</span> append<span style="color: #66cc66;">=</span><span style="color: #008000;">False</span><span style="color: black;">&#41;</span>:
        r<span style="color: #483d8b;">&quot;&quot;&quot; Write the given text to this file.
&nbsp;
        The default behavior is to overwrite any existing file;
        to append instead, use the 'append=True' keyword argument.
&nbsp;
        There are two differences between path.write_text() and
        path.write_bytes(): newline handling and Unicode handling.
        See below.
&nbsp;
        Parameters:
&nbsp;
          - text - str/unicode - The text to be written.
&nbsp;
          - encoding - str - The Unicode encoding that will be used.
            This is ignored if 'text' isn't a Unicode string.
&nbsp;
          - errors - str - How to handle Unicode encoding errors.
            Default is 'strict'.  See help(unicode.encode) for the
            options.  This is ignored if 'text' isn't a Unicode
            string.
&nbsp;
          - linesep - keyword argument - str/unicode - The sequence of
            characters to be used to mark end-of-line.  The default is
            os.linesep.  You can also specify None; this means to
            leave all newlines as they are in 'text'.
&nbsp;
          - append - keyword argument - bool - Specifies what to do if
            the file already exists (True: append to the end of it;
            False: overwrite it.)  The default is False.
&nbsp;
&nbsp;
        --- Newline handling.
&nbsp;
        write_text() converts all standard end-of-line sequences
        ('<span style="color: #000099; font-weight: bold;">\n</span>', '<span style="color: #000099; font-weight: bold;">\r</span>', and '<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>') to your platform's default end-of-line
        sequence (see os.linesep; on Windows, for example, the
        end-of-line marker is '<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>').
&nbsp;
        If you don't like your platform's default, you can override it
        using the 'linesep=' keyword argument.  If you specifically want
        write_text() to preserve the newlines as-is, use 'linesep=None'.
&nbsp;
        This applies to Unicode text the same as to 8-bit text, except
        there are three additional standard Unicode end-of-line sequences:
        u'<span style="color: #000099; font-weight: bold;">\x</span>85', u'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\x</span>85', and u'<span style="color: #000099; font-weight: bold;">\u</span>2028'.
&nbsp;
        (This is slightly different from when you open a file for
        writing with fopen(filename, &quot;w&quot;) in C or open(filename, 'w')
        in Python.)
&nbsp;
&nbsp;
        --- Unicode
&nbsp;
        If 'text' isn't Unicode, then apart from newline handling, the
        bytes are written verbatim to the file.  The 'encoding' and
        'errors' arguments are not used and must be omitted.
&nbsp;
        If 'text' is Unicode, it is first converted to bytes using the
        specified 'encoding' (or the default encoding if 'encoding'
        isn't specified).  The 'errors' argument applies only to this
        conversion.
&nbsp;
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">isinstance</span><span style="color: black;">&#40;</span>text<span style="color: #66cc66;">,</span> <span style="color: #008000;">unicode</span><span style="color: black;">&#41;</span>:
            <span style="color: #ff7700;font-weight:bold;">if</span> linesep <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #008000;">None</span>:
                <span style="color: #808080; font-style: italic;"># Convert all standard end-of-line sequences to</span>
                <span style="color: #808080; font-style: italic;"># ordinary newline characters.</span>
                text <span style="color: #66cc66;">=</span> <span style="color: black;">&#40;</span>text.<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span>
                            .<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\x</span>85'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span>
                            .<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span>'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span>
                            .<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\x</span>85'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span>
                            .<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\u</span>2028'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
                text <span style="color: #66cc66;">=</span> text.<span style="color: black;">replace</span><span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #66cc66;">,</span> linesep<span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">if</span> encoding <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #008000;">None</span>:
                encoding <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">sys</span>.<span style="color: black;">getdefaultencoding</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
            <span style="color: #dc143c;">bytes</span> <span style="color: #66cc66;">=</span> text.<span style="color: black;">encode</span><span style="color: black;">&#40;</span>encoding<span style="color: #66cc66;">,</span> errors<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">else</span>:
            <span style="color: #808080; font-style: italic;"># It is an error to specify an encoding if 'text' is</span>
            <span style="color: #808080; font-style: italic;"># an 8-bit string.</span>
            <span style="color: #ff7700;font-weight:bold;">assert</span> encoding <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #008000;">None</span>
&nbsp;
            <span style="color: #ff7700;font-weight:bold;">if</span> linesep <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #008000;">None</span>:
                text <span style="color: #66cc66;">=</span> <span style="color: black;">&#40;</span>text.<span style="color: black;">replace</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span>
                            .<span style="color: black;">replace</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span>'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
                <span style="color: #dc143c;">bytes</span> <span style="color: #66cc66;">=</span> text.<span style="color: black;">replace</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #66cc66;">,</span> linesep<span style="color: black;">&#41;</span>
&nbsp;
        <span style="color: #008000;">self</span>.<span style="color: black;">write_bytes</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">bytes</span><span style="color: #66cc66;">,</span> append<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> lines<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> encoding<span style="color: #66cc66;">=</span><span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> errors<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'strict'</span><span style="color: #66cc66;">,</span> retain<span style="color: #66cc66;">=</span><span style="color: #008000;">True</span><span style="color: black;">&#41;</span>:
        r<span style="color: #483d8b;">&quot;&quot;&quot; Open this file, read all lines, return them in a list.
&nbsp;
        Optional arguments:
            encoding - The Unicode encoding (or character set) of
                the file.  The default is None, meaning the content
                of the file is read as 8-bit characters and returned
                as a list of (non-Unicode) str objects.
            errors - How to handle Unicode errors; see help(str.decode)
                for the options.  Default is 'strict'
            retain - If true, retain newline characters; but all newline
                character combinations ('<span style="color: #000099; font-weight: bold;">\r</span>', '<span style="color: #000099; font-weight: bold;">\n</span>', '<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>') are
                translated to '<span style="color: #000099; font-weight: bold;">\n</span>'.  If false, newline characters are
                stripped off.  Default is True.
&nbsp;
        This uses 'U' mode.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> encoding <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #008000;">None</span> <span style="color: #ff7700;font-weight:bold;">and</span> retain:
            <span style="color: #ff7700;font-weight:bold;">with</span> <span style="color: #008000;">self</span>.<span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'U'</span><span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">as</span> f:
                <span style="color: #ff7700;font-weight:bold;">return</span> f.<span style="color: black;">readlines</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">else</span>:
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">text</span><span style="color: black;">&#40;</span>encoding<span style="color: #66cc66;">,</span> errors<span style="color: black;">&#41;</span>.<span style="color: black;">splitlines</span><span style="color: black;">&#40;</span>retain<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> write_lines<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> lines<span style="color: #66cc66;">,</span> encoding<span style="color: #66cc66;">=</span><span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> errors<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'strict'</span><span style="color: #66cc66;">,</span>
                    linesep<span style="color: #66cc66;">=</span><span style="color: #dc143c;">os</span>.<span style="color: black;">linesep</span><span style="color: #66cc66;">,</span> append<span style="color: #66cc66;">=</span><span style="color: #008000;">False</span><span style="color: black;">&#41;</span>:
        r<span style="color: #483d8b;">&quot;&quot;&quot; Write the given lines of text to this file.
&nbsp;
        By default this overwrites any existing file at this path.
&nbsp;
        This puts a platform-specific newline sequence on every line.
        See 'linesep' below.
&nbsp;
        lines - A list of strings.
&nbsp;
        encoding - A Unicode encoding to use.  This applies only if
            'lines' contains any Unicode strings.
&nbsp;
        errors - How to handle errors in Unicode encoding.  This
            also applies only to Unicode strings.
&nbsp;
        linesep - The desired line-ending.  This line-ending is
            applied to every line.  If a line already has any
            standard line ending ('<span style="color: #000099; font-weight: bold;">\r</span>', '<span style="color: #000099; font-weight: bold;">\n</span>', '<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>', u'<span style="color: #000099; font-weight: bold;">\x</span>85',
            u'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\x</span>85', u'<span style="color: #000099; font-weight: bold;">\u</span>2028'), that will be stripped off and
            this will be used instead.  The default is os.linesep,
            which is platform-dependent ('<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>' on Windows, '<span style="color: #000099; font-weight: bold;">\n</span>' on
            Unix, etc.)  Specify None to write the lines as-is,
            like file.writelines().
&nbsp;
        Use the keyword argument append=True to append lines to the
        file.  The default is to overwrite the file.  Warning:
        When you use this with Unicode data, if the encoding of the
        existing data in the file is different from the encoding
        you specify with the encoding= parameter, the result is
        mixed-encoding data, which can really confuse someone trying
        to read the file later.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">if</span> append:
            mode <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'ab'</span>
        <span style="color: #ff7700;font-weight:bold;">else</span>:
            mode <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'wb'</span>
        <span style="color: #ff7700;font-weight:bold;">with</span> <span style="color: #008000;">self</span>.<span style="color: #008000;">open</span><span style="color: black;">&#40;</span>mode<span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">as</span> f:
            <span style="color: #ff7700;font-weight:bold;">for</span> line <span style="color: #ff7700;font-weight:bold;">in</span> lines:
                isUnicode <span style="color: #66cc66;">=</span> <span style="color: #008000;">isinstance</span><span style="color: black;">&#40;</span>line<span style="color: #66cc66;">,</span> <span style="color: #008000;">unicode</span><span style="color: black;">&#41;</span>
                <span style="color: #ff7700;font-weight:bold;">if</span> linesep <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #008000;">None</span>:
                    <span style="color: #808080; font-style: italic;"># Strip off any existing line-end and add the</span>
                    <span style="color: #808080; font-style: italic;"># specified linesep string.</span>
                    <span style="color: #ff7700;font-weight:bold;">if</span> isUnicode:
                        <span style="color: #ff7700;font-weight:bold;">if</span> line<span style="color: black;">&#91;</span>-<span style="color: #ff4500;">2</span>:<span style="color: black;">&#93;</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\x</span>0d<span style="color: #000099; font-weight: bold;">\x</span>85'</span><span style="color: black;">&#41;</span>:
                            line <span style="color: #66cc66;">=</span> line<span style="color: black;">&#91;</span>:-<span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>
                        <span style="color: #ff7700;font-weight:bold;">elif</span> line<span style="color: black;">&#91;</span>-<span style="color: #ff4500;">1</span>:<span style="color: black;">&#93;</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: black;">&#40;</span>u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span>'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #66cc66;">,</span>
                                           u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\x</span>85'</span><span style="color: #66cc66;">,</span> u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\u</span>2028'</span><span style="color: black;">&#41;</span>:
                            line <span style="color: #66cc66;">=</span> line<span style="color: black;">&#91;</span>:-<span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>
                    <span style="color: #ff7700;font-weight:bold;">else</span>:
                        <span style="color: #ff7700;font-weight:bold;">if</span> line<span style="color: black;">&#91;</span>-<span style="color: #ff4500;">2</span>:<span style="color: black;">&#93;</span> <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>:
                            line <span style="color: #66cc66;">=</span> line<span style="color: black;">&#91;</span>:-<span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>
                        <span style="color: #ff7700;font-weight:bold;">elif</span> line<span style="color: black;">&#91;</span>-<span style="color: #ff4500;">1</span>:<span style="color: black;">&#93;</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: black;">&#40;</span><span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span>'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: black;">&#41;</span>:
                            line <span style="color: #66cc66;">=</span> line<span style="color: black;">&#91;</span>:-<span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>
                    line +<span style="color: #66cc66;">=</span> linesep
                <span style="color: #ff7700;font-weight:bold;">if</span> isUnicode:
                    <span style="color: #ff7700;font-weight:bold;">if</span> encoding <span style="color: #ff7700;font-weight:bold;">is</span> <span style="color: #008000;">None</span>:
                        encoding <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">sys</span>.<span style="color: black;">getdefaultencoding</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
                    line <span style="color: #66cc66;">=</span> line.<span style="color: black;">encode</span><span style="color: black;">&#40;</span>encoding<span style="color: #66cc66;">,</span> errors<span style="color: black;">&#41;</span>
                f.<span style="color: black;">write</span><span style="color: black;">&#40;</span>line<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> read_md5<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Calculate the md5 hash for this file.
&nbsp;
        This reads through the entire file.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">read_hash</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'md5'</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> _hash<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> hash_name<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">with</span> <span style="color: #008000;">self</span>.<span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'rb'</span><span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">as</span> f:
            m <span style="color: #66cc66;">=</span> hashlib.<span style="color: #dc143c;">new</span><span style="color: black;">&#40;</span>hash_name<span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">while</span> <span style="color: #008000;">True</span>:
                d <span style="color: #66cc66;">=</span> f.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">8192</span><span style="color: black;">&#41;</span>
                <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #ff7700;font-weight:bold;">not</span> d:
                    <span style="color: #ff7700;font-weight:bold;">break</span>
                m.<span style="color: black;">update</span><span style="color: black;">&#40;</span>d<span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> m
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> read_hash<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> hash_name<span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Calculate given hash for this file.
&nbsp;
        List of supported hashes can be obtained from hashlib package. This
        reads the entire file.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._hash<span style="color: black;">&#40;</span>hash_name<span style="color: black;">&#41;</span>.<span style="color: black;">digest</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> read_hexhash<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> hash_name<span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Calculate given hash for this file, returning hexdigest.
&nbsp;
        List of supported hashes can be obtained from hashlib package. This
        reads the entire file.
        &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._hash<span style="color: black;">&#40;</span>hash_name<span style="color: black;">&#41;</span>.<span style="color: black;">hexdigest</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Comme les fonctions, les méthodes peuvent être définies sur une ligne si</span>
    <span style="color: #808080; font-style: italic;"># le bloc ne fait qu'une ligne de taille. On utilise ça quand la fonction</span>
    <span style="color: #808080; font-style: italic;"># est juste un alias un peu avancé comme ici pour garder un style quasi</span>
    <span style="color: #808080; font-style: italic;"># déclaratif.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># --- Methods for querying the filesystem.</span>
    <span style="color: #808080; font-style: italic;"># N.B. On some platforms, the os.path functions may be implemented in C</span>
    <span style="color: #808080; font-style: italic;"># (e.g. isdir on Windows, Python 3.2.2), and compiled functions don't get</span>
    <span style="color: #808080; font-style: italic;"># bound. Playing it safe and wrapping them all in method calls.</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> isabs<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">isabs</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> exists<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">exists</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> isdir<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">isdir</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> isfile<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">isfile</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> islink<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">islink</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> ismount<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">ismount</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> samefile<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">samefile</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> getatime<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">getatime</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
    atime <span style="color: #66cc66;">=</span> <span style="color: #008000;">property</span><span style="color: black;">&#40;</span>
        getatime<span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span>
        <span style="color: #483d8b;">&quot;&quot;&quot; Last access time of the file. &quot;&quot;&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> getmtime<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">getmtime</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
    mtime <span style="color: #66cc66;">=</span> <span style="color: #008000;">property</span><span style="color: black;">&#40;</span>
        getmtime<span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span>
        <span style="color: #483d8b;">&quot;&quot;&quot; Last-modified time of the file. &quot;&quot;&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> getctime<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">getctime</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
    ctime <span style="color: #66cc66;">=</span> <span style="color: #008000;">property</span><span style="color: black;">&#40;</span>
        getctime<span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span>
        <span style="color: #483d8b;">&quot;&quot;&quot; Creation time of the file. &quot;&quot;&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> getsize<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>: <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>.<span style="color: black;">module</span>.<span style="color: black;">getsize</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
    size <span style="color: #66cc66;">=</span> <span style="color: #008000;">property</span><span style="color: black;">&#40;</span>
        getsize<span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span>
        <span style="color: #483d8b;">&quot;&quot;&quot; Size of the file, in bytes. &quot;&quot;&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Technique intéressante : on peut générer dynamiquement le corps de</span>
    <span style="color: #808080; font-style: italic;"># la classe. En effet, il peut contenir des if, des try, des for, etc.</span>
    <span style="color: #808080; font-style: italic;"># Ici par exemple, on ne définit la méthode access() que si le module</span>
    <span style="color: #808080; font-style: italic;"># 'os' possède l'attribut 'access'.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Si ce n'est pas le cas, la classe n'aura pas cette méthode.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">hasattr</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'access'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">def</span> access<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: black;">&#41;</span>:
            <span style="color: #483d8b;">&quot;&quot;&quot; Return true if current user has access to this path.
&nbsp;
            mode - One of the constants os.F_OK, os.R_OK, os.W_OK, os.X_OK
            &quot;&quot;&quot;</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">access</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #dc143c;">stat</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Perform a stat() system call on this path. &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #dc143c;">os</span>.<span style="color: #dc143c;">stat</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> lstat<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Like path.stat(), but do not follow symbolic links. &quot;&quot;&quot;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">lstat</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Une autre technique intéressante : une des rares utilisation du double</span>
    <span style="color: #808080; font-style: italic;"># '_' en tant que préfixe qui ait du sens. '__method' interdit d'accéder</span>
    <span style="color: #808080; font-style: italic;"># directement à la méthode depuis l'extérieur. C'est ce qu'on a de plus</span>
    <span style="color: #808080; font-style: italic;"># proche de &quot;private&quot; en Python.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Ce n'est pas sécurisé du tout (on peut le contourner) et cela empêche le</span>
    <span style="color: #808080; font-style: italic;"># monkey patching et autres mesures de contournement en cas de besoin,</span>
    <span style="color: #808080; font-style: italic;"># donc je ne vous recommande pas de le faire.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Mais dans ce cas, ces méthodes sont volontairement définies ainsi pour</span>
    <span style="color: #808080; font-style: italic;"># être invisibles puis un peu plus bas, si win32security ou pwd existent</span>
    <span style="color: #808080; font-style: italic;"># (rappelez-vous, ce sont des dépendances optionnelles), alors elles sont</span>
    <span style="color: #808080; font-style: italic;"># aliasées pour être rendues disponibles.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Il y a 3 implémentations (3 méthodes: une pour windows, une pour unix et</span>
    <span style="color: #808080; font-style: italic;"># une pour le cas où aucun module n'est présent) pour la même</span>
    <span style="color: #808080; font-style: italic;"># fonctionnalité, et l'une des 3 méthodes est utilisée comme</span>
    <span style="color: #808080; font-style: italic;"># implémentation de get_owner().</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># On aurait pu tout mettre dans des if directement, mais ça ferait des</span>
    <span style="color: #808080; font-style: italic;"># gros blocs moins lisibles. Ici il est facile de comprendre le code</span>
    <span style="color: #808080; font-style: italic;"># source.</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> __get_owner_windows<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        r<span style="color: #483d8b;">&quot;&quot;&quot;
        Return the name of the owner of this file or directory. Follow
        symbolic links.
&nbsp;
        Return a name of the form ur'DOMAIN<span style="color: #000099; font-weight: bold;">\U</span>ser Name'; may be a group.
        &quot;&quot;&quot;</span>
        desc <span style="color: #66cc66;">=</span> win32security.<span style="color: black;">GetFileSecurity</span><span style="color: black;">&#40;</span>
            <span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> win32security.<span style="color: black;">OWNER_SECURITY_INFORMATION</span><span style="color: black;">&#41;</span>
        sid <span style="color: #66cc66;">=</span> desc.<span style="color: black;">GetSecurityDescriptorOwner</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        account<span style="color: #66cc66;">,</span> domain<span style="color: #66cc66;">,</span> typecode <span style="color: #66cc66;">=</span> win32security.<span style="color: black;">LookupAccountSid</span><span style="color: black;">&#40;</span><span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> sid<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> domain + u<span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\\</span>'</span> + account
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> __get_owner_unix<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot;
        Return the name of the owner of this file or directory. Follow
        symbolic links.
        &quot;&quot;&quot;</span>
        st <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: #dc143c;">stat</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #dc143c;">pwd</span>.<span style="color: black;">getpwuid</span><span style="color: black;">&#40;</span>st.<span style="color: black;">st_uid</span><span style="color: black;">&#41;</span>.<span style="color: black;">pw_name</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> __get_owner_not_implemented<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">raise</span> <span style="color: #008000;">NotImplementedError</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;Ownership not available on this platform.&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #483d8b;">'win32security'</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">globals</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
        get_owner <span style="color: #66cc66;">=</span> __get_owner_windows
    <span style="color: #ff7700;font-weight:bold;">elif</span> <span style="color: #483d8b;">'pwd'</span> <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">globals</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
        get_owner <span style="color: #66cc66;">=</span> __get_owner_unix
    <span style="color: #ff7700;font-weight:bold;">else</span>:
        get_owner <span style="color: #66cc66;">=</span> __get_owner_not_implemented
&nbsp;
    owner <span style="color: #66cc66;">=</span> <span style="color: #008000;">property</span><span style="color: black;">&#40;</span>
        get_owner<span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span>
        <span style="color: #483d8b;">&quot;&quot;&quot; Name of the owner of this file or directory. &quot;&quot;&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">hasattr</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'statvfs'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #dc143c;">statvfs</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
            <span style="color: #483d8b;">&quot;&quot;&quot; Perform a statvfs() system call on this path. &quot;&quot;&quot;</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #dc143c;">os</span>.<span style="color: #dc143c;">statvfs</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">hasattr</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'pathconf'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">def</span> pathconf<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> name<span style="color: black;">&#41;</span>:
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">pathconf</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> name<span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
    <span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
    <span style="color: #808080; font-style: italic;"># Pas d'autres commentaires après celui-là. jusqu'à la classe de fin.</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Les méthodes suivantes retournent 'self' bien que ce ne soit</span>
    <span style="color: #808080; font-style: italic;"># pas nécessaire.</span>
    <span style="color: #808080; font-style: italic;"># Par exemple path('/tmp/test').chmod(777) va retourner path('/tmp/test')</span>
    <span style="color: #808080; font-style: italic;"># alors que tout ce qu'on lui demande, c'est de changer la permission</span>
    <span style="color: #808080; font-style: italic;"># du dossier. On le fait pour permettre le chaîning, c'est à dire</span>
    <span style="color: #808080; font-style: italic;"># d'autoriser les appels enchainés comme :</span>
    <span style="color: #808080; font-style: italic;"># path('/tmp/test').chmod(777).rename('/tmp/essai').mkdir('ping')</span>
    <span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#</span>
    <span style="color: #808080; font-style: italic;"># --- Modifying operations on files and directories</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> utime<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> times<span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Set the access and modified times of this file. &quot;&quot;&quot;</span>
        <span style="color: #dc143c;">os</span>.<span style="color: black;">utime</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> times<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> chmod<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: black;">&#41;</span>:
        <span style="color: #dc143c;">os</span>.<span style="color: black;">chmod</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">hasattr</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'chown'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">def</span> chown<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> uid<span style="color: #66cc66;">,</span> gid<span style="color: black;">&#41;</span>:
            <span style="color: #dc143c;">os</span>.<span style="color: black;">chown</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> uid<span style="color: #66cc66;">,</span> gid<span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> rename<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">new</span><span style="color: black;">&#41;</span>:
        <span style="color: #dc143c;">os</span>.<span style="color: black;">rename</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">new</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #dc143c;">new</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> renames<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">new</span><span style="color: black;">&#41;</span>:
        <span style="color: #dc143c;">os</span>.<span style="color: black;">renames</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">new</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #dc143c;">new</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#</span>
    <span style="color: #808080; font-style: italic;"># --- Create/delete operations on directories</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> mkdir<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: #66cc66;">=</span><span style="color: #ff4500;">0777</span><span style="color: black;">&#41;</span>:
        <span style="color: #dc143c;">os</span>.<span style="color: black;">mkdir</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> mkdir_p<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: #66cc66;">=</span><span style="color: #ff4500;">0777</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            <span style="color: #008000;">self</span>.<span style="color: black;">mkdir</span><span style="color: black;">&#40;</span>mode<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">OSError</span><span style="color: #66cc66;">,</span> e:
            <span style="color: #ff7700;font-weight:bold;">if</span> e.<span style="color: #dc143c;">errno</span> <span style="color: #66cc66;">!=</span> <span style="color: #dc143c;">errno</span>.<span style="color: black;">EEXIST</span>:
                <span style="color: #ff7700;font-weight:bold;">raise</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> makedirs<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: #66cc66;">=</span><span style="color: #ff4500;">0777</span><span style="color: black;">&#41;</span>:
        <span style="color: #dc143c;">os</span>.<span style="color: black;">makedirs</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> makedirs_p<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> mode<span style="color: #66cc66;">=</span><span style="color: #ff4500;">0777</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            <span style="color: #008000;">self</span>.<span style="color: black;">makedirs</span><span style="color: black;">&#40;</span>mode<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">OSError</span><span style="color: #66cc66;">,</span> e:
            <span style="color: #ff7700;font-weight:bold;">if</span> e.<span style="color: #dc143c;">errno</span> <span style="color: #66cc66;">!=</span> <span style="color: #dc143c;">errno</span>.<span style="color: black;">EEXIST</span>:
                <span style="color: #ff7700;font-weight:bold;">raise</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> rmdir<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #dc143c;">os</span>.<span style="color: black;">rmdir</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> rmdir_p<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            <span style="color: #008000;">self</span>.<span style="color: black;">rmdir</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">OSError</span><span style="color: #66cc66;">,</span> e:
            <span style="color: #ff7700;font-weight:bold;">if</span> e.<span style="color: #dc143c;">errno</span> <span style="color: #66cc66;">!=</span> <span style="color: #dc143c;">errno</span>.<span style="color: black;">ENOTEMPTY</span> <span style="color: #ff7700;font-weight:bold;">and</span> e.<span style="color: #dc143c;">errno</span> <span style="color: #66cc66;">!=</span> <span style="color: #dc143c;">errno</span>.<span style="color: black;">EEXIST</span>:
                <span style="color: #ff7700;font-weight:bold;">raise</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> removedirs<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #dc143c;">os</span>.<span style="color: black;">removedirs</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> removedirs_p<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            <span style="color: #008000;">self</span>.<span style="color: black;">removedirs</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">OSError</span><span style="color: #66cc66;">,</span> e:
            <span style="color: #ff7700;font-weight:bold;">if</span> e.<span style="color: #dc143c;">errno</span> <span style="color: #66cc66;">!=</span> <span style="color: #dc143c;">errno</span>.<span style="color: black;">ENOTEMPTY</span> <span style="color: #ff7700;font-weight:bold;">and</span> e.<span style="color: #dc143c;">errno</span> <span style="color: #66cc66;">!=</span> <span style="color: #dc143c;">errno</span>.<span style="color: black;">EEXIST</span>:
                <span style="color: #ff7700;font-weight:bold;">raise</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># --- Modifying operations on files</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> touch<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #483d8b;">&quot;&quot;&quot; Set the access/modified times of this file to the current time.
        Create the file if it does not exist.
        &quot;&quot;&quot;</span>
        fd <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">os</span>.<span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">O_WRONLY</span> | <span style="color: #dc143c;">os</span>.<span style="color: black;">O_CREAT</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">0666</span><span style="color: black;">&#41;</span>
        <span style="color: #dc143c;">os</span>.<span style="color: black;">close</span><span style="color: black;">&#40;</span>fd<span style="color: black;">&#41;</span>
        <span style="color: #dc143c;">os</span>.<span style="color: black;">utime</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> remove<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #dc143c;">os</span>.<span style="color: black;">remove</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> remove_p<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            <span style="color: #008000;">self</span>.<span style="color: black;">unlink</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">OSError</span><span style="color: #66cc66;">,</span> e:
            <span style="color: #ff7700;font-weight:bold;">if</span> e.<span style="color: #dc143c;">errno</span> <span style="color: #66cc66;">!=</span> <span style="color: #dc143c;">errno</span>.<span style="color: black;">ENOENT</span>:
                <span style="color: #ff7700;font-weight:bold;">raise</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> unlink<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #dc143c;">os</span>.<span style="color: black;">unlink</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> unlink_p<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #008000;">self</span>.<span style="color: black;">remove_p</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># --- Links</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">hasattr</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'link'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">def</span> link<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> newpath<span style="color: black;">&#41;</span>:
            <span style="color: #483d8b;">&quot;&quot;&quot; Create a hard link at 'newpath', pointing to this file. &quot;&quot;&quot;</span>
            <span style="color: #dc143c;">os</span>.<span style="color: black;">link</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> newpath<span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>newpath<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">hasattr</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'symlink'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">def</span> symlink<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> newlink<span style="color: black;">&#41;</span>:
            <span style="color: #483d8b;">&quot;&quot;&quot; Create a symbolic link at 'newlink', pointing here. &quot;&quot;&quot;</span>
            <span style="color: #dc143c;">os</span>.<span style="color: black;">symlink</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> newlink<span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span>newlink<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">hasattr</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'readlink'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">def</span> readlink<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
            <span style="color: #483d8b;">&quot;&quot;&quot; Return the path to which this symbolic link points.
&nbsp;
            The result may be an absolute or a relative path.
            &quot;&quot;&quot;</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._next_class<span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span>.<span style="color: black;">readlink</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">def</span> readlinkabs<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
            <span style="color: #483d8b;">&quot;&quot;&quot; Return the path to which this symbolic link points.
&nbsp;
            The result is always an absolute path.
            &quot;&quot;&quot;</span>
            p <span style="color: #66cc66;">=</span> <span style="color: #008000;">self</span>.<span style="color: black;">readlink</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">if</span> p.<span style="color: black;">isabs</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
                <span style="color: #ff7700;font-weight:bold;">return</span> p
            <span style="color: #ff7700;font-weight:bold;">else</span>:
                <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: black;">&#40;</span><span style="color: #008000;">self</span>.<span style="color: black;">parent</span> / p<span style="color: black;">&#41;</span>.<span style="color: black;">abspath</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#</span>
    <span style="color: #808080; font-style: italic;"># --- High-level functions from shutil</span>
&nbsp;
    copyfile <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">shutil</span>.<span style="color: black;">copyfile</span>
    copymode <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">shutil</span>.<span style="color: black;">copymode</span>
    copystat <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">shutil</span>.<span style="color: black;">copystat</span>
    <span style="color: #dc143c;">copy</span> <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">shutil</span>.<span style="color: #dc143c;">copy</span>
    copy2 <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">shutil</span>.<span style="color: black;">copy2</span>
    copytree <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">shutil</span>.<span style="color: black;">copytree</span>
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">hasattr</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">shutil</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'move'</span><span style="color: black;">&#41;</span>:
        move <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">shutil</span>.<span style="color: black;">move</span>
    rmtree <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">shutil</span>.<span style="color: black;">rmtree</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> rmtree_p<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            <span style="color: #008000;">self</span>.<span style="color: black;">rmtree</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">OSError</span><span style="color: #66cc66;">,</span> e:
            <span style="color: #ff7700;font-weight:bold;">if</span> e.<span style="color: #dc143c;">errno</span> <span style="color: #66cc66;">!=</span> <span style="color: #dc143c;">errno</span>.<span style="color: black;">ENOENT</span>:
                <span style="color: #ff7700;font-weight:bold;">raise</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #808080; font-style: italic;">#</span>
    <span style="color: #808080; font-style: italic;"># --- Special stuff from os</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">hasattr</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'chroot'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">def</span> chroot<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
            <span style="color: #dc143c;">os</span>.<span style="color: black;">chroot</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">hasattr</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">os</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'startfile'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">def</span> startfile<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
            <span style="color: #dc143c;">os</span>.<span style="color: black;">startfile</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
&nbsp;
<span style="color: #808080; font-style: italic;">#&lt;sm&gt;</span>
<span style="color: #808080; font-style: italic;"># La seule spécificité de cette classe est d'overrider la méthode __new__ qui</span>
<span style="color: #808080; font-style: italic;"># est le véritable constructeur en Python (__init__ n'est pas un constructeur)</span>
<span style="color: #808080; font-style: italic;"># L'auteur le fait car tempdir hérite de path qui hérite d'unicode. Or, tous</span>
<span style="color: #808080; font-style: italic;"># les types non-mutables (int, tuple, str, etc, et donc unicode), n'étant pas</span>
<span style="color: #808080; font-style: italic;"># modifiables, ne peuvent être changés dans __init__. Ici __new__ est</span>
<span style="color: #808080; font-style: italic;"># utilisé pour retourner un path tout en créant un dossier temporaire, ce</span>
<span style="color: #808080; font-style: italic;"># qui ne marcherait pas dans __init__. Il est très rare d'avoir besoin de</span>
<span style="color: #808080; font-style: italic;"># s'occuper de __new__.</span>
<span style="color: #808080; font-style: italic;">#&lt;/sm&gt;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">class</span> tempdir<span style="color: black;">&#40;</span>path<span style="color: black;">&#41;</span>:
    <span style="color: #483d8b;">&quot;&quot;&quot;
    A temporary directory via tempfile.mkdtemp, and constructed with the
    same parameters that you can use as a context manager.
&nbsp;
    Example:
&nbsp;
        with tempdir() as d:
            # do stuff with the path object &quot;d&quot;
&nbsp;
        # here the directory is deleted automatically
    &quot;&quot;&quot;</span>
&nbsp;
    <span style="color: #66cc66;">@</span>ClassProperty
    <span style="color: #66cc66;">@</span><span style="color: #008000;">classmethod</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> _next_class<span style="color: black;">&#40;</span>cls<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> path
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__new__</span><span style="color: black;">&#40;</span>cls<span style="color: #66cc66;">,</span> *args<span style="color: #66cc66;">,</span> **kwargs<span style="color: black;">&#41;</span>:
        dirname <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">tempfile</span>.<span style="color: black;">mkdtemp</span><span style="color: black;">&#40;</span>*args<span style="color: #66cc66;">,</span> **kwargs<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">super</span><span style="color: black;">&#40;</span>tempdir<span style="color: #66cc66;">,</span> cls<span style="color: black;">&#41;</span>.<span style="color: #0000cd;">__new__</span><span style="color: black;">&#40;</span>cls<span style="color: #66cc66;">,</span> dirname<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__init__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> *args<span style="color: #66cc66;">,</span> **kwargs<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">pass</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> __enter__<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> __exit__<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: #66cc66;">,</span> exc_type<span style="color: #66cc66;">,</span> exc_value<span style="color: #66cc66;">,</span> <span style="color: #dc143c;">traceback</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #ff7700;font-weight:bold;">not</span> exc_value:
            <span style="color: #008000;">self</span>.<span style="color: black;">rmtree</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>C&#8217;est une bibliothèque très complète et propre, et bien qu&#8217;il y ait quelques astuces ici et là, vous avez pu constater que l&#8217;usage de la POO reste tout à fait accessible : héritage simple, déclaration de méthode, properties, etc. On ne fait pas beaucoup de folies.</p>
<p>Il n&#8217;y a pas besoin de faire les choses compliquées avec la POO, on peut faire des choses tout à fait ordinaires et utiles.</p>
<p>Pour le dernier tuto de la série, on tapera dans la magie noire, à savoir <a href="http://sametmax.com/le-guide-ultime-et-definitif-sur-la-programmation-orientee-objet-en-python-a-lusage-des-debutants-qui-sont-rassures-par-les-textes-detailles-qui-prennent-le-temps-de-tout-expliquer-partie-8/">les métaclasses</a>. Tintintin.</p>
<p>P.S: cet article a été sponsorisé par le plugin Sublime Text <a href="https://github.com/ehuss/Sublime-Wrap-Plus">Wraps Plus</a>. Avec Wraps Plus, plus de caractères en sus !</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/le-guide-ultime-et-definitif-sur-la-programmation-orientee-objet-en-python-a-lusage-des-debutants-qui-sont-rassures-par-les-textes-detailles-qui-prennent-le-temps-de-tout-expliquer-partie-7/feed/</wfw:commentRss>
		<slash:comments>24</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2013/04/PzXJlX6.jpg" length="217148" type="image/jpg" />	</item>
	</channel>
</rss>

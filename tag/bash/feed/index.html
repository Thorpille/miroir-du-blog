<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Sam &#38; Max &#187; bash</title>
	<atom:link href="http://sametmax.com/tag/bash/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Du code, du cul</description>
	<lastBuildDate>Sat, 07 Nov 2015 10:56:13 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=4.1</generator>
	<item>
		<title>Rejouer un session de terminal avec playitagainsam 10</title>
		<link>http://sametmax.com/rejouer-un-session-de-terminal-avec-playitagainsam/</link>
		<comments>http://sametmax.com/rejouer-un-session-de-terminal-avec-playitagainsam/#comments</comments>
		<pubDate>Thu, 22 May 2014 08:29:36 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[bash]]></category>
		<category><![CDATA[ipython]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[shell]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=10298</guid>
		<description><![CDATA[<a href="https://github.com/rfk/playitagainsam">playitagainsam</a>, ou PIAS  a pour but de rejouer des sessions shell: il lance un shell, enregistre ce qu'on y a tapé, et quand on quitte le shell, sauvegarde le tout dans un fichier. Ensuite, on peut lire le contenu du fichier et revoir la session shell telle qu'elle a été tapée.]]></description>
				<content:encoded><![CDATA[<p>Combien de fois, durant une formation, on m&#8217;a demandé si je pouvais donner un dump de la session shell.</p>
<p><a href="https://github.com/rfk/playitagainsam">playitagainsam</a>, ou PIAS, a exactement pour but de faire cela: il lance un shell, enregistre ce qu&#8217;on y a tapé, et quand on quitte le shell, sauvegarde le tout dans un fichier. Ensuite, on peut lire le contenu du fichier et revoir la session shell telle qu&#8217;elle a été tapée.</p>
<p>C&#8217;est un programme Python, on peut donc le <a href="http://sametmax.com/votre-python-aime-les-pip/">pip</a> installer :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">pip <span style="color: #c20cb9; font-weight: bold;">install</span> playitagainsam <span style="color: #660033;">--user</span></pre></td></tr></table></div>

<p>Ensuite, on lance une session à enregistrer avec la sous commande record :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">pias record nom_du_fichier_ou_sauver_l_enregistrement</pre></td></tr></table></div>

<p>PIAS va lancer un nouveau shell, par défaut le même que votre shell actuel (souvent bash, pour moi fish), mais vous pouvez préciser un type de shell spécial avec <code>--shell</code>. Ex :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">pias record ex1 <span style="color: #660033;">--shell</span> ipython</pre></td></tr></table></div>

<p>A partir de là il n&#8217;y a rien à faire. On peut travailler normalement et oublier qu&#8217;on a utilisé PIAS. Une fois qu&#8217;on a terminé sa petite affaire, il suffit de sortir du shell (CTRL + D, exit, etc), et la session va être sauvegardée dans un format JSON facile à corriger à la main si vous souhaitez la rendre plus agréable :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #7a0874; font-weight: bold;">&#123;</span>
  <span style="color: #ff0000;">&quot;events&quot;</span>: <span style="color: #7a0874; font-weight: bold;">&#91;</span>
    <span style="color: #7a0874; font-weight: bold;">&#123;</span>
      <span style="color: #ff0000;">&quot;act&quot;</span>: <span style="color: #ff0000;">&quot;OPEN&quot;</span>,
      <span style="color: #ff0000;">&quot;size&quot;</span>: <span style="color: #7a0874; font-weight: bold;">&#91;</span>
        <span style="color: #000000;">162</span>,
        <span style="color: #000000;">33</span>
      <span style="color: #7a0874; font-weight: bold;">&#93;</span>,
      <span style="color: #ff0000;">&quot;term&quot;</span>: <span style="color: #ff0000;">&quot;1c53f048e3a74984b2a93af175e24e87&quot;</span>
    <span style="color: #7a0874; font-weight: bold;">&#125;</span>,
    <span style="color: #7a0874; font-weight: bold;">&#123;</span>
      <span style="color: #ff0000;">&quot;act&quot;</span>: <span style="color: #ff0000;">&quot;PAUSE&quot;</span>,
      <span style="color: #ff0000;">&quot;duration&quot;</span>: <span style="color: #000000;">0.10042214393615723</span>
    <span style="color: #7a0874; font-weight: bold;">&#125;</span>,
    <span style="color: #7a0874; font-weight: bold;">&#123;</span>
      <span style="color: #ff0000;">&quot;act&quot;</span>: <span style="color: #ff0000;">&quot;WRITE&quot;</span>,
      <span style="color: #ff0000;">&quot;data&quot;</span>: <span style="color: #ff0000;">&quot;\u001b]0;sam@sametmax.com: /tmp\u0007sam@sametmax.com:/tmp$ &quot;</span>,
      <span style="color: #ff0000;">&quot;term&quot;</span>: <span style="color: #ff0000;">&quot;1c53f048e3a74984b2a93af175e24e87&quot;</span>
    <span style="color: #7a0874; font-weight: bold;">&#125;</span>,
    <span style="color: #7a0874; font-weight: bold;">&#123;</span>
      <span style="color: #ff0000;">&quot;act&quot;</span>: <span style="color: #ff0000;">&quot;ECHO&quot;</span>,
      <span style="color: #ff0000;">&quot;data&quot;</span>: <span style="color: #ff0000;">&quot;touch essai&quot;</span>,
      <span style="color: #ff0000;">&quot;term&quot;</span>: <span style="color: #ff0000;">&quot;1c53f048e3a74984b2a93af175e24e87&quot;</span>
...
<span style="color: #7a0874; font-weight: bold;">&#125;</span></pre></td></tr></table></div>

<p>Quand vous voulez rejouer la session :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">pias play fichier_d_enregistrement</pre></td></tr></table></div>

<p>Par défaut il faut appuyer sur une touche quelconque du clavier pour voir apparaitre chaque caractère, donnant l&#8217;impression que vous êtes un hacker de Hollywood. C&#8217;est rigolo, mais parfaitement chiant à la longue. On peut faire jouer la session automatiquement avec l&#8217;option <code>--auto-type</code> qui va taper chaque ligne automatiquement. Il suffira alors d&#8217;appuyer sur entrée à chaque ligne pour avoir le résultat suivant. C&#8217;est mon mode préféré. </p>
<p>Si vous êtes un gros feignant, vous pouvez tout jouer en automatique en rajoutant l&#8217;option <code>--auto-waypoint</code> qui va vous dispenser de taper entrée à chaque fin de ligne. Ex :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">pias play ex1 <span style="color: #660033;">--auto-type</span> <span style="color: #660033;">--auto-waypoint</span></pre></td></tr></table></div>

<p><strong>La session jouée est simulée.</strong> Elle n&#8217;a aucun impacte sur le système. Si vous faites un <code>mkdir</code> dans bash ou un <code>shutil.rmtree</code> dans python, ça ne fera rien.</p>
<p>Néanmoins, parfois il est utile d&#8217;avoir le effets réels des commandes. Dans ce cas on peut utiliser <code>--live-replay</code>. Attention, faites bien gaffe à ce que vous allez jouer&#8230;</p>
<p>playitagainsam est intéressant pour tout ce qui est formation et tutorial, d&#8217;autant plus qu&#8217;il existe un <a href="https://github.com/rfk/playitagainsam-js/">player javascript</a> pour faire la démonstration de vos sessions shell sur un blog ou un slideshow.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/rejouer-un-session-de-terminal-avec-playitagainsam/feed/</wfw:commentRss>
		<slash:comments>10</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2014/05/G67guCh.jpg" length="36803" type="image/jpg" />	</item>
		<item>
		<title>Remplacer sed, awk, cut et Perl par Python (= orgasme pour sysadmin) 26</title>
		<link>http://sametmax.com/remplacer-sed-awk-cut-et-perl-par-python-orgasme-pour-sysadmin/</link>
		<comments>http://sametmax.com/remplacer-sed-awk-cut-et-perl-par-python-orgasme-pour-sysadmin/#comments</comments>
		<pubDate>Sat, 14 Dec 2013 08:28:41 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Administration System]]></category>
		<category><![CDATA[awk]]></category>
		<category><![CDATA[bash]]></category>
		<category><![CDATA[perl]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[sed]]></category>
		<category><![CDATA[sysadmin]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=8261</guid>
		<description><![CDATA[La force de perl c'est qu'il permettait de piper des données directement via la ligne de commande pour faire des manipulations rapides.

C'est pour cela que c'était devenu les choix des sysadmins. Parce que jusqu'ici, le choix c'était soit de faire un truc simple en connaissant par coeur la tool box GNU, soit ouvrir un fichier et faire un script.

Python ne permet pas de piper des données directement dans la commande, mais des projets ont vu le jour pour le faire.]]></description>
				<content:encoded><![CDATA[<p>La force de Perl c&#8217;est qu&#8217;il permettait de piper des données directement via la ligne de commande pour faire des manipulations rapides.</p>
<p>C&#8217;est pour cela que c&#8217;était devenu les choix des sysadmins. Parce que jusqu&#8217;ici, le choix c&#8217;était soit de faire un truc simple en connaissant par coeur la tool box GNU, soit ouvrir un fichier et faire un script.</p>
<p>Python ne permet pas de piper des données directement dans la commande, mais des projets ont vu le jour pour le faire.</p>
<p>Il y a le projet <a href="http://code.google.com/p/pyp/">pyp</a>, que l&#8217;on doit à Sony Pictures Imageworks qui avait besoin de se simplifier l&#8217;automatisation des tâches de build pour ses films.</p>
<p>Et il y a <a href="https://pypi.python.org/pypi/Pyped/1.0">pyped</a>, dont j&#8217;avais brièvement parlé <a href="http://sametmax.com/sept-petites-libs-qui-changent-la-vie-dun-dev-python/">ici</a> (article qui mérite d&#8217;être mis à jour vu que j&#8217;ai remplace dateutils par <a href="http://sametmax.com/les-time-zones-en-python/">arrow</a>).</p>
<p>Les deux étaient sympas, mais avait des syntaxes alambiquées, n&#8217;étaient pas compatibles python 3 et manquaient d&#8217;imports auto. Cependant, pyped est récemment passé en v1.0, donc stable, et a une toute nouvelle approche de syntaxe qui rend la bestiole super agréable à utiliser.</p>
<p>Présentation.</p>
<h2>Stdin, ligne à ligne</h2>
<p>L&#8217;installation est bateau, c&#8217;est du <a href="http://sametmax.com/votre-python-aime-les-pip/">pip</a> :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">pip <span style="color: #c20cb9; font-weight: bold;">install</span> <span style="color: #660033;">--user</span> pyped</pre></td></tr></table></div>

<p>Et derrière, on obtient la commande <code>pyp</code>. Elle s&#8217;utilise essentiellement à la suite d&#8217;une autre commande. Typiquement :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">cat</span> <span style="color: #000000; font-weight: bold;">/</span>etc<span style="color: #000000; font-weight: bold;">/</span>fsta <span style="color: #000000; font-weight: bold;">|</span> pyp <span style="color: #ff0000;">&quot;un truc&quot;</span></pre></td></tr></table></div>

<p>L&#8217;astuce, c&#8217;est que &#8220;un truc&#8221; peut être n&#8217;importe quelle expression Python. Généralement une expression qui <code>print()</code> quelque chose.</p>
<p>Or, Pyped met automatiquement à disposition de cette expression deux variables :</p>
<ul>
<li>La ligne en cours, dans la variable <code>x</code>.</li>
<li>Le numéro de la ligne en cours, dans la variable <code>i</code>.</li>
</ul>
<p>L&#8217;expression Python est appelée une fois pour chaque ligne.</p>
<p>Par exemple, supposons que j&#8217;ai un fichier &#8220;fortune.txt&#8221; contenant :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">bitcoin <span style="color: #7a0874; font-weight: bold;">&#40;</span>btc<span style="color: #7a0874; font-weight: bold;">&#41;</span> : <span style="color: #000000;">5</span>
euros <span style="color: #7a0874; font-weight: bold;">&#40;</span>€<span style="color: #7a0874; font-weight: bold;">&#41;</span> : <span style="color: #000000;">100</span>
dollars <span style="color: #7a0874; font-weight: bold;">&#40;</span>$<span style="color: #7a0874; font-weight: bold;">&#41;</span> : <span style="color: #000000;">80</span></pre></td></tr></table></div>

<p>Si je veut tout mettre en majuscule, je fais :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">$ <span style="color: #c20cb9; font-weight: bold;">cat</span> fortune.txt <span style="color: #000000; font-weight: bold;">|</span> pyp <span style="color: #ff0000;">&quot;print(x.upper())&quot;</span>
BITCOIN <span style="color: #7a0874; font-weight: bold;">&#40;</span>BTC<span style="color: #7a0874; font-weight: bold;">&#41;</span> : <span style="color: #000000;">5</span>
EUROS <span style="color: #7a0874; font-weight: bold;">&#40;</span>€<span style="color: #7a0874; font-weight: bold;">&#41;</span> : <span style="color: #000000;">100</span>
DOLLARS <span style="color: #7a0874; font-weight: bold;">&#40;</span>$<span style="color: #7a0874; font-weight: bold;">&#41;</span> : <span style="color: #000000;">80</span></pre></td></tr></table></div>

<p>On peut mettre plusieurs expressions d&#8217;affilé. Ainsi, si je veux récupérer la somme et le symbole uniquement :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">$ <span style="color: #c20cb9; font-weight: bold;">cat</span> fortune.txt <span style="color: #000000; font-weight: bold;">|</span> pyp <span style="color: #ff0000;">&quot;devise, sign, _, value = x.split()&quot;</span> <span style="color: #ff0000;">&quot;sign = sign.strip('()')&quot;</span> <span style="color: #ff0000;">&quot;print('%s%s' % (value, sign))&quot;</span>
5btc
<span style="color: #000000;">100</span>€
<span style="color: #666666;">80$</span></pre></td></tr></table></div>

<p>Ok, c&#8217;est plus long que perl, mais vachement plus facile à écrire et à relire. Et j&#8217;utilise un langage que je connais déjà. Et pas besoin de faire un mix incompréhensible de sed, awk et autre cut.</p>
<p>Si j&#8217;ai vraiment besoin de lisibilité, je peux même le mettre sur plusieurs lignes :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">$ <span style="color: #c20cb9; font-weight: bold;">cat</span> fortune.txt <span style="color: #000000; font-weight: bold;">|</span> pyp <span style="color: #ff0000;">&quot;                                                                                                 
devise, sign, _, value = x.split() 
sign = sign.strip('()') 
print('%s%s' % (value, sign))  
&quot;</span>
5btc
<span style="color: #000000;">100</span>€
<span style="color: #666666;">80$</span></pre></td></tr></table></div>

<p>Vous aurez noté que j&#8217;utilise <code>print()</code> et que je semble ne pas me soucier de l&#8217;unicode. C&#8217;est parceque pyped fait ça au début du script :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">__future__</span> <span style="color: #ff7700;font-weight:bold;">import</span> print_function<span style="color: #66cc66;">,</span> unicode_literals<span style="color: #66cc66;">,</span> division<span style="color: #66cc66;">,</span> absolute_imports</pre></td></tr></table></div>

<p>Du coup, on est bien en Python 2.7, mais on bénéficie de la division améliorée, de la fonction pour printer, des imports absolus et surtout, de l&#8217;unicode partout. D&#8217;ailleurs pyped vous transforme <code>x</code> pour que ce soit un objet unicode. </p>
<p>Dans tous les cas, pyped est compatible Python 3.</p>
<h2>Tout traiter d&#8217;un coup</h2>
<p>Parfois, on a besoin d&#8217;avoir accès à toutes les lignes, pas juste les lignes une à une. pyped permet cela avec l&#8217;option <code>-i</code>. Les variables <code>x</code> et <code>i</code> disparaissent au profit de la variable <code>l</code>, qui contient un itérable sur toutes les lignes.</p>
<p>Par exemple, envie de trier tout ça ?</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;">cat fortune.<span style="color: black;">txt</span> | pyp -i <span style="color: #483d8b;">&quot;
lignes = (x.split() for x in l)
lignes = sorted((v, s.strip('()')) for d, s, _, v in lignes)
for ligne in lignes: print('%s%s' % ligne)
&quot;</span>
<span style="color: #ff4500;">100</span>€
5btc
<span style="color: #ff4500;">80</span>$</pre></td></tr></table></div>

<h2>Moar options</h2>
<p>Lisez la doc, car il y a d&#8217;autres options du genre éviter que pyped vous strip automatiquement le ligne break, forcer l&#8217;encoding, etc.</p>
<p>Parmi les trucs les plus utiles, il y a l&#8217;option <code>-b</code> qui permet de lancer un code avant la boucle. Pratique pour importer des trucs genre le module <code>tarfile</code> pour extraire une archive avant d&#8217;utiliser son contenu.</p>
<p>Néanmoins la plupart du temps on a rien besoin d&#8217;importer car pyped importe déjà automatiquement les modules les plus utiles : maths, datetime, re, json, hashlib, uuid, etc. </p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/remplacer-sed-awk-cut-et-perl-par-python-orgasme-pour-sysadmin/feed/</wfw:commentRss>
		<slash:comments>26</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2013/12/hsmFx9T.jpg" length="182812" type="image/jpg" />	</item>
		<item>
		<title>Variables d&#8217;environnement utilisées par Python 9</title>
		<link>http://sametmax.com/variables-denvironnement-utilisees-par-python/</link>
		<comments>http://sametmax.com/variables-denvironnement-utilisees-par-python/#comments</comments>
		<pubDate>Wed, 31 Jul 2013 15:07:36 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[bash]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=6987</guid>
		<description><![CDATA[Si vous settez la variable avec le bon nom dans votre shell et que vous lancez l'interpréteur Python, vous pouvez démarrer ce dernier avec un comportement différent, comme le ferait une option ou un fichier de config.]]></description>
				<content:encoded><![CDATA[<p>Avant même l&#8217;utilisation d&#8217;options, de fichiers de conf, et outils installés, les variables d&#8217;environnement sont un moyen pratique de configurer un programme. Il s&#8217;agit simplement d&#8217;une variable globale accessible dans le shell courant.</p>
<p>Par exemple, sous bash, pour créer une variable, il suffit de faire :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">$ <span style="color: #007800;">NOMDEVARIABLE</span>=<span style="color: #ff0000;">'valeur'</span> <span style="color: #666666; font-style: italic;"># mettre la variable à la bonne valeur</span>
$ <span style="color: #7a0874; font-weight: bold;">export</span> NOMDEVARIABLE <span style="color: #666666; font-style: italic;"># rendre la variable globale</span></pre></td></tr></table></div>

<p>La convention est de mettre leur nom en majuscule.</p>
<p>Et pour afficher la variable, il suffit de faire :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">$ <span style="color: #7a0874; font-weight: bold;">echo</span> <span style="color: #007800;">$NOMDEVARIABLE</span>
valeur</pre></td></tr></table></div>

<p>Pourquoi c&#8217;est pratique ? Et bien parce qu&#8217;un programme comme Python va aussi aller regarder dans ces variables d&#8217;environnement pour se configurer. Donc, si vous settez la variable avec le bon nom dans votre shell et que vous lancez l&#8217;interpréteur Python, vous pouvez démarrer ce dernier avec un comportement différent, comme le ferait une option ou un fichier de config. La différence ? La variable est valable pour toute la session de shell, donc même si vous ressortez de l&#8217;interpréteur Python, et que vous le relancez, tant que vous êtes dans la même session de shell, la configuration reste la même.</p>
<h2>Variables attendues</h2>
<p><code>PYTHONSTARTUP</code>: un module à exécuter au démarrage de Python.</p>
<p>Pratique si vous savez que vous allez utiliser souvent le même code dans votre prochaine session de travail avec le shell. Par exemple, je crée un module <em>/tmp/imports.py</em> et je met dedans :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> json
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">pickle</span>
<span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">datetime</span> <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">datetime</span></pre></td></tr></table></div>

<p>Ensuite, je set ma variable :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">$ <span style="color: #007800;">PYTHONSTARTUP</span>=<span style="color: #ff0000;">'/tmp/imports.py'</span> 
$ <span style="color: #7a0874; font-weight: bold;">export</span> PYTHONSTARTUP</pre></td></tr></table></div>

<p>Et en lançant l&#8217;interpréteur, même en sortant et en le relançant 50 fois de suite, je n&#8217;ai pas à importer ces modules.</p>
<p><code>PYTHONPATH</code> : une liste de dossiers séparés par &#8216;:&#8217; qui va être ajouté à sys.path</p>
<p>Vous savez qu&#8217;il y a des packages qui ne sont pas dans le PYTHON PATH, donc non importables. Mais pour le moment, vous voulez les utiliser quand même pour faire des tests vite fait (vous corrigerez le problème plus tard ^^).</p>
<p>Facile:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #007800;">PYTHONPATH</span>=<span style="color: #ff0000;">'/home/sam/un_dossier_qui_contient_mes_libs:/home/sam/projects/autre_projet'</span>
<span style="color: #7a0874; font-weight: bold;">export</span> <span style="color: #007800;">$PYTHONPATH</span></pre></td></tr></table></div>

<p>Et voilà, tout ce qui est dans ces deux dossiers est importable.</p>
<p>Il y a encore :</p>
<p><code>PYTHONHOME</code> : choisir un autre dossier dans lequel chercher l&#8217;interpréteur Python.<br />
<code>PYTHONCASEOK</code> : ingorer la casse dans le nom des modules sous Windows<br />
<code>PYTHONIOENCODING</code> : forcer un encoding par défaut pour stdin/stdout/stderr<br />
<code>PYTHONHASHSEED</code> : changer la seed hash() (renforce la sécurité de la VM)</p>
<h2>Variables d&#8217;environnement permanentes</h2>
<p>Les programmes Python utilisent beaucoup les variables d&#8217;environnement : Django, Celery, nose, virtualenv, pip&#8230; Tous peuvent être <strong>aussi</strong> configurés avec ces variables.</p>
<p>Parfois, on voudra que cette variable soit accessible depuis tous les shells, et même après le reboot. Bref, rendre la configuration permanente.</p>
<p>Il y a plusieurs solutions. L&#8217;une est de mettre la déclaration de la variable dans le script de démarrage de votre shell, par exemple sous bash, de mettre la variable dans <em>.bashrc</em>.</p>
<p>Ainsi, j&#8217;ai des entrées comme celle-ci dans <a href="sametmax.com/a-linterieur-de-mon-bashrc/">mon .bashrc</a> :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># évite à pip de télécharger plusieurs fois la même lib à la réinstallation</span>
<span style="color: #007800;">PIP_DOWNLOAD_CACHE</span>=<span style="color: #ff0000;">'/opt/pip-cache'</span>;
<span style="color: #7a0874; font-weight: bold;">export</span> PIP_DOWNLOAD_CACHE;</pre></td></tr></table></div>

<p>Une autre est de la mettre dans un hook, c&#8217;est à dire un script exécuté à un moment donné par un programme. De nombreux programmes ont des hooks, et il y a des exemples sur le blog pour <a href="http://sametmax.com/les-hooks-de-virtualenv-exemple-postactivate-pour-les-settings-de-django/">virtualenv</a> et <a href="http://sametmax.com/purger-les-fichiers-pyc-et-un-hook-git-en-bonus/">git</a>.</p>
<h2>Variables d&#8217;environnement personnalisées</h2>
<p>Vos propres programmes peuvent lire (pour se configurer) et écrire (pour configurer d&#8217;autres programme ou forcer leur propre configuration en cas de multiprocessing) des variables d&#8217;environnement. Il suffit de faire :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">os</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">environ</span>
<span style="color: black;">&#123;</span><span style="color: #483d8b;">'LC_NUMERIC'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'gs_max_changes'</span>: <span style="color: #483d8b;">'99'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'scmbDir'</span>: <span style="color: #483d8b;">'/home/sam/.scm_breeze'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'GNOME_DESKTOP_SESSION_ID'</span>: <span style="color: #483d8b;">'this-is-deprecated'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'AUTOJUMP_DATA_DIR'</span>: <span style="color: #483d8b;">'/home/sam/.local/share/autojump'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LC_IDENTIFICATION'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'XDG_CURRENT_DESKTOP'</span>: <span style="color: #483d8b;">'Unity'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'GNOME_KEYRING_PID'</span>: <span style="color: #483d8b;">'2787'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LOGNAME'</span>: <span style="color: #483d8b;">'sam'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'USER'</span>: <span style="color: #483d8b;">'sam'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'PROMPT_COMMAND'</span>: <span style="color: #483d8b;">'set_bash_prompt;preexec_invoke_cmd'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'PATH'</span>: <span style="color: #483d8b;">'/usr/lib/lightdm/lightdm:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LC_PAPER'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'GNOME_KEYRING_CONTROL'</span>: <span style="color: #483d8b;">'/home/sam/.cache/keyring-1rkOf1'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'design_av_dirs'</span>: <span style="color: #483d8b;">'Animations Videos Flash Music Samples'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'DISPLAY'</span>: <span style="color: #483d8b;">':0'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'SSH_AGENT_PID'</span>: <span style="color: #483d8b;">'2849'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LANG'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'TERM'</span>: <span style="color: #483d8b;">'xterm'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'SHELL'</span>: <span style="color: #483d8b;">'/bin/bash'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'XDG_SESSION_PATH'</span>: <span style="color: #483d8b;">'/org/freedesktop/DisplayManager/Session0'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'XDG_SESSION_COOKIE'</span>: <span style="color: #483d8b;">'ccef8e8a757563a3c14c304f00000003-1375177738.724796-1812587231'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LANGUAGE'</span>: <span style="color: #483d8b;">'fr_FR:fr_CA:en'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'SESSION_MANAGER'</span>: <span style="color: #483d8b;">'local/sam:@/tmp/.ICE-unix/2798,unix/sam:/tmp/.ICE-unix/2798'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LC_MONETARY'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LESSCLOSE'</span>: <span style="color: #483d8b;">'/usr/bin/lesspipe %s %s'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'MANDATORY_PATH'</span>: <span style="color: #483d8b;">'/usr/share/gconf/ubuntu.mandatory.path'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'DBUS_SESSION_BUS_ADDRESS'</span>: <span style="color: #483d8b;">'unix:abstract=/tmp/dbus-4sjzHNl8JS,guid=6ea6a72c49faf1630800018'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'VIRTUALENVWRAPPER_LOG_DIR'</span>: <span style="color: #483d8b;">'/home/sam/.virtualenvs'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'COMPIZ_CONFIG_PROFILE'</span>: <span style="color: #483d8b;">'ubuntu'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'EDITOR'</span>: <span style="color: #483d8b;">'/usr/bin/textadept'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'DESKTOP_AUTOSTART_ID'</span>: <span style="color: #483d8b;">'10b40d4ebf3d1cf3fd700000027980010'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'GPG_AGENT_INFO'</span>: <span style="color: #483d8b;">'/home/sam/.cache/keyring-1rkOf1/gpg:0:1'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'HOME'</span>: <span style="color: #483d8b;">'/home/sam'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'WORKON_HOME'</span>: <span style="color: #483d8b;">'/home/sam/.virtualenvs'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'SHLVL'</span>: <span style="color: #483d8b;">'1'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'SSH_AUTH_SOCK'</span>: <span style="color: #483d8b;">'/home/sam/.cache/keyring-1rkOf1/ssh'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'VIRTUALENVWRAPPER_HOOK_DIR'</span>: <span style="color: #483d8b;">'/home/sam/.virtualenvs'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LC_ADDRESS'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'COMP_WORDBREAKS'</span>: <span style="color: #483d8b;">' <span style="color: #000099; font-weight: bold;">\t</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;<span style="color: #000099; font-weight: bold;">\'</span>&gt;&lt;;|&amp;(:'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'root_design_dir'</span>: <span style="color: #483d8b;">'/home/sam/Dropbox/Design'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'GDMSESSION'</span>: <span style="color: #483d8b;">'ubuntu'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'project_design_dir'</span>: <span style="color: #483d8b;">'design_assets'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'git_status_command'</span>: <span style="color: #483d8b;">'git_status_shortcuts'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'XDG_SEAT_PATH'</span>: <span style="color: #483d8b;">'/org/freedesktop/DisplayManager/Seat0'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LC_ALL'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LESSOPEN'</span>: <span style="color: #483d8b;">'| /usr/bin/lesspipe %s'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'git_env_char'</span>: <span style="color: #483d8b;">'e'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'_'</span>: <span style="color: #483d8b;">'/usr/bin/python'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'DEFAULTS_PATH'</span>: <span style="color: #483d8b;">'/usr/share/gconf/ubuntu.default.path'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'VIRTUALENVWRAPPER_PROJECT_FILENAME'</span>: <span style="color: #483d8b;">'.project'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'DESKTOP_SESSION'</span>: <span style="color: #483d8b;">'ubuntu'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'GIT_REPO_DIR'</span>: <span style="color: #483d8b;">'/home/sam/Work'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'XDG_CONFIG_DIRS'</span>: <span style="color: #483d8b;">'/etc/xdg/xdg-ubuntu:/etc/xdg'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'GTK_MODULES'</span>: <span style="color: #483d8b;">'canberra-gtk-module:canberra-gtk-module'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'UBUNTU_MENUPROXY'</span>: <span style="color: #483d8b;">'libappmenu.so'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'AUTOJUMP_HOME'</span>: <span style="color: #483d8b;">'/home/sam'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LC_TELEPHONE'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'XAUTHORITY'</span>: <span style="color: #483d8b;">'/home/sam/.Xauthority'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LC_MEASUREMENT'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'PWD'</span>: <span style="color: #483d8b;">'/home/sam'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'PIP_DOWNLOAD_CACHE'</span>: <span style="color: #483d8b;">'/opt/pip-cache'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'design_ext_dirs'</span>: <span style="color: #483d8b;">'Fonts IconSets'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'ga_auto_remove'</span>: <span style="color: #483d8b;">'yes'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LC_NAME'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'design_base_dirs'</span>: <span style="color: #483d8b;">'Images Backgrounds Logos Icons Mockups Screenshots'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LC_TIME'</span>: <span style="color: #483d8b;">'fr_FR.UTF-8'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'LS_COLORS'</span>: <span style="color: #483d8b;">'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lz=01;31:*.xz=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.axv=01;35:*.anx=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.axa=00;36:*.oga=00;36:*.spx=00;36:*.xspf=00;36:'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'XDG_DATA_DIRS'</span>: <span style="color: #483d8b;">'/usr/share/ubuntu:/usr/share/gnome:/usr/local/share/:/usr/share/'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'GIT_REPOS'</span>: <span style="color: #483d8b;">''</span><span style="color: black;">&#125;</span></pre></td></tr></table></div>

<p>C&#8217;est un simple dico dans lequel vous pouvez lire et écrire. Comme vous pouvez le voir, il ne s&#8217;agit pas juste des variables qui concernent Python mais de toutes celle de la session, donc attention, de grands pouvoirs impliquent de grandes possibilités de merder.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/variables-denvironnement-utilisees-par-python/feed/</wfw:commentRss>
		<slash:comments>9</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2013/07/unziDZk.jpg" length="36550" type="image/jpg" />	</item>
		<item>
		<title>Historique bash récent 8</title>
		<link>http://sametmax.com/historique-bash-recent/</link>
		<comments>http://sametmax.com/historique-bash-recent/#comments</comments>
		<pubDate>Thu, 11 Apr 2013 12:23:52 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Philo et culture]]></category>
		<category><![CDATA[bash]]></category>
		<category><![CDATA[meta]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=5683</guid>
		<description><![CDATA[Je plagie <a href="http://pydanny.com/20130410-history-of-my-most-used-shell-commands.html">PyDanny</a> en affichant ici mon historique des commandes les plus utilisées.]]></description>
				<content:encoded><![CDATA[<p>Je plagie <a href="http://pydanny.com/20130410-history-of-my-most-used-shell-commands.html">PyDanny</a> en affichant ici mon historique des commandes les plus utilisées récupéré grâce à :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666;">$ </span><span style="color: #7a0874; font-weight: bold;">history</span> <span style="color: #000000; font-weight: bold;">|</span> <span style="color: #c20cb9; font-weight: bold;">awk</span> <span style="color: #ff0000;">'{a[$2]++ } END{for(i in a){print a[i] &quot; &quot; i}}'</span><span style="color: #000000; font-weight: bold;">|</span><span style="color: #c20cb9; font-weight: bold;">sort</span> <span style="color: #660033;">-rn</span> <span style="color: #000000; font-weight: bold;">|</span><span style="color: #c20cb9; font-weight: bold;">head</span> <span style="color: #660033;">-n</span> <span style="color: #000000;">20</span></pre></td></tr></table></div>

<p>L&#8217;exercice consiste à commenter chaque entrée, donc acte :</p>
<pre>100 ./manage.py # Jamie Foxx
71 sudo         # Make me a sandwich (then apt-get upgrade)
56 cd           # j'ai beaucoup de projets différents
41 ipython      # Voilà ce que c'est d'être dev Python...
40 ssh          # ... sur des projets Web
37 py.test      # Ben oui, je fais des tests !
37 ls           # Comment ça IOError ?
34 gs           # Alias de Git status :-)
26 ga           # Merveilleux SCMBreeze, installez le
24 pip          # requests, ipdb, path.py, peewee...
24 co           # git commit -m "`echo "$*" | sed -e 's/^./\U&#038;\E/g'`"
22 vi           # Presque que pour les config d'nginx
21 python       # Quand je fais des tests pour le blog
17 [censored]   # Le nom d'un projet de site de Cul
15 workon       # Ca devrait être + élévé, mais j'ai ajouté l'autovirtualenv 
15 grin         # J'aime pas "rechercher dans tous les fichiers" sur ST2
11 tail         # Une longue session de debuggage via log d'erreurs
10 ipython3     # Migration vers Python 3 en cours
9 wget          # Pas envie de toucher ma souris</pre>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/historique-bash-recent/feed/</wfw:commentRss>
		<slash:comments>8</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2013/04/W7Wf4mr.jpg" length="131363" type="image/jpg" />	</item>
		<item>
		<title>Invalid cross-device link 3</title>
		<link>http://sametmax.com/invalid-cross-device-link/</link>
		<comments>http://sametmax.com/invalid-cross-device-link/#comments</comments>
		<pubDate>Tue, 09 Apr 2013 10:19:57 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[bash]]></category>
		<category><![CDATA[file]]></category>
		<category><![CDATA[os]]></category>
		<category><![CDATA[oserror]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[rename]]></category>
		<category><![CDATA[shutil]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=5652</guid>
		<description><![CDATA[Les erreurs d'upload de fichier, c'est 99% de problèmes de droit d'accès et d'espace disque. Mais de temps à autres, on tombe sur des petites saloperies bien vicelardes...]]></description>
				<content:encoded><![CDATA[<p>Les erreurs d&#8217;upload de fichier, c&#8217;est 99% de problèmes de droit d&#8217;accès et d&#8217;espace disque. Mais de temps à autres, on tombe sur des petites saloperies bien vicelardes comme ce code anodin :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #dc143c;">os</span>.<span style="color: black;">rename</span><span style="color: black;">&#40;</span>uploaded_tmp_file<span style="color: #66cc66;">,</span> destination<span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Ce snippet, comme vous l&#8217;aurez compris, prend simplement un fichier qui vient d&#8217;être uploadé et le déplace vers un autre dossier où il sera traité, chouchouté, encodé, et mis en ligne.</p>
<p>Sauf que la ligne en question nous a valu un cryptique :</p>
<p><code>IOError: Invalid cross-device link</code></p>
<p><a href="http://sametmax.com/debugger-en-python-les-bases-de-pdb/">PDB</a> nous confirme le merdier, même en le faisant à la main. Pourtant la commande bash <code>MV</code> fait le déplacement du fichier sans problème.</p>
<p>User / group ? Checked.</p>
<p>Permission en lecture écriture ? Checked.</p>
<p>SEL linux ? Désactivé depuis longtemps.</p>
<p>Quid alors ?</p>
<p><a href="http://mail.python.org/pipermail/python-list/2005-February/323335.html">Les archives de la mailling list</a> de Python nous offre une réponse à la question, que je vous traduis :</p>
<blockquote><p>mv est un programme étonnamment complexe, tandis que os.rename est un wrapper autour de rename(2) qui est probablement documenté sur ton système comme retournant EXDEV dans ces circonstances.</p>
<p>os.xxx est généralement une surcouche assez fine autour de ce que ton OS fournit, et en hérite toutes les limites. Pour certains actions, os.shutil fournit quelque chose qui se situe entre os.xxx et os.system(&#8220;xxx&#8221;) en terme de complexité et de capacité.</p></blockquote>
<p>Je l&#8217;ai traduis en français, maintenant je vous la refais en langage humain : <code>os.rename</code> ne fait vaguement qu&#8217;appeler la commande <code>rename</code>, qui n&#8217;est pas très puissante, et notamment qui est incapable de gérer un déplacement de fichier d&#8217;une partition à une autre. Or dans notre cas, notre dossier temporaire était sur une partition séparée pour des raisons de perfs.</p>
<p>La solution est d&#8217;utiliser <code>shutil</code>, un module un peu plus lent, mais surtout de plus haut niveau qui se charge des détails comme la nature et l&#8217;origine du fichier et de sa destination. </p>
<p>Bref, la solution est tout simplement de faire :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #dc143c;">shutil</span>.<span style="color: black;">move</span><span style="color: black;">&#40;</span>uploaded_tmp_file<span style="color: #66cc66;">,</span> destination<span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Tout ça pour ça, oui, mais c&#8217;est ce qui arrive quand une abstraction ne fait plus son boulot dans un langage de haut niveau où on a l&#8217;habitude que tout soit automatisé.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/invalid-cross-device-link/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2013/04/fUPKw.jpg" length="725486" type="image/jpg" />	</item>
		<item>
		<title>Set -e for the win 7</title>
		<link>http://sametmax.com/set-e-for-the-win/</link>
		<comments>http://sametmax.com/set-e-for-the-win/#comments</comments>
		<pubDate>Thu, 14 Mar 2013 08:26:52 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Administration System]]></category>
		<category><![CDATA[bash]]></category>
		<category><![CDATA[error]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=5408</guid>
		<description><![CDATA[10 ans plus tard, je découvre cette option pour les scripts bash.]]></description>
				<content:encoded><![CDATA[<p>10 ans plus tard, je découvre cette option pour les scripts bash.</p>
<p>Voyez vous, quand on écrit un script bash, il exécute les commandes ligne à ligne. Si il y en a une qui retourne une erreur, il continue vaillamment. </p>
<p>Sur un script où chaque ligne dépend de la précédente (comme un script de déploiement), c&#8217;est moyen.</p>
<p>Pour y pallier, il suffit de mettre tout en haut du script :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #008000;">set</span> -e</pre></td></tr></table></div>

<p>Et voilà. Si une commande retourne une erreur, le script s&#8217;arrête à ce niveau. 10 ans de Linux et je découvre ça maintenant. Moi content.</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/set-e-for-the-win/feed/</wfw:commentRss>
		<slash:comments>7</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2013/03/Msn39.jpg" length="297311" type="image/jpg" />	</item>
		<item>
		<title>A l&#8217;intérieur de mon .bashrc 22</title>
		<link>http://sametmax.com/a-linterieur-de-mon-bashrc/</link>
		<comments>http://sametmax.com/a-linterieur-de-mon-bashrc/#comments</comments>
		<pubDate>Tue, 22 Jan 2013 10:26:44 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Administration System]]></category>
		<category><![CDATA[bash]]></category>
		<category><![CDATA[git]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[shell]]></category>
		<category><![CDATA[virtualenv]]></category>
		<category><![CDATA[virtualenvwrapper]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=4238</guid>
		<description><![CDATA[Généralement montrer son <em>.bashrc</em> donne rapidement lieu dans les comments à un concours de celui qui a la plus longue (jusqu'à ce qu'arrive un utilisateur de zsh, et alors commence le concours de celui qui pisse le plus loin). Mais bon, aujourd'hui j'ai la flemme d'écrire un article complet.]]></description>
				<content:encoded><![CDATA[<p>Généralement montrer son <em>.bashrc</em> donne rapidement lieu dans les comments à un concours de celui qui a la plus longue (jusqu&#8217;à ce qu&#8217;arrive un utilisateur de zsh, et alors commence le concours de celui qui pisse le plus loin). Mais bon, aujourd&#8217;hui j&#8217;ai la flemme d&#8217;écrire un article complet.</p>
<p>Rappel : le <em>.bashrc</em> c&#8217;est le fichier qui est automatiquement chargé au démarrage du shell bash, le shell par défaut sur la plupart des Unix incluant Mac et Ubuntu.</p>
<p>Donc si vous voulez avoir une expérience de travail personnalisée dans votre terminal, c&#8217;est dans ce fichier que ça se passe.</p>
<p>Personnellement, j&#8217;ai tout le bordel que met Ubuntu par défaut (notamment les trucs avec les autocomplétions de partout). En en prime je rajoute :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># un raccourcis pour lancer Redis car je le met sur off par défaut mais je le </span>
<span style="color: #666666; font-style: italic;"># lance souvent</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">function</span> redis <span style="color: #7a0874; font-weight: bold;">&#123;</span>
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #000000; font-weight: bold;">!</span> <span style="color: #660033;">-e</span> <span style="color: #ff0000;">&quot;/var/run/redis/redis-server.pid&quot;</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span> ; <span style="color: #000000; font-weight: bold;">then</span>
        <span style="color: #c20cb9; font-weight: bold;">sudo</span> service redis-server start
    <span style="color: #000000; font-weight: bold;">fi</span>
<span style="color: #7a0874; font-weight: bold;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># un tas de raccourcis type</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">function</span> projet_django <span style="color: #7a0874; font-weight: bold;">&#123;</span>
    workon projet_django;
    <span style="color: #7a0874; font-weight: bold;">cd</span> <span style="color: #000000; font-weight: bold;">/</span>home<span style="color: #000000; font-weight: bold;">/</span>sam<span style="color: #000000; font-weight: bold;">/</span>Work<span style="color: #000000; font-weight: bold;">/</span>projet_django<span style="color: #000000; font-weight: bold;">/</span>repo<span style="color: #000000; font-weight: bold;">/</span>projet_django;
&nbsp;
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #007800;">$#</span> <span style="color: #660033;">-ne</span> <span style="color: #000000;">0</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        .<span style="color: #000000; font-weight: bold;">/</span>manage.py $<span style="color: #000000; font-weight: bold;">@</span>
    <span style="color: #000000; font-weight: bold;">fi</span>
<span style="color: #7a0874; font-weight: bold;">&#125;</span>
<span style="color: #7a0874; font-weight: bold;">alias</span> <span style="color: #007800;">sb</span>=<span style="color: #ff0000;">'projet_django'</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># CF: http://sametmax.com/un-alias-bash-pour-django-virtualenv-dont-je-ne-peux-plus-me-passer/</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># fonction fétiche de bourrin</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">function</span> killbill <span style="color: #7a0874; font-weight: bold;">&#123;</span>
    <span style="color: #007800;">BAK</span>=<span style="color: #007800;">$IFS</span>
    <span style="color: #007800;">IFS</span>=$<span style="color: #ff0000;">'\n'</span>
    <span style="color: #000000; font-weight: bold;">for</span> <span style="color: #c20cb9; font-weight: bold;">id</span> <span style="color: #000000; font-weight: bold;">in</span> $<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #c20cb9; font-weight: bold;">ps</span> aux <span style="color: #000000; font-weight: bold;">|</span> <span style="color: #c20cb9; font-weight: bold;">grep</span> <span style="color: #660033;">-P</span> <span style="color: #660033;">-i</span> <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">|</span> <span style="color: #c20cb9; font-weight: bold;">grep</span> <span style="color: #660033;">-v</span> <span style="color: #ff0000;">&quot;grep&quot;</span> <span style="color: #000000; font-weight: bold;">|</span> <span style="color: #c20cb9; font-weight: bold;">awk</span> <span style="color: #ff0000;">'{printf $2&quot; &quot;; for (i=11; i&lt;NF; i++) printf $i&quot; &quot;; print $NF}'</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>; <span style="color: #000000; font-weight: bold;">do</span> 
        <span style="color: #007800;">service</span>=$<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">echo</span> <span style="color: #007800;">$id</span> <span style="color: #000000; font-weight: bold;">|</span> <span style="color: #c20cb9; font-weight: bold;">cut</span> <span style="color: #660033;">-d</span> <span style="color: #ff0000;">&quot; &quot;</span> <span style="color: #660033;">-f</span> <span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
        <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #007800;">$2</span> == <span style="color: #ff0000;">&quot;-t&quot;</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
            <span style="color: #7a0874; font-weight: bold;">echo</span> <span style="color: #007800;">$service</span> <span style="color: #000000; font-weight: bold;">\&quot;</span>$<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">echo</span> <span style="color: #007800;">$id</span> <span style="color: #000000; font-weight: bold;">|</span> <span style="color: #c20cb9; font-weight: bold;">cut</span> <span style="color: #660033;">-d</span> <span style="color: #ff0000;">&quot; &quot;</span> <span style="color: #660033;">-f</span> <span style="color: #000000;">2</span>-<span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #000000; font-weight: bold;">\&quot;</span> <span style="color: #ff0000;">&quot;would be killed&quot;</span>
        <span style="color: #000000; font-weight: bold;">else</span>
&nbsp;
            <span style="color: #7a0874; font-weight: bold;">echo</span> <span style="color: #007800;">$service</span> <span style="color: #000000; font-weight: bold;">\&quot;</span>$<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">echo</span> <span style="color: #007800;">$id</span> <span style="color: #000000; font-weight: bold;">|</span> <span style="color: #c20cb9; font-weight: bold;">cut</span> <span style="color: #660033;">-d</span> <span style="color: #ff0000;">&quot; &quot;</span> <span style="color: #660033;">-f</span> <span style="color: #000000;">2</span>-<span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #000000; font-weight: bold;">\&quot;</span> <span style="color: #ff0000;">&quot;killed&quot;</span>
            <span style="color: #c20cb9; font-weight: bold;">kill</span> <span style="color: #660033;">-9</span> <span style="color: #007800;">$service</span>
        <span style="color: #000000; font-weight: bold;">fi</span>
    <span style="color: #000000; font-weight: bold;">done</span>
    <span style="color: #007800;">IFS</span>=<span style="color: #007800;">$BAK</span>
<span style="color: #7a0874; font-weight: bold;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># que j'ai un peu amélioré depuis http://sametmax.com/tu-vas-crever-oui/</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># une fonction pour commiter rapidement </span>
<span style="color: #000000; font-weight: bold;">function</span> commit <span style="color: #7a0874; font-weight: bold;">&#123;</span>
    <span style="color: #c20cb9; font-weight: bold;">git commit</span> <span style="color: #660033;">-m</span> <span style="color: #ff0000;">&quot;<span style="color: #780078;">`echo &quot;$*&quot; | sed -e 's/^./\U&amp;\E/g'`</span>&quot;</span>
<span style="color: #7a0874; font-weight: bold;">&#125;</span>
<span style="color: #7a0874; font-weight: bold;">alias</span> <span style="color: #007800;">co</span>=commit;
&nbsp;
<span style="color: #666666; font-style: italic;"># en gros on tappe &quot;co message de commit&quot;. Sans guillement, sans rien.</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># des completions pour manage.py et git</span>
&nbsp;
<span style="color: #7a0874; font-weight: bold;">source</span> <span style="color: #000000; font-weight: bold;">/</span>home<span style="color: #000000; font-weight: bold;">/</span>sam<span style="color: #000000; font-weight: bold;">/</span>.django_bash_completion
<span style="color: #7a0874; font-weight: bold;">source</span> <span style="color: #000000; font-weight: bold;">/</span>home<span style="color: #000000; font-weight: bold;">/</span>sam<span style="color: #000000; font-weight: bold;">/</span>.git-completion.bash
&nbsp;
<span style="color: #666666; font-style: italic;"># activation du cache de pip pour éviter de télécharger 20 fois la même lib</span>
&nbsp;
<span style="color: #007800;">PIP_DOWNLOAD_CACHE</span>=<span style="color: #ff0000;">'/opt/pip-cache'</span>;
<span style="color: #7a0874; font-weight: bold;">export</span> PIP_DOWNLOAD_CACHE;
&nbsp;
<span style="color: #666666; font-style: italic;"># un super outil pour un git plus user friendly</span>
&nbsp;
<span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #660033;">-s</span> <span style="color: #ff0000;">&quot;/home/sam/.scm_breeze/scm_breeze.sh&quot;</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000; font-weight: bold;">&amp;&amp;</span> <span style="color: #7a0874; font-weight: bold;">source</span> <span style="color: #ff0000;">&quot;/home/sam/.scm_breeze/scm_breeze.sh&quot;</span>
<span style="color: #7a0874; font-weight: bold;">alias</span> <span style="color: #007800;">c</span>=<span style="color: #ff0000;">&quot;git_index&quot;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># j'en avais parlé ici : http://sametmax.com/scm-breeze-facilite-la-selection-de-vos-fichiers-a-commiter-sous-git-avec/</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># un prompt personalisé tout en couleur</span>
<span style="color: #666666; font-style: italic;"># formaté comme ça: [nom du virtualenv] sam ~/path (branche git) $</span>
&nbsp;
<span style="color: #7a0874; font-weight: bold;">source</span> ~<span style="color: #000000; font-weight: bold;">/</span>.prompt.bash
&nbsp;
<span style="color: #666666; font-style: italic;"># le fichier ressemble à ça : http://0bin.net/paste/d103a91dc41818462da0c8468ddddf4141f2efd6#dKr6qWHfAVZsSnOQ7fA4pPQ3Dquhz0Oj1b2OF8xw6vA=</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># la configuration de virtualenv wrapper </span>
<span style="color: #7a0874; font-weight: bold;">export</span> <span style="color: #007800;">WORKON_HOME</span>=<span style="color: #000000; font-weight: bold;">/</span>home<span style="color: #000000; font-weight: bold;">/</span>sam<span style="color: #000000; font-weight: bold;">/</span>.virtualenvs
<span style="color: #c20cb9; font-weight: bold;">mkdir</span> <span style="color: #660033;">-p</span> <span style="color: #007800;">$WORKON_HOME</span>
<span style="color: #7a0874; font-weight: bold;">source</span> <span style="color: #000000; font-weight: bold;">/</span>usr<span style="color: #000000; font-weight: bold;">/</span>local<span style="color: #000000; font-weight: bold;">/</span>bin<span style="color: #000000; font-weight: bold;">/</span>virtualenvwrapper.sh
&nbsp;
<span style="color: #666666; font-style: italic;"># plus de détails ici : http://sametmax.com/les-environnement-virtuels-python-virtualenv-et-virtualenvwrapper/</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># j'ai récément succombé aux sirène du virtualenv automatique</span>
<span style="color: #666666; font-style: italic;"># j'avais beaucoup d'a priori (particulirement écraser la commande CD)</span>
<span style="color: #666666; font-style: italic;"># mais à l'usage, c'est pratique</span>
has_virtualenv<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #7a0874; font-weight: bold;">&#123;</span>
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #660033;">-e</span> .venv <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        workon <span style="color: #000000; font-weight: bold;">`</span><span style="color: #c20cb9; font-weight: bold;">cat</span> .venv<span style="color: #000000; font-weight: bold;">`</span>
    <span style="color: #000000; font-weight: bold;">fi</span>
<span style="color: #7a0874; font-weight: bold;">&#125;</span>
venv_cd <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #7a0874; font-weight: bold;">&#123;</span>
    <span style="color: #7a0874; font-weight: bold;">builtin</span> <span style="color: #7a0874; font-weight: bold;">cd</span> <span style="color: #ff0000;">&quot;$@&quot;</span> <span style="color: #000000; font-weight: bold;">&amp;&amp;</span> has_virtualenv
<span style="color: #7a0874; font-weight: bold;">&#125;</span>
<span style="color: #7a0874; font-weight: bold;">alias</span> <span style="color: #007800;">cd</span>=<span style="color: #ff0000;">&quot;venv_cd&quot;</span>
has_virtualenv
&nbsp;
<span style="color: #666666; font-style: italic;"># en gros ça m'active un virtualenv si il y a un fichier .venv avec un nom</span>
<span style="color: #666666; font-style: italic;"># de virtualenv dedans dans le dossier courrant</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># je vous en parlais récement (http://sametmax.com/configurer-votre-terminal-pour-quil-vous-notifie-de-la-fin-dune-commande-longue/)</span>
<span style="color: #666666; font-style: italic;"># c'est pour avoir une notifi à la fin des commandes longues </span>
notify_when_long_running_commands_finish_install
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># ca c'est un truc de feignasse car je me souviens jamais comment extraire </span>
<span style="color: #666666; font-style: italic;"># en ligne de commande tel ou tel format</span>
&nbsp;
extract <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #7a0874; font-weight: bold;">&#123;</span>
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #660033;">-f</span> <span style="color: #007800;">$1</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>
    <span style="color: #000000; font-weight: bold;">then</span>
        <span style="color: #000000; font-weight: bold;">case</span> <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">in</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.7z<span style="color: #7a0874; font-weight: bold;">&#41;</span> 7z x <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.lzma<span style="color: #7a0874; font-weight: bold;">&#41;</span> unlzma <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.rar<span style="color: #7a0874; font-weight: bold;">&#41;</span> unrar x <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.tar<span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #c20cb9; font-weight: bold;">tar</span> xvf <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.tar.bz2<span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #c20cb9; font-weight: bold;">tar</span> xvjf <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.bz2<span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #c20cb9; font-weight: bold;">bunzip2</span> <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.tar.gz<span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #c20cb9; font-weight: bold;">tar</span> xvzf <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.gz<span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #c20cb9; font-weight: bold;">gunzip</span> <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.tar.xz<span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #c20cb9; font-weight: bold;">tar</span> Jxvf <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.xz<span style="color: #7a0874; font-weight: bold;">&#41;</span> xz <span style="color: #660033;">-d</span> <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.tbz2<span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #c20cb9; font-weight: bold;">tar</span> xvjf <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.tgz<span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #c20cb9; font-weight: bold;">tar</span> xvzf <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.zip<span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #c20cb9; font-weight: bold;">unzip</span> <span style="color: #007800;">$1</span> <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span>.Z<span style="color: #7a0874; font-weight: bold;">&#41;</span> uncompress <span style="color: #000000; font-weight: bold;">;;</span>
            <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000; font-weight: bold;">*</span><span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #7a0874; font-weight: bold;">echo</span> <span style="color: #ff0000;">&quot;don't know how to extract '$1'...&quot;</span> <span style="color: #000000; font-weight: bold;">;;</span>
        <span style="color: #000000; font-weight: bold;">esac</span>
    <span style="color: #000000; font-weight: bold;">else</span>
        <span style="color: #7a0874; font-weight: bold;">echo</span> <span style="color: #ff0000;">&quot;Error: '$1' is not a valid file!&quot;</span>
        <span style="color: #7a0874; font-weight: bold;">exit</span> <span style="color: #000000;">0</span>
    <span style="color: #000000; font-weight: bold;">fi</span>
<span style="color: #7a0874; font-weight: bold;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># ça date de http://sametmax.com/decompresser-sous-linux-en-ligne-de-commande/</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># et quelques alias pour des tâches de tous les jours</span>
&nbsp;
<span style="color: #7a0874; font-weight: bold;">alias</span> ..=<span style="color: #ff0000;">'cd ..'</span>
<span style="color: #7a0874; font-weight: bold;">alias</span> ...=<span style="color: #ff0000;">'cd ../../'</span>
<span style="color: #7a0874; font-weight: bold;">alias</span> ....=<span style="color: #ff0000;">'cd ../../../'</span>
<span style="color: #7a0874; font-weight: bold;">alias</span> .....=<span style="color: #ff0000;">'cd ../../../../'</span>
<span style="color: #7a0874; font-weight: bold;">alias</span> ......=<span style="color: #ff0000;">'cd ../../../../../'</span>
&nbsp;
<span style="color: #7a0874; font-weight: bold;">alias</span> <span style="color: #007800;">process</span>=<span style="color: #ff0000;">'ps aux | grep'</span>
<span style="color: #7a0874; font-weight: bold;">alias</span> <span style="color: #007800;">serve</span>=<span style="color: #ff0000;">&quot;python -c 'import SimpleHTTPServer; SimpleHTTPServer.test()'&quot;</span></pre></td></tr></table></div>

]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/a-linterieur-de-mon-bashrc/feed/</wfw:commentRss>
		<slash:comments>22</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2013/01/23207079.jpg" length="22869" type="image/jpg" />	</item>
		<item>
		<title>Un alias bash pour Django + virtualenv dont je ne peux plus me passer 9</title>
		<link>http://sametmax.com/un-alias-bash-pour-django-virtualenv-dont-je-ne-peux-plus-me-passer/</link>
		<comments>http://sametmax.com/un-alias-bash-pour-django-virtualenv-dont-je-ne-peux-plus-me-passer/#comments</comments>
		<pubDate>Wed, 10 Oct 2012 13:57:03 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Administration System]]></category>
		<category><![CDATA[Programmation]]></category>
		<category><![CDATA[bash]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=2544</guid>
		<description><![CDATA[Il n'y a pas de petite victoire]]></description>
				<content:encoded><![CDATA[<p>Ce n&#8217;est pas subtil, ça veut dire que pour chaque projet on rajoute cette patate dans son <code>.bashrc</code>:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">function</span> nom_du_projet <span style="color: #7a0874; font-weight: bold;">&#123;</span>
    workon nom_du_virtualenv;
    <span style="color: #7a0874; font-weight: bold;">cd</span> <span style="color: #000000; font-weight: bold;">/</span>chemin<span style="color: #000000; font-weight: bold;">/</span>vers<span style="color: #000000; font-weight: bold;">/</span>le<span style="color: #000000; font-weight: bold;">/</span>projet<span style="color: #000000; font-weight: bold;">/</span>django<span style="color: #000000; font-weight: bold;">/</span>;
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #007800;">$#</span> <span style="color: #660033;">-ne</span> <span style="color: #000000;">0</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        .<span style="color: #000000; font-weight: bold;">/</span>manage.py $<span style="color: #000000; font-weight: bold;">@</span>
    <span style="color: #000000; font-weight: bold;">fi</span>
<span style="color: #7a0874; font-weight: bold;">&#125;</span></pre></td></tr></table></div>

<p>Mais du coup:</p>
<p>Aller dans le dossier du projet et activer le <a href="sametmax.com/les-environnement-virtuels-python-virtualenv-et-virtualenvwrapper">virtualenv</a>:</p>
<p><code>nom_du_projet</code></p>
<p>Aller dans le dossier du projet et activer le virtualenv, et éxécuter une commande de <em>manage.py</em>:</p>
<p><code>nom_du_projet schemamigration app --auto</code></p>
<p>Et bien sur on peut toujours revenir dans le dossier précédent avec:</p>
<p><code>cd -</code></p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/un-alias-bash-pour-django-virtualenv-dont-je-ne-peux-plus-me-passer/feed/</wfw:commentRss>
		<slash:comments>9</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2012/10/430201085102AM_motivational-posters-4.jpg" length="42683" type="image/jpg" />	</item>
		<item>
		<title>Liste des partitions, de leur type, de la place restante sous Linux &#8211; df / du 14</title>
		<link>http://sametmax.com/liste-des-partitions-de-leur-type-de-la-place-restante-sous-linux-df-du/</link>
		<comments>http://sametmax.com/liste-des-partitions-de-leur-type-de-la-place-restante-sous-linux-df-du/#comments</comments>
		<pubDate>Mon, 10 Sep 2012 01:36:48 +0000</pubDate>
		<dc:creator><![CDATA[Max]]></dc:creator>
				<category><![CDATA[Administration System]]></category>
		<category><![CDATA[bash]]></category>
		<category><![CDATA[df]]></category>
		<category><![CDATA[disque]]></category>
		<category><![CDATA[du]]></category>
		<category><![CDATA[espace]]></category>
		<category><![CDATA[linux]]></category>
		<category><![CDATA[partition]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=2049</guid>
		<description><![CDATA[Quelques commandes sympa sous Linux pour connaître les ressources disque de son serveur.]]></description>
				<content:encoded><![CDATA[<p>Quelques commandes sympa sous Linux pour connaître les ressources disque de son serveur.</p>
<p><strong>la commande df:</strong><br />
Retourne l&#8217;espace disque utilisé par chaque partition montée sur votre machine.</p>
<p>-h Affiche les résultats sous forme humainement lisible :)<br />
-T indique le type de système de fichiers utilisé</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">df</span> <span style="color: #660033;">-hT</span>
Sys. fich.    Type  Taille  Uti. Disp. Uti<span style="color: #000000; font-weight: bold;">%</span> Monté sur
<span style="color: #000000; font-weight: bold;">/</span>dev<span style="color: #000000; font-weight: bold;">/</span>sda2      xfs     20G  <span style="color: #000000;">2</span>,9G   17G  <span style="color: #000000;">15</span><span style="color: #000000; font-weight: bold;">%</span> <span style="color: #000000; font-weight: bold;">/</span>
tmpfs        tmpfs    <span style="color: #000000;">3</span>,9G     <span style="color: #000000;">0</span>  <span style="color: #000000;">3</span>,9G   <span style="color: #000000;">0</span><span style="color: #000000; font-weight: bold;">%</span> <span style="color: #000000; font-weight: bold;">/</span>dev<span style="color: #000000; font-weight: bold;">/</span>shm
<span style="color: #000000; font-weight: bold;">/</span>dev<span style="color: #000000; font-weight: bold;">/</span>sda1      xfs    192M   28M  164M  <span style="color: #000000;">15</span><span style="color: #000000; font-weight: bold;">%</span> <span style="color: #000000; font-weight: bold;">/</span>boot
<span style="color: #000000; font-weight: bold;">/</span>dev<span style="color: #000000; font-weight: bold;">/</span>sda4      xfs    <span style="color: #000000;">1</span>,8T  220G  <span style="color: #000000;">1</span>,6T  <span style="color: #000000;">12</span><span style="color: #000000; font-weight: bold;">%</span> <span style="color: #000000; font-weight: bold;">/</span>data</pre></td></tr></table></div>

<p><strong>la commande du:</strong><br />
Retourne l&#8217;espace disque utilisé par un répertoire</p>
<p>-h Affiche les résultats sous forme humainement lisible :)<br />
-s affiche la somme des fichiers du répertoire</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">du</span> <span style="color: #660033;">-hs</span> <span style="color: #000000; font-weight: bold;">/</span>boot<span style="color: #000000; font-weight: bold;">/</span>
18M	<span style="color: #000000; font-weight: bold;">/</span>boot<span style="color: #000000; font-weight: bold;">/</span></pre></td></tr></table></div>

<p>Et si vous voulez trouver ce qui prend toute cette place, c&#8217;est <a href="http://sametmax.com/trouver-ce-qui-prend-de-la-place-en-ligne-de-commande/">par ici</a>.</p>
<p><strong>Edit:</strong><br />
Pour le côté prog on peu utiliser <a href="http://code.google.com/p/psutil/">psutil</a> en python qui permet tout un tas d&#8217;acceès aux infos de la machine.<br />
Merci François</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/liste-des-partitions-de-leur-type-de-la-place-restante-sous-linux-df-du/feed/</wfw:commentRss>
		<slash:comments>14</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2012/09/disque-vinyl.jpeg" length="61713" type="image/jpg" />	</item>
		<item>
		<title> SCM Breeze facilite la selection de vos fichiers à commiter sous Git 11</title>
		<link>http://sametmax.com/scm-breeze-facilite-la-selection-de-vos-fichiers-a-commiter-sous-git-avec/</link>
		<comments>http://sametmax.com/scm-breeze-facilite-la-selection-de-vos-fichiers-a-commiter-sous-git-avec/#comments</comments>
		<pubDate>Fri, 31 Aug 2012 14:51:39 +0000</pubDate>
		<dc:creator><![CDATA[Sam]]></dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[bash]]></category>
		<category><![CDATA[git]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=1946</guid>
		<description><![CDATA[Je sais, vous faites tous <code>git add .</code> comme <del datetime="2012-08-31T08:50:47+00:00">Max</del> des gros bourrins. Mais je vais partir du principe que certains d'entre vous font leurs commits avec amour, en prenant uniquement les fichiers dont ils ont besoin.]]></description>
				<content:encoded><![CDATA[<p>Je sais, vous faites tous <code>git add .</code> comme <del datetime="2012-08-31T08:50:47+00:00">Max</del> des gros bourrins. Mais je vais partir du principe que certains d&#8217;entre vous font leurs commits avec amour, en prenant uniquement les fichiers dont ils ont besoin.</p>
<p>Et ces certains-d-entre-vous-qui-font-leurs-commits-avec-amour sont frustrés de devoir manuellement ajouter chaque fichier ou dossier.</p>
<p>Ceci est un message d&#8217;espoir pour notre minorité bafouée aux cris étouffés par la répression grondante des&#8230; Mais je m&#8217;égare.</p>
<h2>La révolution s&#8217;appelle SCM Breeze, camarade</h2>
<p>Ca s&#8217;installe les doigts dans le goulag:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">git clone</span> git:<span style="color: #000000; font-weight: bold;">//</span>github.com<span style="color: #000000; font-weight: bold;">/</span>ndbroadbent<span style="color: #000000; font-weight: bold;">/</span>scm_breeze.git ~<span style="color: #000000; font-weight: bold;">/</span>.scm_breeze</pre></td></tr></table></div>

<p>Et on rajoute ça dans le <em>.bashrc</em>:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #660033;">-s</span> <span style="color: #ff0000;">&quot;<span style="color: #007800;">$HOME</span>/.scm_breeze/scm_breeze.sh&quot;</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000; font-weight: bold;">&amp;&amp;</span> <span style="color: #7a0874; font-weight: bold;">source</span> <span style="color: #ff0000;">&quot;<span style="color: #007800;">$HOME</span>/.scm_breeze/scm_breeze.sh&quot;</span></pre></td></tr></table></div>

<p>Puis on copie git.scmbrc.example dans ~/.git.scmbrc:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">cp</span> ~.<span style="color: #000000; font-weight: bold;">/</span>.scm_breeze<span style="color: #000000; font-weight: bold;">/</span>git.scmbrc.example ~<span style="color: #000000; font-weight: bold;">/</span>.git.scmbrc</pre></td></tr></table></div>

<p>Et on a alors accès à la commande <code>gs</code>, qui donne à peu prêt ça (shameless hotlinking):</p>
<p><img src="http://madebynathan.com/images/posts/2011/10/status_with_shortcuts-resized-post.png" />
<p>En plus d&#8217;être vachement court à taper et d&#8217;avoir une sortie plus lisible, on obtient des pitis numéros a gauche (évidément). Et là, on peut faire des trucs vachement révolutionnaires comme:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">ga <span style="color: #000000;">3</span> <span style="color: #000000;">9</span> <span style="color: #000000;">11</span> <span style="color: #666666; font-style: italic;"># rajoute uniquement ces fichiers pour les faire commiter</span>
ga <span style="color: #000000;">3</span>..<span style="color: #000000;">9</span> <span style="color: #666666; font-style: italic;"># rajoute les fichiers de 3 à 9 pour les commiter</span>
grm <span style="color: #000000;">3</span> <span style="color: #666666; font-style: italic;"># retire ce fichier</span>
grs <span style="color: #000000;">5</span> <span style="color: #666666; font-style: italic;"># soft reset sur le fichier</span></pre></td></tr></table></div>

<p>Mais il y a encore mieux. Si vous connaissez <a href="https://github.com/joelthelion/autojump">autojump</a>, vous apprecierez <code>git_index</code>, livré par le parti avec SCM Breeze:</p>
<p>Un petit alias dans <em>.bashrc</em>:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #7a0874; font-weight: bold;">alias</span> <span style="color: #007800;">c</span>=<span style="color: #ff0000;">&quot;git_index&quot;</span></pre></td></tr></table></div>

<p>Et à chaque fois qu&#8217;on rajoute un nouveau repo:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">c <span style="color: #660033;">--rebuild</span></pre></td></tr></table></div>

<p>Après il suffit de faire:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">c quelques_lettre_du_nom_du_repo</pre></td></tr></table></div>

<p>Et où qu&#8217;on soit dans le système, on se retrouve dans le repo.</p>
<p>Vous pouvez en apprendre plus <a href="https://github.com/ndbroadbent/scm_breeze">sur github</a>.</p>
<p>PS:  ouai, c&#8217;est du ruby&#8230;</p>
]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/scm-breeze-facilite-la-selection-de-vos-fichiers-a-commiter-sous-git-avec/feed/</wfw:commentRss>
		<slash:comments>11</slash:comments>
	<enclosure url="http://sametmax.com/wp-content/uploads/2012/08/220px-Karl_Marx_001.jpg" length="20115" type="image/jpg" />	</item>
	</channel>
</rss>

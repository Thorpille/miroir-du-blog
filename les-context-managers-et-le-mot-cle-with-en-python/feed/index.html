<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	
	>
<channel>
	<title>Comments on: Les context managers et le mot clé with en Python</title>
	<atom:link href="http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/</link>
	<description>Du code, du cul</description>
	<lastBuildDate>Sat, 07 Nov 2015 11:08:18 +0000</lastBuildDate>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=4.1</generator>
	<item>
		<title>By: Sébastien</title>
		<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/#comment-160135</link>
		<dc:creator><![CDATA[Sébastien]]></dc:creator>
		<pubDate>Sat, 02 May 2015 13:17:09 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=1987#comment-160135</guid>
		<description><![CDATA[&lt;p&gt;Je cherchais à générer un fichier XML. L&#039;idée d&#039;utiliser la notion de context manager me trottait. En Googlant un peu j&#039;ai trouvé cette excellente bibliothèque qui mérite d&#039;être connue : http://www.yattag.org/ https://github.com/leforestier/yattag&lt;/p&gt;

&lt;pre lang=&quot;python&quot;&gt;

from yattag import Doc, indent

doc, tag, text = Doc().tagtext()

with tag(&#039;persons&#039;):
    with tag(&#039;person&#039;, id = &#039;0&#039;):
        with tag(&#039;name&#039;):
            text(&#039;Pierre&#039;)
    with tag(&#039;person&#039;, id = &#039;1&#039;):
        with tag(&#039;name&#039;):
            text(&#039;Paul&#039;)
    with tag(&#039;person&#039;, id = &#039;2&#039;):
        with tag(&#039;name&#039;):
            text(&#039;Jacques&#039;)

result = indent(
    doc.getvalue(),
    indentation = &#039; &#039;*4,
    newline = &#039;\r\n&#039;
)

print(result)
&lt;/pre&gt;

&lt;p&gt;Ce bout de code permet de générer:&lt;/p&gt;

&lt;pre lang=&quot;xml&quot;&gt;





Pierre





Paul





Jacques





&lt;/pre&gt;
]]></description>
		<content:encoded><![CDATA[<p>Je cherchais à générer un fichier XML. L&#8217;idée d&#8217;utiliser la notion de context manager me trottait. En Googlant un peu j&#8217;ai trouvé cette excellente bibliothèque qui mérite d&#8217;être connue : <a href="http://www.yattag.org/" rel="nofollow">http://www.yattag.org/</a> <a href="https://github.com/leforestier/yattag" rel="nofollow">https://github.com/leforestier/yattag</a></p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;">&nbsp;
<span style="color: #ff7700;font-weight:bold;">from</span> yattag <span style="color: #ff7700;font-weight:bold;">import</span> Doc<span style="color: #66cc66;">,</span> indent
&nbsp;
doc<span style="color: #66cc66;">,</span> tag<span style="color: #66cc66;">,</span> text <span style="color: #66cc66;">=</span> Doc<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: black;">tagtext</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">with</span> tag<span style="color: black;">&#40;</span><span style="color: #483d8b;">'persons'</span><span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">with</span> tag<span style="color: black;">&#40;</span><span style="color: #483d8b;">'person'</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">id</span> <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'0'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">with</span> tag<span style="color: black;">&#40;</span><span style="color: #483d8b;">'name'</span><span style="color: black;">&#41;</span>:
            text<span style="color: black;">&#40;</span><span style="color: #483d8b;">'Pierre'</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">with</span> tag<span style="color: black;">&#40;</span><span style="color: #483d8b;">'person'</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">id</span> <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'1'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">with</span> tag<span style="color: black;">&#40;</span><span style="color: #483d8b;">'name'</span><span style="color: black;">&#41;</span>:
            text<span style="color: black;">&#40;</span><span style="color: #483d8b;">'Paul'</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">with</span> tag<span style="color: black;">&#40;</span><span style="color: #483d8b;">'person'</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">id</span> <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'2'</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">with</span> tag<span style="color: black;">&#40;</span><span style="color: #483d8b;">'name'</span><span style="color: black;">&#41;</span>:
            text<span style="color: black;">&#40;</span><span style="color: #483d8b;">'Jacques'</span><span style="color: black;">&#41;</span>
&nbsp;
result <span style="color: #66cc66;">=</span> indent<span style="color: black;">&#40;</span>
    doc.<span style="color: black;">getvalue</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span>
    indentation <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">' '</span>*<span style="color: #ff4500;">4</span><span style="color: #66cc66;">,</span>
    newline <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'<span style="color: #000099; font-weight: bold;">\r</span><span style="color: #000099; font-weight: bold;">\n</span>'</span>
<span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>result<span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Ce bout de code permet de générer:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family:monospace;">&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
Pierre
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
Paul
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
Jacques</pre></td></tr></table></div>

]]></content:encoded>
	</item>
	<item>
		<title>By: Sam</title>
		<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/#comment-89347</link>
		<dc:creator><![CDATA[Sam]]></dc:creator>
		<pubDate>Tue, 08 Jul 2014 18:25:31 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=1987#comment-89347</guid>
		<description><![CDATA[J&#039;ai corrigé toutes les coquilles. Merci pour votre vigilance, les articles gagnent vraiment en qualité quand vous corrigez mes conneries :)]]></description>
		<content:encoded><![CDATA[<p>J&#8217;ai corrigé toutes les coquilles. Merci pour votre vigilance, les articles gagnent vraiment en qualité quand vous corrigez mes conneries :)</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: bato-san</title>
		<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/#comment-89145</link>
		<dc:creator><![CDATA[bato-san]]></dc:creator>
		<pubDate>Tue, 08 Jul 2014 15:02:24 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=1987#comment-89145</guid>
		<description><![CDATA[@Lujeni

&lt;pre lang=&quot;python&quot;&gt;@TimeIt
def ma_fonction():
  blabla&lt;/pre&gt;

correspond a :

&lt;pre lang=&quot;python&quot;&gt;def ma_fonction():
   blabla
   ma_fonction = TimeIt(ma_fonction)
&lt;/pre&gt;

or ici TimeIt est la ref d une classe et non pas d une instance de classe , donc &quot; TimeIt(ma_fonction) &quot; appelle la méthode __new__() de TimeIt ( et non pas __call__() ) et lui passe en paramètre une fonction , ce qui n est pas apprecié de la part du compilateur X) 
Pour appeler la méthode __call__() (et qu accessoirement ca marche ;v ), il faut donc écrire :

&lt;pre lang=&quot;python&quot;&gt;def ma_fonction():
  blabla
  ma_fonction = TimeIt()(ma_fonction)&lt;/pre&gt;

soit:

&lt;pre lang=&quot;python&quot;&gt;@TimeIt()
def ma_fonction():
  blabla
&lt;/pre&gt;
En espérant avoir aidé :)]]></description>
		<content:encoded><![CDATA[<p>@Lujeni</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>TimeIt
<span style="color: #ff7700;font-weight:bold;">def</span> ma_fonction<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
  blabla</pre></td></tr></table></div>

<p>correspond a :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> ma_fonction<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
   blabla
   ma_fonction <span style="color: #66cc66;">=</span> TimeIt<span style="color: black;">&#40;</span>ma_fonction<span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>or ici TimeIt est la ref d une classe et non pas d une instance de classe , donc &#8221; TimeIt(ma_fonction) &#8221; appelle la méthode __new__() de TimeIt ( et non pas __call__() ) et lui passe en paramètre une fonction , ce qui n est pas apprecié de la part du compilateur X)<br />
Pour appeler la méthode __call__() (et qu accessoirement ca marche ;v ), il faut donc écrire :</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> ma_fonction<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
  blabla
  ma_fonction <span style="color: #66cc66;">=</span> TimeIt<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#40;</span>ma_fonction<span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>soit:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">@</span>TimeIt<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">def</span> ma_fonction<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
  blabla</pre></td></tr></table></div>

<p>En espérant avoir aidé :)</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: hamzahik</title>
		<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/#comment-23961</link>
		<dc:creator><![CDATA[hamzahik]]></dc:creator>
		<pubDate>Tue, 15 Apr 2014 12:00:56 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=1987#comment-23961</guid>
		<description><![CDATA[&lt;code&gt;with OpenFile(&#039;/etc/fstab&#039;) as f:
    for line in f:
        print line #au lieu de &quot;print f&quot; je pense&lt;/code&gt;]]></description>
		<content:encoded><![CDATA[<p><code>with OpenFile('/etc/fstab') as f:<br />
    for line in f:<br />
        print line #au lieu de "print f" je pense</code></p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Lujeni</title>
		<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/#comment-7528</link>
		<dc:creator><![CDATA[Lujeni]]></dc:creator>
		<pubDate>Sun, 31 Mar 2013 00:01:40 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=1987#comment-7528</guid>
		<description><![CDATA[Hello, dans l&#039;exemple du code mixant Decorator&amp;Context il manque un &lt;strong&gt;t &lt;/strong&gt;sur la ligne &lt;code&gt;self.start = datetime.dateime.now()&lt;/code&gt;. L&#039;utilisation du decorator TimeIt semble lèver une exception TypeError: object.__new__() takes no parameters.]]></description>
		<content:encoded><![CDATA[<p>Hello, dans l&#8217;exemple du code mixant Decorator&amp;Context il manque un <strong>t </strong>sur la ligne <code>self.start = datetime.dateime.now()</code>. L&#8217;utilisation du decorator TimeIt semble lèver une exception TypeError: object.__new__() takes no parameters.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Etienne</title>
		<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/#comment-5805</link>
		<dc:creator><![CDATA[Etienne]]></dc:creator>
		<pubDate>Fri, 01 Feb 2013 10:55:42 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=1987#comment-5805</guid>
		<description><![CDATA[Vraiment chouette tout ça. Ce qui est bien, c&#039;est que les contextmanager peuvent être utilisé sur des bouts de code de taille arbitraire.

Je pense à ton TimeIt par exemple, qui pourrait logger le temps d&#039;exécution de portions de code critique (genre query dans db qui grossit rapidement), et/ou pourrait effectuer un action si ce temps dépasse un seuil donné.

Sympa, sympa]]></description>
		<content:encoded><![CDATA[<p>Vraiment chouette tout ça. Ce qui est bien, c&#8217;est que les contextmanager peuvent être utilisé sur des bouts de code de taille arbitraire.</p>
<p>Je pense à ton TimeIt par exemple, qui pourrait logger le temps d&#8217;exécution de portions de code critique (genre query dans db qui grossit rapidement), et/ou pourrait effectuer un action si ce temps dépasse un seuil donné.</p>
<p>Sympa, sympa</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Sam</title>
		<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/#comment-1830</link>
		<dc:creator><![CDATA[Sam]]></dc:creator>
		<pubDate>Thu, 13 Sep 2012 11:59:17 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=1987#comment-1830</guid>
		<description><![CDATA[Au passage, j&#039;ai eu la question:

&quot;Mais en quoi c&#039;est utile le context manager pour open ?&quot;

&lt;pre lang=&quot;python&quot;&gt;try:
    with open(&quot;fichier&quot;, &quot;r&quot;) as f:
        ligne = f.readline()
except IOError:
    print &quot;Erreur&quot;&lt;/pre&gt;

&quot;Est a peine plus court que:&quot;


&lt;pre lang=&quot;python&quot;&gt;
try:
    f = open(&quot;fichier&quot;, &quot;r&quot;)
    ligne = f.readline()
except IOError:
    print &quot;Erreur&quot;
finally:
    f.close()&lt;/pre&gt;

Alors je note la réponse ici:

Ces deux codes ci-dessus ne sont PAS équivalents.

En effet, l&#039;équivalent sans le context manager est:

&lt;pre lang=&quot;python&quot;&gt;
try:
    f = open(&quot;fichier&quot;, &quot;r&quot;)
    try:
        ligne = f.readline()
    finally:
        f.close()
except IOError:
    print &quot;Erreur&quot;
&lt;/pre&gt;

Avec un double &lt;code&gt;try&lt;/code&gt; imbriqué.

En effet, il peut y avoir une erreur à l&#039;ouverture du fichier, et dans ce cas la clause &lt;code&gt;finally&lt;/code&gt; va planter, car &lt;code&gt;f&lt;/code&gt; n&#039;existera pas !

Utiliser &lt;code&gt;with&lt;/code&gt; permet de s&#039;affranchir de ce genre de petits détails.]]></description>
		<content:encoded><![CDATA[<p>Au passage, j&#8217;ai eu la question:</p>
<p>&#8220;Mais en quoi c&#8217;est utile le context manager pour open ?&#8221;</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">try</span>:
    <span style="color: #ff7700;font-weight:bold;">with</span> <span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;fichier&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">&quot;r&quot;</span><span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">as</span> f:
        ligne <span style="color: #66cc66;">=</span> f.<span style="color: #dc143c;">readline</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">IOError</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: #483d8b;">&quot;Erreur&quot;</span></pre></td></tr></table></div>

<p>&#8220;Est a peine plus court que:&#8221;</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">try</span>:
    f <span style="color: #66cc66;">=</span> <span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;fichier&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">&quot;r&quot;</span><span style="color: black;">&#41;</span>
    ligne <span style="color: #66cc66;">=</span> f.<span style="color: #dc143c;">readline</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">IOError</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: #483d8b;">&quot;Erreur&quot;</span>
<span style="color: #ff7700;font-weight:bold;">finally</span>:
    f.<span style="color: black;">close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></td></tr></table></div>

<p>Alors je note la réponse ici:</p>
<p>Ces deux codes ci-dessus ne sont PAS équivalents.</p>
<p>En effet, l&#8217;équivalent sans le context manager est:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">try</span>:
    f <span style="color: #66cc66;">=</span> <span style="color: #008000;">open</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;fichier&quot;</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">&quot;r&quot;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">try</span>:
        ligne <span style="color: #66cc66;">=</span> f.<span style="color: #dc143c;">readline</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">finally</span>:
        f.<span style="color: black;">close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">IOError</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: #483d8b;">&quot;Erreur&quot;</span></pre></td></tr></table></div>

<p>Avec un double <code>try</code> imbriqué.</p>
<p>En effet, il peut y avoir une erreur à l&#8217;ouverture du fichier, et dans ce cas la clause <code>finally</code> va planter, car <code>f</code> n&#8217;existera pas !</p>
<p>Utiliser <code>with</code> permet de s&#8217;affranchir de ce genre de petits détails.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Sébastien</title>
		<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/#comment-1701</link>
		<dc:creator><![CDATA[Sébastien]]></dc:creator>
		<pubDate>Tue, 04 Sep 2012 17:18:07 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=1987#comment-1701</guid>
		<description><![CDATA[Très bon article ! Merci les gars !]]></description>
		<content:encoded><![CDATA[<p>Très bon article ! Merci les gars !</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Sam</title>
		<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/#comment-1700</link>
		<dc:creator><![CDATA[Sam]]></dc:creator>
		<pubDate>Tue, 04 Sep 2012 14:07:23 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=1987#comment-1700</guid>
		<description><![CDATA[Merci zariko. 

Maintenant il faut que je trouve un moyen de placer &quot;la fin des zarikos&quot; dans un blog post.]]></description>
		<content:encoded><![CDATA[<p>Merci zariko. </p>
<p>Maintenant il faut que je trouve un moyen de placer &#8220;la fin des zarikos&#8221; dans un blog post.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Zariko</title>
		<link>http://sametmax.com/les-context-managers-et-le-mot-cle-with-en-python/#comment-1698</link>
		<dc:creator><![CDATA[Zariko]]></dc:creator>
		<pubDate>Tue, 04 Sep 2012 11:54:20 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=1987#comment-1698</guid>
		<description><![CDATA[Super article !

Petite typo sur le ContextDecorator: @functools.wraps =&gt; @wraps]]></description>
		<content:encoded><![CDATA[<p>Super article !</p>
<p>Petite typo sur le ContextDecorator: @functools.wraps =&gt; @wraps</p>
]]></content:encoded>
	</item>
</channel>
</rss>

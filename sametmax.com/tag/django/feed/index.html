<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Sam &#38; Max: Python, Django, Git et du cul &#187; django</title>
	<atom:link href="http://sametmax.com/tag/django/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Deux développeurs en vadrouille qui se sortent les doigts du code</description>
	<lastBuildDate>Mon, 02 Dec 2013 10:02:45 +0000</lastBuildDate>
	<language>en</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.3.1</generator>
	<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2F&amp;language=en_US&amp;category=text&amp;title=Sam+%26amp%3B+Max%3A+Python%2C+Django%2C+Git+et+du+cul&amp;description=Deux+d%C3%A9veloppeurs+en+vadrouille+qui+se+sortent+les+doigts+du+code&amp;tags=blog" type="text/html" />
		<item>
		<title>Changer le mot de passe du super utilisateur django en ligne de commande</title>
		<link>http://sametmax.com/changer-le-mot-de-passe-du-super-utilisateur-django-en-ligne-de-commande/</link>
		<comments>http://sametmax.com/changer-le-mot-de-passe-du-super-utilisateur-django-en-ligne-de-commande/#comments</comments>
		<pubDate>Sun, 01 Dec 2013 00:20:18 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[manage.py]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=8020</guid>
		<description><![CDATA[Vous avez oublié ce maudis mot de passe ? Impossible de se connecter à l'admin ?]]></description>
			<content:encoded><![CDATA[<p>Vous avez oublié ce maudit mot de passe ? Impossible de se connecter à l&#8217;admin ?</p>

<div class="wp_syntax"><div class="code"><pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>manage.py changepassword username</pre></div></div>

<p>Pas besoin d&#8217;être root.</p>
<p>Souvenez-vous aussi que vous pouvez quasiment tout faire depuis un shell en faisant :</p>

<div class="wp_syntax"><div class="code"><pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>manage.py shell</pre></div></div>

<p>Ce qui vous permet d&#8217;importer les modèles de vos apps et faire toutes les querys que vous voulez.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8020&amp;md5=30502664a6433d32c395442f20ec728d" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/changer-le-mot-de-passe-du-super-utilisateur-django-en-ligne-de-commande/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fchanger-le-mot-de-passe-du-super-utilisateur-django-en-ligne-de-commande%2F&amp;language=en_GB&amp;category=text&amp;title=Changer+le+mot+de+passe+du+super+utilisateur+django+en+ligne+de+commande&amp;description=Vous+avez+oubli%C3%A9+ce+maudit+mot+de+passe+%3F+Impossible+de+se+connecter+%C3%A0+l%26%238217%3Badmin+%3F+.%2Fmanage.py+changepassword+username+Pas+besoin+d%26%238217%3B%C3%AAtre+root.+Souvenez-vous+aussi+que+vous+pouvez+quasiment+tout...&amp;tags=django%2Cmanage.py%2Cpython%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/12/tumblr_mwz8n9837V1r539hzo1_500.jpg" length="47441" type="image/jpg" />	</item>
		<item>
		<title>Compter les doublons avec l&#8217;ORM Django</title>
		<link>http://sametmax.com/compter-les-doublons-avec-lorm-django/</link>
		<comments>http://sametmax.com/compter-les-doublons-avec-lorm-django/#comments</comments>
		<pubDate>Fri, 22 Nov 2013 08:28:48 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[group by]]></category>
		<category><![CDATA[orm]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=7761</guid>
		<description><![CDATA[<code>GROUP BY </code>et <code>HAVING</code> sont assez peu intuitifs en SQL, et encore moins avec l'ORM Django.]]></description>
			<content:encoded><![CDATA[<p><code>GROUP BY </code>et <code>HAVING</code> sont assez peu intuitifs en SQL, et encore moins avec l&#8217;ORM Django.</p>
<p>Voici donc la recette pour compter le nombre d’occurrences des valeurs d&#8217;un champ, pour par exemple trouver les doublons.</p>
<p>En supposant une table <code>Massage</code> avec une valeur <code>finish</code> :</p>
<pre>
ID         FINISH
1          manuel
2          oral
3          oral
4          oral
</pre>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> Massage.<span style="color: black;">objects</span>.<span style="color: black;">values</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'finish'</span><span style="color: black;">&#41;</span>.<span style="color: black;">annotate</span><span style="color: black;">&#40;</span>count=Count<span style="color: black;">&#40;</span><span style="color: #483d8b;">'id'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
<span style="color: black;">&#123;</span><span style="color: #483d8b;">'manuel'</span>: <span style="color: #ff4500;">2</span>, <span style="color: #483d8b;">'oral'</span>: <span style="color: #483d8b;">'9'</span>: <span style="color: #483d8b;">'rectal'</span>: <span style="color: #ff4500;">1</span>, <span style="color: #483d8b;">'paradoxal'</span>: -<span style="color: #ff4500;">1</span><span style="color: black;">&#125;</span></pre></div></div>

<p>Pour obtenir uniquement les doublons, il suffit de filtrer pour avoir les valeurs qui ont un <code>count</code> plus grand que 1 :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;">Massage.<span style="color: black;">objects</span>.<span style="color: black;">values</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'finish'</span><span style="color: black;">&#41;</span>.<span style="color: black;">annotate</span><span style="color: black;">&#40;</span>count=Count<span style="color: black;">&#40;</span><span style="color: #483d8b;">'id'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>.<span style="color: #008000;">filter</span><span style="color: black;">&#40;</span>count__gt=<span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span></pre></div></div>

 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=7761&amp;md5=70ebd178c4abc22f9fe60ba0f38b5e38" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/compter-les-doublons-avec-lorm-django/feed/</wfw:commentRss>
		<slash:comments>11</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fcompter-les-doublons-avec-lorm-django%2F&amp;language=en_GB&amp;category=text&amp;title=Compter+les+doublons+avec+l%26%238217%3BORM+Django&amp;description=GROUP+BY+et+HAVING+sont+assez+peu+intuitifs+en+SQL%2C+et+encore+moins+avec+l%26%238217%3BORM+Django.+Voici+donc+la+recette+pour+compter+le+nombre+d%E2%80%99occurrences+des+valeurs+d%26%238217%3Bun+champ%2C+pour...&amp;tags=django%2Cgroup+by%2Corm%2Cpython%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/11/91390283.png" length="434902" type="image/jpg" />	</item>
		<item>
		<title>Créer un super utilisateur Django sans prompt</title>
		<link>http://sametmax.com/creer-un-super-utilisateur-django-sans-prompt/</link>
		<comments>http://sametmax.com/creer-un-super-utilisateur-django-sans-prompt/#comments</comments>
		<pubDate>Wed, 20 Nov 2013 09:23:12 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[manage.py]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[superuser]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=7981</guid>
		<description><![CDATA[Automatiser le déploiement d'un projet Django passe par un <code>syncdb</code> sans prompt, et donc pas de création de superutilisateur...]]></description>
			<content:encoded><![CDATA[<p>Automatiser le déploiement d&#8217;un projet Django passe par un <code>syncdb</code> sans prompt, et donc pas de création de superutilisateur :</p>

<div class="wp_syntax"><div class="code"><pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>manage.py syncdb <span style="color: #660033;">--noinput</span></pre></div></div>

<p>Vous pouvez bien entendu toujours en créer un plus tard, avec :</p>

<div class="wp_syntax"><div class="code"><pre class="bash" style="font-family:monospace;">.<span style="color: #000000; font-weight: bold;">/</span>manage.py createsuperuser <span style="color: #660033;">--username</span>=vous <span style="color: #660033;">--email</span>=votre_mail</pre></div></div>

<p>Mais il va vous prompter pour saisir le mot de passe ou alors mettre un mot de passe inutilisable automatiquement, ça ne résout pas votre problème. Une astuce consiste à le créer avec un code Python et à piper ce code dans un shell :</p>

<div class="wp_syntax"><div class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #7a0874; font-weight: bold;">echo</span> <span style="color: #ff0000;">&quot;from django.contrib.auth.models import User; User.objects.filter(username='vous').count() or User.objects.create_superuser('vous', votre_email', 'mot_de_passe')&quot;</span> <span style="color: #000000; font-weight: bold;">|</span> .<span style="color: #000000; font-weight: bold;">/</span>manage.py shell</pre></div></div>

<p>Personnellement je colle ça dans une tache <a href="http://sametmax.com/travailler-moins-pour-gagner-plus-en-15-minutes-avec-python-fabric/">fabric</a>. Parfois on peut même générer le mot de passe aléatoirement avec un <a href="http://sametmax.com/quest-ce-quun-uuid-et-a-quoi-ca-sert/">uuid</a> qui est printé localement.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=7981&amp;md5=5968a2cf4dce21ecfb87305b3e6e8fbd" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/creer-un-super-utilisateur-django-sans-prompt/feed/</wfw:commentRss>
		<slash:comments>5</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fcreer-un-super-utilisateur-django-sans-prompt%2F&amp;language=en_GB&amp;category=text&amp;title=Cr%C3%A9er+un+super+utilisateur+Django+sans+prompt&amp;description=Automatiser+le+d%C3%A9ploiement+d%26%238217%3Bun+projet+Django+passe+par+un+syncdb+sans+prompt%2C+et+donc+pas+de+cr%C3%A9ation+de+superutilisateur+%3A+.%2Fmanage.py+syncdb+--noinput+Vous+pouvez+bien+entendu+toujours+en+cr%C3%A9er...&amp;tags=django%2Cmanage.py%2Cpython%2Csuperuser%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/11/tumblr_mtqsqnbEqM1r539hzo1_500.jpg" length="34248" type="image/jpg" />	</item>
		<item>
		<title>La stack techno qu&#8217;on utilise pour faire un site Web, et pourquoi</title>
		<link>http://sametmax.com/la-stack-techno-quon-utilise-pour-faire-un-site-web-et-pourquoi/</link>
		<comments>http://sametmax.com/la-stack-techno-quon-utilise-pour-faire-un-site-web-et-pourquoi/#comments</comments>
		<pubDate>Mon, 11 Nov 2013 06:40:38 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Administration System]]></category>
		<category><![CDATA[celery]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[fabric]]></category>
		<category><![CDATA[mysql]]></category>
		<category><![CDATA[nginx]]></category>
		<category><![CDATA[nosql]]></category>
		<category><![CDATA[postgres]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[redis]]></category>
		<category><![CDATA[vm]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=7648</guid>
		<description><![CDATA[Une stack techno n'est pas une référence. Il n'y a pas de combo absolu qui rox absolument tout, c'est une question de contexte technique, financier, humain...

Mais c'est vrai que ça aide bien d'avoir sous les yeux les pratiques des autres.]]></description>
			<content:encoded><![CDATA[<p>Une stack techno n&#8217;est pas une référence. Il n&#8217;y a pas de combo absolu qui rox absolument tout, c&#8217;est une question de contexte technique, financier, humain&#8230;</p>
<p>Mais c&#8217;est vrai que ça aide bien d&#8217;avoir sous les yeux les pratiques des autres.</p>
<p>Je ne vais pas expliquer pourquoi Python, <a href="http://sametmax.com/10-raisons-pour-lesquelles-je-suis-toujours-marie-a-python/">je l&#8217;ai déjà fait</a>.</p>
<p>Commençons plutôt par la partie purement Web, pour laquelle on utilise Django, le framework Web Python.</p>
<p>Max et moi avons tout deux fait du PHP avant, j&#8217;ai tâté des frameworks internes, du Symfony et plus tard du Zope. J&#8217;ai regardé du côté de Pyramid et de ses prédécesseurs, et Django est celui qui me plaît le plus. J&#8217;ai juste un peu forcé la main à Max :-)</p>
<p>Car oui, le framework a été avant tout un choix de goût.</p>
<p>Ce n&#8217;est pas un choix de performances : le framework n&#8217;a aucun impact dessus. Aucun. Les architectures ont un impact. Le framework, non. Votre bottleneck sera sur les IO, pas sur le CPU. Le choix de technos asynchrones peut avoir un impact, mais ce n&#8217;est pas une question de framework. Tornado, Twisted ou NodeJS, on s&#8217;en fout. </p>
<p>Donc Django, essentiellement parce qu&#8217;il me plait. Et il me plaît pour ces raisons :</p>
<ul>
<li>Il y a un bon équilibre entre découplage et intégration. En général c&#8217;est soit très découplé et mal intégré, soit très bien intégré et très couplé.</li>
<li>C&#8217;est bien foutu et bien documenté. Et c&#8217;est stable. Vraiment très stable. Les core devs sont hyper sérieux.</li>
<li>C&#8217;est très versatile et ça peut faire plein de trucs out of the box, petits comme gros.</li>
<li>C&#8217;est assez facile à apprendre. Ça reste un framework, donc ce n&#8217;est pas la plus simple des démarches, mais dans le royaume des frameworks de cette taille, ça reste vraiment le plus simple.</li>
<li>La communauté est fantastique : il y a des centaines d&#8217;apps qui couvrent pratiquement tous les besoins.</li>
<li>Et bien entendu, c&#8217;est en Python.</li>
</ul>
<p>En terme de base de données, on a fait du MySQL pendant longtemps. Ça a plutôt bien marché. Maintenant je commence mes nouveaux projets avec PostGres, qui est plus solide. Parfois je fais juste du Sqlite, parce que ça suffit.</p>
<p>Pas de NoSQL. Après plusieurs expériences avec MongoDB et CouchDB, je n&#8217;ai pas été convaincu que les bénéfices dépassaient le coût. Il faudrait un article complet là dessus (qu&#8217;on m&#8217;a d&#8217;ailleurs demandé).</p>
<p>Question OS. c&#8217;est du CentOS avec Max (il a plus l&#8217;habitude) ou du Ubuntu Server pour mes autres projets. Je reste sur les LTS. Ce n&#8217;est pas un choix très réfléchi, c&#8217;est surtout par habitude.</p>
<p>Pas de machine virtuelle. On a essayé, sans y trouver un grand intérêt :</p>
<ul>
<li>Il faut quand même faire des scripts de migration, donc autant s&#8217;en servir pour le déploiement.</li>
<li>On perd en perfs.</li>
<li>Les erreurs liées au mal-fonctionnement d&#8217;une VM sont absolument indébuggable.</li>
<li>Si on ne fait pas la VM soit-même, il faut mettre ses couilles dans les mains d&#8217;un pestataire de service. J&#8217;ai horreur de ça.</li>
<li>Trouver des gens avec la compétence pour gérer une VM, c&#8217;est difficile. Un script de déploiement, c&#8217;est du code que tout dev saura déjà lire. Par extension ça veut dire que je m&#8217;y replonge facilement des semaines plus tard.</li>
</ul>
<p>Et donc pour le déploiement, j&#8217;utilise <a href="http://sametmax.com/travailler-moins-pour-gagner-plus-en-15-minutes-avec-python-fabric/">fabric</a>, avec <a href="https://github.com/ronnix/fabtools/">fabtools</a>.</p>
<p>Ce n&#8217;est pas la solution la plus efficace, d&#8217;autant que ça limite à Python 2.7, mais c&#8217;est la plus simple. C&#8217;est juste du code Python. N&#8217;importe qui peut comprendre le déploiement en 15 minutes. Ça se modifie vite, s&#8217;adapte facilement. </p>
<p>Il faut comprendre qu&#8217;on a jamais plus d&#8217;une dizaine de serveurs pour un projet, ces choix sont donc fait en fonction de cela. Il va sans dire que si vous gérez un parc de centaines de machines, ça ne sera pas du tout le même choix technique. Peut être que Chef ou des VM seront alors carrément plus interressant. Peut être que le NoSQL et sa capacité au scalling sera bien plus rentable.</p>
<p>Il ne s&#8217;agit pas de décrier les technos que nous n&#8217;utilisons pas. Il s&#8217;agit juste de dire, voilà les choix que nous avons fait, dans tel contexte, pour telles (bonnes ou mauvaises) raisons.</p>
<p>Durant les dernières années, on a ajouté <a href="http://redis.io/">Redis</a> à notre stack. C&#8217;est un outil fantastique qui sert à tout : de la base de données pour les trucs simples (il y a des fois ou un schéma est overkill) à la solution de caching. C&#8217;est ce qu&#8217;on a de plus proche du NoSQL.</p>
<p>L&#8217;outil est tellement simple à installer (vraiment le degré zero de la maintenance, c&#8217;est beau) et à utiliser que ça ne vaut juste pas le coup de s&#8217;en priver. </p>
<p>Du coup, plus de memcache. Toutes les grosses requêtes sont sauvegardées dans Redis, dès qu&#8217;on fait un script qui a besoin de persistance temporaire, Redis, pour communiquer entre plusieurs process, Redis, pour toutes les opérations qui ont besoin de grosses perfs comme les stats, Redis. Vive Redis.</p>
<p>D&#8217;ailleurs on utilise Redis aussi comme broker pour notre gestionnaire de queues et de taches : <a href="sametmax.com/files-de-taches-et-taches-recurrentes-avec-celery/">celery</a>. Si vous pythonez, je vous recommande chaudement celery pour toutes les tâches en background, les crawlers, les chaînes de process, etc.</p>
<p>On a aussi du moteur de recherche. Là on tappe dans du <a href="http://lucene.apache.org/solr/">Solr</a> (avec <a href="http://haystacksearch.org/">haystack</a>). C&#8217;est très puissant, en tout cas syntaxiquement car ça ne fait pas de sémantique. Ne vous attendez-donc pas à rattraper Google. Mais c&#8217;est aussi méga chiant à configurer et très lourd. Je pense qu&#8217;un jour on va migrer sur <a href="http://www.elasticsearch.org/">ElasticSearch</a>, mais c&#8217;est pas la priorité. Don&#8217;t fix what ain&#8217;t broken.</p>
<p>Devant tout ça on a <a href="http://nginx.org/">Nginx</a>. Comme beaucoup on a fait Apache => Cherokee => lighttp => nginx. Et franchement, je ne reviendrais jamais en arrière : plus léger, plus rapide, plus facile à installer et à configurer, plus versatile. Nginx fait tout, et mieux. </p>
<p>En proxy on a du <a href="http://gunicorn.org/">gunicorn</a>. Parce qu&#8217;on avait la flemme de configurer uwsgi et qu&#8217;on a pris l&#8217;habitude.</p>
<p>Après on utilise plein de libs, de petits outils, etc. Mais ça c&#8217;est le gros de notre archi.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=7648&amp;md5=a3c473ad94a4298f30d5296cdd292afc" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/la-stack-techno-quon-utilise-pour-faire-un-site-web-et-pourquoi/feed/</wfw:commentRss>
		<slash:comments>25</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fla-stack-techno-quon-utilise-pour-faire-un-site-web-et-pourquoi%2F&amp;language=en_GB&amp;category=text&amp;title=La+stack+techno+qu%26%238217%3Bon+utilise+pour+faire+un+site+Web%2C+et+pourquoi&amp;description=Une+stack+techno+n%26%238217%3Best+pas+une+r%C3%A9f%C3%A9rence.+Il+n%26%238217%3By+a+pas+de+combo+absolu+qui+rox+absolument+tout%2C+c%26%238217%3Best+une+question+de+contexte+technique%2C+financier%2C+humain%26%238230%3B+Mais+c%26%238217%3Best+vrai+que...&amp;tags=celery%2Cdjango%2Cfabric%2Cmysql%2Cnginx%2Cnosql%2Cpostgres%2Cpython%2Credis%2Cvm%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/11/nZ9b9.jpg" length="67160" type="image/jpg" />	</item>
		<item>
		<title>Mise à jour de Django-quicky pour supporter django 1.6</title>
		<link>http://sametmax.com/mise-a-jour-de-django-quicky-pour-supporter-django-1-6/</link>
		<comments>http://sametmax.com/mise-a-jour-de-django-quicky-pour-supporter-django-1-6/#comments</comments>
		<pubDate>Sat, 09 Nov 2013 13:32:23 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[django-quicky]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[settings.py]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=7716</guid>
		<description><![CDATA[Avec Django 1.6 qui vient de sortir hier, j'ai pu m’apercevoir que <a href="http://sametmax.com/django-quicky-labolition-des-preliminaires-par-sam-et-max/">django-quicky</a> ne marchait plus sur cette nouvelle version.]]></description>
			<content:encoded><![CDATA[<p>Avec Django 1.6 qui vient de sortir hier, j&#8217;ai pu m’apercevoir que <a href="http://sametmax.com/django-quicky-labolition-des-preliminaires-par-sam-et-max/">django-quicky</a> ne marchait plus sur cette nouvelle version. Un sombre histoire de <code>setup_environ</code> qui est deprecated. Comme je l&#8217;utilise (ce qui est mieux avec les outils qu&#8217;on code ^^), j&#8217;ai fait un petit correctif vite-fait.</p>
<p>J&#8217;en ai profité aussi pour ajouter deux fichiers de requirements avec des apps Python que j&#8217;installe très très souvent pour mes projets.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=7716&amp;md5=be71a871dc7dfb8dc4e81752048c781e" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/mise-a-jour-de-django-quicky-pour-supporter-django-1-6/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fmise-a-jour-de-django-quicky-pour-supporter-django-1-6%2F&amp;language=en_GB&amp;category=text&amp;title=Mise+%C3%A0+jour+de+Django-quicky+pour+supporter+django+1.6&amp;description=Avec+Django+1.6+qui+vient+de+sortir+hier%2C+j%26%238217%3Bai+pu+m%E2%80%99apercevoir+que+django-quicky+ne+marchait+plus+sur+cette+nouvelle+version.+Un+sombre+histoire+de+setup_environ+qui+est+deprecated.+Comme+je...&amp;tags=django%2Cdjango-quicky%2Cpython%2Csettings.py%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/11/USKO4MA.jpg" length="47847" type="image/jpg" />	</item>
		<item>
		<title>Afficher l&#8217;IP d&#8217;un visiteur &#8211; Django vs Nginx</title>
		<link>http://sametmax.com/afficher-la-vrai-ip-dun-visiteur-django-vs-nginx/</link>
		<comments>http://sametmax.com/afficher-la-vrai-ip-dun-visiteur-django-vs-nginx/#comments</comments>
		<pubDate>Fri, 25 Oct 2013 03:53:30 +0000</pubDate>
		<dc:creator>Max</dc:creator>
				<category><![CDATA[Administration System]]></category>
		<category><![CDATA[Programmation]]></category>
		<category><![CDATA[Web]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[nginx]]></category>
		<category><![CDATA[real ip]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=7525</guid>
		<description><![CDATA[dis moi quelle est ton IP et je te dirais rien.]]></description>
			<content:encoded><![CDATA[<p>Lorsque l&#8217;on veut connaitre son ip on fait souvent appel à des sites du genre: <a href="http://www.whatismyip.com/">whatismyip.com</a>, <a href="http://www.mon-ip.com/">mon-ip.com</a> ou on utilise un ifconfig en ssh.<br />
Des fois on a aussi besoin de connaître l&#8217;ip d&#8217;un visiteur sur son site, 2 petites méthodes pour le faire sous Django et Nginx.</p>
<p><strong>Sous Django:</strong> </p>
<p>Dans l&#8217;<a href="https://docs.djangoproject.com/en/dev/topics/http/urls/">Urlconf</a></p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;">urlpatterns = patterns<span style="color: black;">&#40;</span><span style="color: #483d8b;">''</span>,
    <span style="color: #808080; font-style: italic;"># return client IP</span>
    url<span style="color: black;">&#40;</span>r<span style="color: #483d8b;">'^my_ip$'</span>, get_ip<span style="color: black;">&#41;</span>,
<span style="color: black;">&#41;</span></pre></div></div>

<p>Créez une <a href="https://docs.djangoproject.com/en/dev/topics/http/views/">vue</a> du nom de get_ip qui sera utilisée par l&#8217;urlconf</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">from</span> django <span style="color: #ff7700;font-weight:bold;">import</span> http
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> get_ip<span style="color: black;">&#40;</span>request<span style="color: black;">&#41;</span>:
    <span style="color: #483d8b;">&quot;&quot;&quot;
        Vue qui retourne l'IP du client
    &quot;&quot;&quot;</span>
    <span style="color: #ff7700;font-weight:bold;">try</span>:
&nbsp;
    	<span style="color: #808080; font-style: italic;"># récupère l'ip du client</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> http.<span style="color: black;">HttpResponse</span><span style="color: black;">&#40;</span>request.<span style="color: black;">META</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">&quot;REMOTE_ADDR&quot;</span><span style="color: black;">&#93;</span> <span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">Exception</span>, e:
        <span style="color: #ff7700;font-weight:bold;">return</span> http.<span style="color: black;">HttpResponse</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'error %s'</span> <span style="color: #66cc66;">%</span> e<span style="color: black;">&#41;</span></pre></div></div>

<p>Le code ci-dessus peut retourner l&#8217;adresse locale (127.0.0.1) dans ce cas il faut tester l&#8217;existence de la variable <strong>HTTP_X_REAL_IP</strong>, certains serveurs web ont besoin d&#8217;être <a href="http://rtcamp.com/tutorials/nginx/forwarding-visitors-real-ip/">configuré</a>. </p>
<p><strong>Sous Nginx:</strong></p>
<p>Dans le fichier de configuration de nginx on écrit une nouvelle <a href="http://wiki.nginx.org/HttpCoreModule#location">location</a></p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;"># return client ip</span>
location /my_ip <span style="color: black;">&#123;</span>
    default_type <span style="color: #483d8b;">'text/plain'</span><span style="color: #66cc66;">;</span>
    content_by_lua <span style="color: #483d8b;">'ngx.print(ngx.var.remote_addr)'</span><span style="color: #66cc66;">;</span>
<span style="color: black;">&#125;</span></pre></div></div>

<p>il suffit de se rendre à l&#8217;url http://monsite.com/my_ip pour voir s&#8217;afficher son ip. Cependant il faut avoir nginx compilé avec le module <a href="http://wiki.nginx.org/HttpLuaModule">Lua</a> ce qui peut être délicat si l&#8217;on a jamais compilé d&#8217;application.</p>
<p><strong><br />
Conclusion:</strong></p>
<p>Si l&#8217;on s&#8217;en réfère aux deux exemples ci dessus on serait tenté d&#8217;utiliser Nginx car en une seule ligne tout le bazar est réglé.<br />
Le hic c&#8217;est qu&#8217;il faut que Nginx soit compilé avec le module Lua pour afficher l&#8217;ip (sauf si quelqu&#8217;un connaît une autre façon d&#8217;afficher un message de sortie).<br />
La version Django n&#8217;est pas fiable à 100% car suivant comment est configuré votre serveur web il se peut que vous vous retrouviez avec une ip du genre 127.0.0.1.<br />
Il y a aussi la possibilité de parser le résultat des sites web cités en tout début d&#8217;article, certains proposent des Api je crois mais vous dépendez d&#8217;un autre service (on faisait ça au début) qui peuvent vous lâcher à tout moment (ce qui nous est arrivé).<br />
Personnellement je compile toujours nginx avec Lua et quelques autres modules, ça permet de s&#8217;affranchir de plus en plus du backend.</p>
<p>PS: j&#8217;ai mis à jour le titre car il laissait sous-entendre autre chose (merci à Sébastien)</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=7525&amp;md5=5db442cb353a28e02057726c4e826969" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/afficher-la-vrai-ip-dun-visiteur-django-vs-nginx/feed/</wfw:commentRss>
		<slash:comments>11</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fafficher-la-vrai-ip-dun-visiteur-django-vs-nginx%2F&amp;language=en_GB&amp;category=text&amp;title=Afficher+l%26%238217%3BIP+d%26%238217%3Bun+visiteur+%26%238211%3B+Django+vs+Nginx&amp;description=Lorsque+l%26%238217%3Bon+veut+connaitre+son+ip+on+fait+souvent+appel+%C3%A0+des+sites+du+genre%3A+whatismyip.com%2C+mon-ip.com+ou+on+utilise+un+ifconfig+en+ssh.+Des+fois+on+a+aussi+besoin...&amp;tags=django%2Cnginx%2Creal+ip%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/10/identity.jpg" length="31647" type="image/jpg" />	</item>
		<item>
		<title>Django, une app à la fois : les fichiers statiques</title>
		<link>http://sametmax.com/django-un-app-a-la-fois-les-fichiers-statiques/</link>
		<comments>http://sametmax.com/django-un-app-a-la-fois-les-fichiers-statiques/#comments</comments>
		<pubDate>Sat, 05 Oct 2013 11:14:12 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=7326</guid>
		<description><![CDATA[<pre lang="python">while sam:
    project += 1
</pre>]]></description>
			<content:encoded><![CDATA[<p>On continue avec les <a href="http://sametmax.com/django-une-app-a-la-fois/">applications Django qui démontrent un aspect du framework, avec des sources blindées de commentaires</a>.</p>
<p>Cette fois, c&#8217;est la gestion des fichiers statiques. <a href="https://github.com/sametmax/Django--an-app-at-a-time/tree/fran%C3%A7ais">Chopez le code</a> quand il est encore chaud !</p>
<p>@+</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=7326&amp;md5=6c2fd2ed9a322d44f0ff5bdd5bbd439e" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/django-un-app-a-la-fois-les-fichiers-statiques/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fdjango-un-app-a-la-fois-les-fichiers-statiques%2F&amp;language=en_GB&amp;category=text&amp;title=Django%2C+une+app+%C3%A0+la+fois+%3A+les+fichiers+statiques&amp;description=On+continue+avec+les+applications+Django+qui+d%C3%A9montrent+un+aspect+du+framework%2C+avec+des+sources+blind%C3%A9es+de+commentaires.+Cette+fois%2C+c%26%238217%3Best+la+gestion+des+fichiers+statiques.+Chopez+le+code+quand...&amp;tags=django%2Cpython%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/10/4clNZOJ.jpg" length="36614" type="image/jpg" />	</item>
		<item>
		<title>Mon premier projet Python3</title>
		<link>http://sametmax.com/mon-premier-projet-python3/</link>
		<comments>http://sametmax.com/mon-premier-projet-python3/#comments</comments>
		<pubDate>Thu, 03 Oct 2013 18:37:01 +0000</pubDate>
		<dc:creator>coyote</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[python 3]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=7281</guid>
		<description><![CDATA[Ceci est un post invité de Coyote posté sous licence creative common 3.0 unported. Et oui, il fallait bien que ça arrive. La genèse Bon, ça avait commencé doucement. Il y a de ça quelques temps (avant même l&#8217;article de Sam), j&#8217;avais configuré mon Sublimissime pour qu&#8217;il me force les import du __futur__. Étant moi-même [...]]]></description>
			<content:encoded><![CDATA[<blockquote><p>
Ceci est un post invité de <a href="http://sametmax.com/author/coyote/">Coyote</a> posté sous licence <a href="http://creativecommons.org/licenses/by/3.0/">creative common 3.0 unported</a>.
</p></blockquote>
<p>Et oui, il fallait bien que ça arrive.</p>
<h3>La genèse</h3>
<p>Bon, ça avait commencé doucement. Il y a de ça quelques temps (avant même l&#8217;article de Sam), j&#8217;avais configuré mon Sublimissime pour qu&#8217;il me force les <code>import</code> du <code>__futur__</code>.<br />
Étant moi-même un peu un nazi de la convention de code, ça ne m&#8217;a pas dérangé plus que cela: les keyword <code>print</code> et autres sont pas trop ma tasse de thé. Par contre, c&#8217;est vrai que ça m&#8217;a un peu forcé la main sur les import relatifs, que j&#8217;utilisais visiblement un peu trop.</p>
<p>Récemment, sur un autre projet, je me dis “allez, je passe à la syntaxe <code>"hello {}".format("world")</code> au lieu des <code>"hello" % "world"</code>” puisque c&#8217;est ce qui est désormais recommandé. Bon, c&#8217;est un peu chiant au début mais on s&#8217;y fait vite.</p>
<p>Aussi, j&#8217;ai adopté la suppression des prefix <strong>u</strong> devant les strings. Je sais qu&#8217;avec Python 3.3 on peut à nouveau les utiliser, mais vraiment, j&#8217;ai toujours trouvé ça moche et insupportable, alors je suis <strong>très</strong> content de ne plus avoir à me les farcir.<br />
Que ceux que je vois râler me disent comment ils justifient qu&#8217;avec ce temple de la simplicité et de la lisibilité qu&#8217;est Python, on doivent préfixer toutes nos chaines par des petits <code>u</code> ridicules.</p>
<p>Voilà pour l&#8217;historique, lentement mais surement, je me préparais à prendre peut-être de bonnes habitudes pour le jour (très) lointain ou Python3 deviendrait réalité.</p>
<p>Et c&#8217;est là que mon collègue, un pervers à lunettes, nous propose d&#8217;utiliser PY3 pour de vrai, sur un nouveau projet.</p>
<p>C&#8217;est vrai que le projet s&#8217;y prêtait bien: un petit site web de CRUD avec Django. On s&#8217;est gratté le menton deux minutes et puis on s&#8217;est dit “pourquoi pas ?”.</p>
<h3>Par où commencer ?</h3>
<p>C&#8217;est con hein, mais la première chose que tu fais, c&#8217;est te demander qu&#8217;est ce qui change entre PY2 et PY3.<br />
Et bien la réponse est pas simple du tout et si tu crois que tu vas trouver une URL avec une liste de chose à changer, tu te trompes lourdement.</p>
<p>Le problème est que PY3.0 avait sans doute dû être fini à la pisse et que donc les choses ont beaucoup évoluées entre 3.0, 3.1, 3.2 et 3.3. J&#8217;ai lu beaucoup de posts sans importance sur toutes ces étapes intermédiaires, mais la conclusion, c&#8217;est que grosso-modo, il faut passer de 2.7 à 3.3. Entre les deux, c&#8217;est un peu comme naitre au <a href="https://fr.wikipedia.org/wiki/Sahara_Occidental">Sahara Occidental</a>.</p>
<h3>Installer PY3.3</h3>
<p>Comme on travaille en équipe, on a des setup différents: OSX, Ubuntu 12.04 et Ubuntu 13.04.</p>
<p>Ça c&#8217;est passé sans douleur malgré les appréhensions. Pour Ubuntu, il suffit d&#8217;utiliser le <a href="https://launchpad.net/~fkrull/+archive/deadsnakes">ppa deadsnakes</a>.<br />
Une fois installé, un coup de <em>virtualenv</em> (<code>mkvirtualenv -p /usr/bin/python3.3 monenv3</code>) et c&#8217;est parti.</p>
<h3>Les dépendances</h3>
<p>Comme expliqué plus haut, on a choisi de faire ce projet en PY3 parce qu&#8217;il est petit et sans dépendances ; donc pas très représentatif.<br />
Cependant, on utilise:<br />
<code>Django==1.5.4<br />
South==0.8.2<br />
django-mptt==0.6.0<br />
django-picklefield==0.3.0<br />
numpy==1.7.1<br />
unicodecsv*</code></p>
<p>Aucun problème avec ceux là. On a cru que South nous faisait des misères mais en fait c&#8217;était un import relatif avec un <code>pass</code> de cochon qui foutait la merde (<code>try: from local_settings import * except ImportError: pass</code>.<br />
Donc la leçon ici, c&#8217;est que <strong>les imports relatifs c&#8217;est mal</strong>.</p>
<p>Au niveau des dépendances, on a du se séparer de batbelt. Oui, je parle bien de <a href="https://github.com/sametmax/Bat-belt">sametmax/Bat-Belt</a> qui n&#8217;est pas du tout PY3 proof. Ne pleurez pas, moi aussi j&#8217;ai été très déçu et j&#8217;attends des explications (foireuses, je les vois venir d&#8217;ici).</p>
<p>Bref, comme on utilise batbelt pour presque rien, on a copié honteusement (<a href="https://en.wikipedia.org/wiki/Zlib_License">ou pas</a>) le code nécessaire.</p>
<p>Dernière remarque, vous voyez dans la liste <code>unicodecsv</code>. C&#8217;est un peu tricky puisque PY3 supporte unicode par défaut, le module <code>csv</code> de PY3 fonctionne directement ; et de fait, <code>unicodecsv</code> n&#8217;existe plus. Oui, je me suis fait avoir comme un débutant.<br />
Bref, comme on souhaite aussi supporter PY2 et pas uniquement PY3, on a un beau <code>if PY2: import unicodecsv as csv else: import csv</code>.</p>
<h3>Les problèmes</h3>
<p>Peu nombreux je dois dire et c&#8217;est plutôt encourageant. De tête:</p>
<ul>
<li>Fini les <code>__unicode__()</code> dans les modèles Django.<br />
Pour gérer ce cas à la con, on utilise ce <a href="https://raw.github.com/mitsuhiko/jinja2/master/jinja2/_compat.py">fichier _compat de Jinja2</a>. Je vous encourage à le copier, il défini notamment la variable PY2 pratique pour switcher comme le cas du csv ci-dessus.<br />
Bref, dans ce _compat, il y a un class decorator <code>implements_to_string</code> qui permet de ne définir que <code>__str__()</code> (renvoie de l&#8217;unicode) et le reste est géré automatiquement.<br />Django propose la même chose via <code>django.utils.encoding.python_2_unicode_compatible</code> mais je préfère la toolbox Jinja.</li>
<li>J&#8217;ai parlé dans les dépendances du cas <code>unicodecsv</code>. Ici c&#8217;était le seul, mais clairement dans beaucoup de projet qui manipulent des stream ou des fichiers, il va falloir faire ce genre de combines pour suporter PY2 et PY3.</li>
<li>Un edge case très rigolo (après coup!) avec le <code>django-picklefield</code>. Le field se comportait correctement avec PY3 mais pas avec PY2 et pas dans tous les cas. Du bonheur à <s>tariner</s>déboguer.<br />Pour l&#8217;anecdote: <code><br />
x = MyModel(id=1)<br />
x.picklefield = [1,2,3]<br />
x.save()</p>
<p>x = MyModel(id=2)<br />
x.picklefield = {'a': 1, 'b': 3}<br />
x.save()</code><br />
Ce code fonctionne bien avec PY3, mais avec PY2, le fait de réutiliser le même nom de variable rend le PickleField tout chose et donc il sérialise deux fois la valeur passée. Encore une fois, <strong>la leçon ici est d&#8217;être rigoureux</strong>.</li>
<li>Les fonctions du type <code>dict.keys()</code> et assimilés ne renvoient plus de listes, mais ont été remplacés par leur équivalents générateurs (<code>dict.iterkeys()</code>) et ceux-ci n&#8217;existent plus. Donc un peu de gymnastique syntaxique quand on est habitué à l&#8217;ancienne syntaxe.</li>
<li>Numpy refusait de s&#8217;installer sur certaines versions d&#8217;Ubuntu (je me souviens plus laquelle) car il ne trouvait pas un des headers de Python. C&#8217;est du au fait qu&#8217;il cherche ce header dans le même répertoire que le header précédent alors qu&#8217;il est stocké ailleurs. Un symlink fait l&#8217;affaire.</li>
<li>Enfin, le dernier problème, qui va réveler que <strong>tout ceci n&#8217;est qu&#8217;une imposture</strong>: <code>chaussette</code> et <code>circus</code> que j&#8217;utilise pour le déploiement ne sont pas compatibles PY3 !! Pas de debug ici, ça ne s&#8217;installe même pas. Résulalt: <strong>on a déployé en PY 2.7</strong>. Bon, pour vous consoler (et moi avec), le github de ces 2 projets est plein de commits récents en rapport avec PY3 donc j&#8217;imagine que ça ne saurait tarder.</li>
</ul>
<h3>Conclusion</h3>
<p>Et bien, on a un petit projet développé à plusieurs, en PY3.3, qui est déployé en PY2.7 donc c&#8217;est possible ; on a pas rencontré de grande difficultées donc je pense que pour du web, c&#8217;est pas loin d&#8217;être mûr.</p>
<p><strong>Pas grand chose à dire</strong> finalement, et c&#8217;est sans doute ça le plus important !</p>
<p>Allez bookmarker le site <a href="http://python3porting.com">python3porting</a> qui contient les infos sur ce qui a changé. Ca a l&#8217;air long mais en fait, y&#8217;a beaucoup de cas spécifiques.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=7281&amp;md5=dec3880c1a22a4a73680bebe3f8f04fc" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/mon-premier-projet-python3/feed/</wfw:commentRss>
		<slash:comments>7</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fmon-premier-projet-python3%2F&amp;language=en_GB&amp;category=text&amp;title=Mon+premier+projet+Python3&amp;description=Ceci+est+un+post+invit%C3%A9+de+Coyote+post%C3%A9+sous+licence+creative+common+3.0+unported.+Et+oui%2C+il+fallait+bien+que+%C3%A7a+arrive.+La+gen%C3%A8se+Bon%2C+%C3%A7a+avait+commenc%C3%A9+doucement.+Il...&amp;tags=django%2Cpython%2Cpython+3%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/10/28-manipulations-photographiques-brillantes-qui-vous-feront-rever9.jpg" length="163962" type="image/jpg" />	</item>
		<item>
		<title>Servir les fichiers statiques Django avec un .htaccess Apache</title>
		<link>http://sametmax.com/servir-les-fichiers-statiques-django-avec-un-httaccess-apache/</link>
		<comments>http://sametmax.com/servir-les-fichiers-statiques-django-avec-un-httaccess-apache/#comments</comments>
		<pubDate>Fri, 30 Aug 2013 18:14:43 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Administration System]]></category>
		<category><![CDATA[.httaccess]]></category>
		<category><![CDATA[apache]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[static files]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=7235</guid>
		<description><![CDATA[J'avais fais un giga article pour expliquer <a href="http://sametmax.com/comment-servir-les-fichiers-statiques-avec-django-en-dev-et-en-prod/">comment servir les fichiers statiques Django</a>, mais j'ai réalisé ensuite que les gens n'avaient pas forcément accès aux fichiers de configuration du serveur.]]></description>
			<content:encoded><![CDATA[<p>Servir le Javascript, les images et le CSS avec Django a toujours été une grande question pour les débutants.</p>
<p>J&#8217;avais fais un giga article pour expliquer <a href="http://sametmax.com/comment-servir-les-fichiers-statiques-avec-django-en-dev-et-en-prod/">comment servir les fichiers statiques avec ce framework</a>, mais j&#8217;ai réalisé ensuite que les gens n&#8217;avaient pas forcément accès aux fichiers de configuration du serveur.</p>
<p>Parfois, tout ce qu&#8217;ils ont c&#8217;est un pauvre fichier <em>.htaccess</em>. Tout n&#8217;est pas perdu, avec une petite règle de rewrite :</p>
<pre>AddHandler fcgid-script .fcgi
RewriteEngine On
RewriteRule /static/ /chemin/vers/dossier/racine/apache/static
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ site.fcgi/$1 [QSA,L]</pre>
<p>Attention à ce que <em>/static/</em> corresponde bien à l&#8217;arborescence <strong>complète</strong> de sous dossiers de <em>/chemin/vers/dossier/racine/apache/</em> et à <code>settings.STATIC_ROOT</code>.</p>
<p>Par exemple :</p>
<pre>AddHandler fcgid-script .fcgi
RewriteEngine On
RewriteRule /sous/dossier/static/ /chemin/vers/dossier/racine/apache/sous/dossier/static
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ site.fcgi/$1 [QSA,L]</pre>
<p>Et <code>settings.STATIC_ROOT = "/sous/dossier/static/"</code>.</p>
<p>En effet, on fait un rewrite ici, on ne sert pas le sous dossier directement.</p>
<p>P.S: ça va sans le dire, mais ça va mieux en le disant, c&#8217;est de la prod, donc faut faire un <code>manage.py collecstatic</code> avant, et s&#8217;assurer d&#8217;avoir les bonnes valeurs pour <code>settings.STATIC_ROOT</code> et <code>settings.STATIC_URL</code>/</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=7235&amp;md5=ecd3aa8b126ad5683cd47a723611ae5a" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/servir-les-fichiers-statiques-django-avec-un-httaccess-apache/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fservir-les-fichiers-statiques-django-avec-un-httaccess-apache%2F&amp;language=en_GB&amp;category=text&amp;title=Servir+les+fichiers+statiques+Django+avec+un+.htaccess+Apache&amp;description=Servir+le+Javascript%2C+les+images+et+le+CSS+avec+Django+a+toujours+%C3%A9t%C3%A9+une+grande+question+pour+les+d%C3%A9butants.+J%26%238217%3Bavais+fais+un+giga+article+pour+expliquer+comment+servir+les+fichiers...&amp;tags=.httaccess%2Capache%2Cdjango%2Cpython%2Cstatic+files%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/08/xirtyXE.jpg" length="152901" type="image/jpg" />	</item>
		<item>
		<title>Django, une app à la fois : Outils pour templates</title>
		<link>http://sametmax.com/django-une-app-a-la-fois-outils-pour-templates/</link>
		<comments>http://sametmax.com/django-une-app-a-la-fois-outils-pour-templates/#comments</comments>
		<pubDate>Sun, 18 Aug 2013 19:19:54 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[filters]]></category>
		<category><![CDATA[heritage]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[tags]]></category>
		<category><![CDATA[templates]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=7133</guid>
		<description><![CDATA[Je vous poste la nouvelle app de <a href="http://sametmax.com/django-une-app-a-la-fois/">Django, une app à la fois</a> depuis le Mac Do, parce que c'est le seul truc à avoir un Wifi dans le coin paumé où je me trouve.]]></description>
			<content:encoded><![CDATA[<p>Ouaaa, j&#8217;ai passé la journée sur ce truc. Il y avait beaucoup de texte pour une fois, alors la traduction anglais => français a pris pas mal de temps. C&#8217;est fou ce qu&#8217;on peut faire comme trucs chiants quand on a pas Internet&#8230;</p>
<p>Bref, je vous poste la nouvelle app de <a href="http://sametmax.com/django-une-app-a-la-fois/">Django, une app à la fois</a> depuis le Mac Do, parce que c&#8217;est le seul truc à avoir un Wifi dans le coin paumé où je me trouve.</p>
<p><a href="https://github.com/sametmax/Django--an-app-at-a-time/tree/fran%C3%A7ais">Machez bien, c&#8217;est assez dense.</a></p>
<p>P.S: ouinnnn, ils font plus le wrap chèvre.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=7133&amp;md5=c052a00019c83f11c8bdc3c44809af6a" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/django-une-app-a-la-fois-outils-pour-templates/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fdjango-une-app-a-la-fois-outils-pour-templates%2F&amp;language=en_GB&amp;category=text&amp;title=Django%2C+une+app+%C3%A0+la+fois+%3A+Outils+pour+templates&amp;description=Ouaaa%2C+j%26%238217%3Bai+pass%C3%A9+la+journ%C3%A9e+sur+ce+truc.+Il+y+avait+beaucoup+de+texte+pour+une+fois%2C+alors+la+traduction+anglais+%3D%3E+fran%C3%A7ais+a+pris+pas+mal+de+temps.+C%26%238217%3Best...&amp;tags=django%2Cfilters%2Cheritage%2Cpython%2Ctags%2Ctemplates%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/08/R19eKGa.jpg" length="291257" type="image/jpg" />	</item>
	</channel>
</rss>

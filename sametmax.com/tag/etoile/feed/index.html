<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Sam &#38; Max: Python, Django, Git et du cul &#187; etoile</title>
	<atom:link href="http://sametmax.com/tag/etoile/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Deux développeurs en vadrouille qui se sortent les doigts du code</description>
	<lastBuildDate>Wed, 05 Feb 2014 14:20:37 +0000</lastBuildDate>
	<language>en</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.3.1</generator>
	<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2F&amp;language=en_US&amp;category=text&amp;title=Sam+%26amp%3B+Max%3A+Python%2C+Django%2C+Git+et+du+cul&amp;description=Deux+d%C3%A9veloppeurs+en+vadrouille+qui+se+sortent+les+doigts+du+code&amp;tags=blog" type="text/html" />
		<item>
		<title>L&#8217;opérateur splat (l&#8217;étoile: *) en Python</title>
		<link>http://sametmax.com/operateur-splat-ou-etoile-en-python/</link>
		<comments>http://sametmax.com/operateur-splat-ou-etoile-en-python/#comments</comments>
		<pubDate>Fri, 01 Jun 2012 18:34:59 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[etoile]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[splat]]></category>
		<category><![CDATA[unpacking]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=173</guid>
		<description><![CDATA[L'utilisation du signe étoile (<code>*</code>, dit opérateur "splat") en Python est très simple, mais certains cas sont peu intuitifs. Les nouveaux venus ont souvent besoin d'un peu plus d'explications que ce que donne la doc. Les utilisateurs d'autres langages sont généralement déroutés car ils sont habitués certaines fonctionnalités qu'on ne retrouvent pas en Python. ]]></description>
			<content:encoded><![CDATA[<p>L&#8217;utilisation du signe étoile (<code>*</code>, dit opérateur &#8220;splat&#8221;) en Python est très simple, mais certains cas sont peu intuitifs. Les nouveaux venus ont souvent besoin d&#8217;un peu plus d&#8217;explications que ce que donne la doc. Les utilisateurs d&#8217;autres langages sont généralement déroutés car ils sont habitués certaines fonctionnalités qu&#8217;on ne retrouvent pas en Python. </p>
<h2>Ce que <code>*</code> ne permet pas de faire</h2>
<p>Il n&#8217;y a pas de pointeurs en Python, et les passages par référence sont automatiques. Du coup&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;">mon_objet = MaClasse<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
mon_pointeur = <span style="color: #66cc66;">*</span>mon_objet
ma_valeur = <span style="color: #66cc66;">**</span>mon_pointeur</pre></div></div>

<p>N&#8217;existe pas en Python. On ne peut pas récupérer un pointeur. On ne peut pas choisir si l&#8217;on passe une variable par valeur ou par référence. Tout est automatique et transparent. </p>
<h2>Les usages basiques de <code>*</code></h2>
<p>La multiplication et la puissance fonctionnent comme on l&#8217;attend&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2</span><span style="color: #66cc66;">*</span><span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># multiplier 2 par 3 </span>
<span style="color: #ff4500;">6</span>   
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2</span><span style="color: #66cc66;">**</span><span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># élever 2 à la puissance 3    </span>
<span style="color: #ff4500;">8</span></pre></div></div>

<p>Mais déjà, Python se démarque du lot car l&#8217;opérateur <code>*</code> est surchargé par défaut, et peut s&#8217;appliquer aux chaînes de caractères et aux listes. Pour les chaînes, c&#8217;est simple&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;a&quot;</span> <span style="color: #66cc66;">*</span> <span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># on peut multiplier une chaîne par un nombre, et cela donne une chaîne  </span>
aaa 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;a&quot;</span> <span style="color: #66cc66;">**</span> <span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># ça ne marche pas avec les puissances </span>
<span style="color: #008000;">TypeError</span>: unsupported operand <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>s<span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">for</span> <span style="color: #66cc66;">**</span> <span style="color: #ff7700;font-weight:bold;">or</span> <span style="color: #008000;">pow</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>: <span style="color: #483d8b;">'str'</span> <span style="color: #ff7700;font-weight:bold;">and</span> <span style="color: #483d8b;">'int'</span></pre></div></div>

<p>Pour les listes, c&#8217;est plus subtile. Une liste de nombres se multiplie sans y penser&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> l = <span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span>   
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>l <span style="color: #66cc66;">*</span> <span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>   
 <span style="color: #808080; font-style: italic;"># on peut multiplier une liste par un nombre, cela donne une liste </span>
<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">3</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">3</span><span style="color: black;">&#93;</span>  
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>l <span style="color: #66cc66;">**</span> <span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>  
 <span style="color: #808080; font-style: italic;"># ça ne marche pas avec les puissances </span>
<span style="color: #008000;">TypeError</span>: unsupported operand <span style="color: #008000;">type</span><span style="color: black;">&#40;</span>s<span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">for</span> <span style="color: #66cc66;">**</span> <span style="color: #ff7700;font-weight:bold;">or</span> <span style="color: #008000;">pow</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>: <span style="color: #483d8b;">'list'</span> <span style="color: #ff7700;font-weight:bold;">and</span> <span style="color: #483d8b;">'int'</span></pre></div></div>

<p>En revanche, <strong>multiplier une liste d&#8217;objets modifiables ne fait que répéter la référence vers cet objet</strong>&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> l = <span style="color: black;">&#91;</span><span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><span style="color: black;">&#93;</span>    
 <span style="color: #808080; font-style: italic;"># on fait une liste contenant un dictionnaire  </span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> dicos = l <span style="color: #66cc66;">*</span> <span style="color: #ff4500;">3</span>  
 <span style="color: #808080; font-style: italic;"># on peut multiplier une liste par un nombre, cela donne une liste </span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>dicos<span style="color: black;">&#41;</span>   
<span style="color: black;">&#91;</span><span style="color: black;">&#123;</span><span style="color: black;">&#125;</span>, <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span>, <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span><span style="color: black;">&#93;</span></pre></div></div>

<p>On a l&#8217;impression que le comportement est le même que précédemment, <strong">en fait pas du tout</strong>. Ici on a pas une liste de 3 dictionnaires, mais une liste de 3 références vers le même dictionnaire. Si on modifie le premier élément de la liste, tous sont modifiés&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> d = dicos<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span> <span style="color: #808080; font-style: italic;"># on récupère ce qu'on croit être le premier dictionnaire    </span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> d<span style="color: black;">&#91;</span><span style="color: #483d8b;">&quot;Nouvelle cle&quot;</span><span style="color: black;">&#93;</span> = <span style="color: #483d8b;">&quot;Nouvelle valeur&quot;</span> <span style="color: #808080; font-style: italic;"># on le modifie  </span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>dicos<span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># afficher la liste montre que les 3 dictionnaires sont en fait un seul et même objet </span>
<span style="color: black;">&#91;</span><span style="color: black;">&#123;</span><span style="color: #483d8b;">'Nouvelle cle'</span>: <span style="color: #483d8b;">'Nouvelle valeur'</span><span style="color: black;">&#125;</span>,   
 <span style="color: black;">&#123;</span><span style="color: #483d8b;">'Nouvelle cle'</span>: <span style="color: #483d8b;">'Nouvelle valeur'</span><span style="color: black;">&#125;</span>,   
 <span style="color: black;">&#123;</span><span style="color: #483d8b;">'Nouvelle cle'</span>: <span style="color: #483d8b;">'Nouvelle valeur'</span><span style="color: black;">&#125;</span><span style="color: black;">&#93;</span></pre></div></div>

<h2>Unpacking</h2>
<p>Python intègre une fonctionnalité, l&#8217;unpacking, qui permet de prendre chaque élément d&#8217;une séquence et de les attribuer à des variables distinctes, d&#8217;un seul coup. C&#8217;est un raccourcis très pratique&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> drapeau = <span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;bleu&quot;</span>, <span style="color: #483d8b;">&quot;blanc&quot;</span>, <span style="color: #483d8b;">&quot;rouge&quot;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># ici on utilise un tuple, mais ça marche avec les listes   </span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> premiere_couleur = drapeau<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>  
<span style="color: #66cc66;">&gt;&gt;&gt;</span> deuxieme_couleur = drapeau<span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>  
<span style="color: #66cc66;">&gt;&gt;&gt;</span> troisieme_couleur = drapeau<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span> 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>premiere_couleur<span style="color: black;">&#41;</span>    
<span style="color: #483d8b;">'bleu'</span>  
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>deuxieme_couleur<span style="color: black;">&#41;</span>    
<span style="color: #483d8b;">'blanc'</span> 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>troisieme_couleur<span style="color: black;">&#41;</span>   
<span style="color: #483d8b;">'rouge'</span> 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> couleur1, couleur2, couleur3 =  drapeau <span style="color: #808080; font-style: italic;"># la même opération, en une ligne grace à l'unpacking  </span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>couleur1<span style="color: black;">&#41;</span>    
<span style="color: #483d8b;">'bleu'</span>  
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>couleur2<span style="color: black;">&#41;</span>    
<span style="color: #483d8b;">'blanc'</span> 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>couleur3<span style="color: black;">&#41;</span>    
<span style="color: #483d8b;">'rouge'</span></pre></div></div>

<p><strong>Vous n&#8217;avez rien à faire, l&#8217;unpacking est automatique</strong>&nbsp;: il suffit de mettre à gauche du signe <code>=</code> le même nombre de variables qu&#8217;il y a d&#8217;éléments dans la séquence à droite du signe <code>=</code>. Dans le cas contraire, Python râle&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> un, deux = drapeau 
<span style="color: #008000;">ValueError</span>: too many values to unpack   
<span style="color: #66cc66;">&gt;&gt;&gt;</span> un, deux, trois, quatre = drapeau  
<span style="color: #008000;">ValueError</span>: need more than <span style="color: #ff4500;">3</span> values to unpack</pre></div></div>

<p>Quel rapport avec <code>*</code> ? Et bien il permet de <strong>forcer l&#8217;unpacking </strong>dans le cas où c&#8217;est ambigüe. Faisons une petite fonction de test qui ne<br />
fait qu&#8217;afficher chacun de ses paramètres&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">def</span> afficher_trois_elements<span style="color: black;">&#40;</span>elem1, elem2=<span style="color: #008000;">None</span>, elem3=<span style="color: #008000;">None</span><span style="color: black;">&#41;</span>: 
...     <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>elem1<span style="color: black;">&#41;</span>    
...     <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>elem2<span style="color: black;">&#41;</span>    
...     <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>elem3<span style="color: black;">&#41;</span>    
... 
... 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher_trois_elements<span style="color: black;">&#40;</span>drapeau<span style="color: black;">&#41;</span>   
<span style="color: black;">&#40;</span><span style="color: #483d8b;">'bleu'</span>, <span style="color: #483d8b;">'blanc'</span>, <span style="color: #483d8b;">'rouge'</span><span style="color: black;">&#41;</span>  
<span style="color: #008000;">None</span>    
<span style="color: #008000;">None</span></pre></div></div>

<p>Passer drapeau affiche logiquement le tuple comme premier paramètre, et ensuite les valeurs par défaut du premier et du second paramètre. </p>
<p>En utilisant <code>*</code>, nous pouvons forcer l&#8217;unpacking de telle sorte que les valeurs du tuple soient passées individuellement comme autant de paramètres&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher_trois_elements<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span>drapeau<span style="color: black;">&#41;</span>  
bleu    
blanc   
rouge</pre></div></div>

<p>Très pratique quand vous utilisez une collection tout au long du programme pour vous éviter de sans cesse trainer des variables intermédiaires. D&#8217;autant que ça marche combiné aux slices&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> l = <span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">3</span>, <span style="color: #483d8b;">&quot;element que l'on ne veut pas&quot;</span><span style="color: black;">&#93;</span>   
<span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher_trois_elements<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span>l<span style="color: black;">&#91;</span>:-<span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span>   
<span style="color: #ff4500;">1</span>   
<span style="color: #ff4500;">2</span>   
<span style="color: #ff4500;">3</span></pre></div></div>

<p>Encore mieux, on peut utiliser <code>**</code> pour forcer l&#8217;unpacking des dictionnaires. Les valeurs du dictionnaires deviennent les valeurs des paramètres, mais cette association se fait par nom&nbsp;: <strong>chaque clé du dictionnaire doit correspondre à un nom de paramètre</strong>. Ainsi&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> elements = <span style="color: black;">&#123;</span><span style="color: #483d8b;">&quot;elem1&quot;</span>: <span style="color: #483d8b;">&quot;eau&quot;</span>, <span style="color: #483d8b;">&quot;elem2&quot;</span>: <span style="color: #483d8b;">&quot;feu&quot;</span>, <span style="color: #483d8b;">&quot;elem3&quot;</span>: <span style="color: #483d8b;">&quot;air&quot;</span><span style="color: black;">&#125;</span>    
 <span style="color: #808080; font-style: italic;"># les clés ont le bon nom  </span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher_trois_elements<span style="color: black;">&#40;</span><span style="color: #66cc66;">**</span>elements<span style="color: black;">&#41;</span>    
eau 
feu 
air</pre></div></div>

<p>Si une clé ne possède pas le nom adéquat, tout plante&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> elements = <span style="color: black;">&#123;</span><span style="color: #483d8b;">&quot;elem1&quot;</span>: <span style="color: #483d8b;">&quot;eau&quot;</span>, <span style="color: #483d8b;">&quot;elem2&quot;</span>: <span style="color: #483d8b;">&quot;feu&quot;</span>, <span style="color: #483d8b;">&quot;rien_a_voir&quot;</span>: <span style="color: #483d8b;">&quot;air&quot;</span><span style="color: black;">&#125;</span>    
<span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher_trois_elements<span style="color: black;">&#40;</span><span style="color: #66cc66;">**</span>elements<span style="color: black;">&#41;</span>    
<span style="color: #008000;">TypeError</span>: afficher_trois_elements<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> got an unexpected <span style="color: #dc143c;">keyword</span> argument <span style="color: #483d8b;">'rien_a_voir'</span></pre></div></div>

<p>Une autre erreur courante est d&#8217;utiliser <code>*</code> avec un dictionnaire. Dans ce cas l&#8217;unpacking fonctionne, mais comme itérer sur une dictionnaire donne une liste de clés, c&#8217;est comme si vous passiez une liste en paramètres contenant les clés&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> elements = <span style="color: black;">&#123;</span><span style="color: #483d8b;">&quot;elem1&quot;</span>: <span style="color: #483d8b;">&quot;eau&quot;</span>, <span style="color: #483d8b;">&quot;elem2&quot;</span>: <span style="color: #483d8b;">&quot;feu&quot;</span>, <span style="color: #483d8b;">&quot;elem3&quot;</span><span style="color: #66cc66;">;</span>: <span style="color: #483d8b;">&quot;air&quot;</span><span style="color: black;">&#125;</span> 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher_trois_elements<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span>elements<span style="color: black;">&#41;</span> 
elem2   
elem3   
elem1</pre></div></div>

<p>Si vous donnez moins de valeurs qu&#8217;il n&#8217;y a de paramètres, Python remplit tout ce qu&#8217;il peut&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher_trois_elements<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span>drapeau<span style="color: black;">&#91;</span>:-<span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span>  
bleu    
blanc   
<span style="color: #008000;">None</span>    
<span style="color: #66cc66;">&gt;&gt;&gt;</span> elements = <span style="color: black;">&#123;</span><span style="color: #483d8b;">&quot;elem1&quot;</span>: <span style="color: #483d8b;">&quot;eau&quot;</span><span style="color: black;">&#125;</span>   
<span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher_trois_elements<span style="color: black;">&#40;</span><span style="color: #66cc66;">**</span>elements<span style="color: black;">&#41;</span>    
eau 
<span style="color: #008000;">None</span>    
<span style="color: #008000;">None</span></pre></div></div>

<p>Dans le cas inverse – si i il y a plus d&#8217;élements que de paramètres – Python vous envoie vous brosser&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> forces = <span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;rouge&quot;</span>, <span style="color: #483d8b;">&quot;bleu&quot;</span>, <span style="color: #483d8b;">&quot;jaune&quot;</span>, <span style="color: #483d8b;">&quot;rose&quot;</span>, <span style="color: #483d8b;">&quot;vert&quot;</span><span style="color: black;">&#41;</span>   
<span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher_trois_elements<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span>forces<span style="color: black;">&#41;</span>   
<span style="color: #008000;">TypeError</span>: afficher_trois_elements<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> takes at most <span style="color: #ff4500;">3</span> arguments <span style="color: black;">&#40;</span><span style="color: #ff4500;">5</span> given<span style="color: black;">&#41;</span></pre></div></div>

<h2>Paramétrage dynamique</h2>
<p>Il est parfois pratique de définir une fonction qui accepte un nombre infini d&#8217;arguments. Exemple bidon, une fonction qui multiplie ses arguments entre eux&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">def</span> multiply<span style="color: black;">&#40;</span>a, b<span style="color: black;">&#41;</span>:    
...     <span style="color: #ff7700;font-weight:bold;">return</span> a <span style="color: #66cc66;">*</span> b <span style="color: #808080; font-style: italic;"># attention, là on utilise &lt;code&gt;*&lt;/code&gt; pour multiplier, ne cherchez rien de compliqué ;-)    </span>
... 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>multiply<span style="color: black;">&#40;</span><span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>  
<span style="color: #ff4500;">6</span></pre></div></div>

<p>Bien sûr, si on veut rajouter un troisième paramètre, il faut la réécrire. Pareil pour un quatrième. Finalement, on finit par demander de passer une liste pour permettre un nombre arbitraire&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">def</span> multiply<span style="color: black;">&#40;</span>elements_a_multiplier<span style="color: black;">&#41;</span>:  
...     <span style="color: black;">res</span> = <span style="color: #ff4500;">1</span> 
...     <span style="color: #ff7700;font-weight:bold;">for</span> i <span style="color: #ff7700;font-weight:bold;">in</span> elements_a_multiplier: 
...         <span style="color: black;">res</span> = res <span style="color: #66cc66;">*</span> i   
...     <span style="color: #ff7700;font-weight:bold;">return</span> res  
... 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> multiply<span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">3</span>, <span style="color: #ff4500;">4</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> 
<span style="color: #ff4500;">24</span></pre></div></div>

<p>Et bien sachez qu&#8217;il existe une autre possibilité, autoriser le passage d&#8217;une infinité de paramètres ! Cela se fait bien sur avec <code>*</code>.</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">def</span> multiply<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span>tous_les_elements<span style="color: black;">&#41;</span>: <span style="color: #808080; font-style: italic;"># on ne change pas grand chose, on rajoute juste &lt;code&gt;*&lt;/code&gt;   </span>
...     <span style="color: black;">res</span> = <span style="color: #ff4500;">1</span> 
...     <span style="color: #ff7700;font-weight:bold;">for</span> i <span style="color: #ff7700;font-weight:bold;">in</span> tous_les_elements<span style="color: black;">&#41;</span>:    
...         <span style="color: black;">res</span> = res <span style="color: #66cc66;">*</span> i   
...     <span style="color: #ff7700;font-weight:bold;">return</span> res  
... 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> multiply<span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span>  
 <span style="color: #808080; font-style: italic;"># mais plus besoin d'une séquence !    </span>
<span style="color: #ff4500;">26</span>  
<span style="color: #66cc66;">&gt;&gt;&gt;</span> multiply<span style="color: black;">&#40;</span><span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">3</span>, <span style="color: #ff4500;">4</span>, <span style="color: #ff4500;">5</span><span style="color: black;">&#41;</span>    
<span style="color: #ff4500;">120</span></pre></div></div>

<p>Comment ça marche ? C&#8217;est simple, <strong>tous les arguments sont automatiquement stockés dans une liste</strong>, et cette liste est le paramètre que l&#8217;on a désigné par <code>*</code>. </p>
<p>Ce système très puissant peut être utilisé conjointement avec des paramètres normaux&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span>def afficher<span style="color: black;">&#40;</span>elem1, elem2, <span style="color: #66cc66;">*</span>elemx<span style="color: black;">&#41;</span>:  
...    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>elem1<span style="color: black;">&#41;</span> 
...    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>elem2<span style="color: black;">&#41;</span> 
...    <span style="color: #ff7700;font-weight:bold;">for</span> e <span style="color: #ff7700;font-weight:bold;">in</span> elemx: 
...        <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;(*) %s&quot;</span> <span style="color: #66cc66;">%</span> e<span style="color: black;">&#41;</span>  
…   
<span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;Toi&quot;</span>, <span style="color: #483d8b;">&quot;Moi&quot;</span>, <span style="color: #483d8b;">&quot;Luke&quot;</span>, <span style="color: #483d8b;">&quot;Anakin&quot;</span>, <span style="color: #483d8b;">&quot;Obi Wan&quot;</span>, <span style="color: #483d8b;">&quot;Robert&quot;</span><span style="color: black;">&#41;</span>  
Toi 
Moi 
<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span><span style="color: black;">&#41;</span> Luke    
<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span><span style="color: black;">&#41;</span> Anakin  
<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span><span style="color: black;">&#41;</span> Obi Wan 
<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span><span style="color: black;">&#41;</span> Robert</pre></div></div>

<p>La seule condition est de mettre <code>*</code> sur un paramètre situé après tous les autres. <code>*</code> est toujours en dernier, et il n&#8217;apparait qu&#8217;une seule fois. Enfin, il existe une convention pour le nom de cet argument&nbsp;: <code>*args</code>. </p>
<p>Bonne nouvelle, on peut utiliser aussi <code>**</code>. Comme on peut s&#8217;y attendre, il permet de récupérer aussi une infinité de paramètres, mais <strong>sous forme de dictionnaire</strong>. Cela signifie qu&#8217;il ne récupère que les paramètres nommés&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">def</span> afficher_recette<span style="color: black;">&#40;</span>recette, <span style="color: #66cc66;">**</span>ingredients<span style="color: black;">&#41;</span>: <span style="color: #808080; font-style: italic;"># ingrédients sera un dictionnaire    </span>
...     <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>recette<span style="color: black;">&#41;</span>  
...     <span style="color: #ff7700;font-weight:bold;">for</span> ingredient <span style="color: #ff7700;font-weight:bold;">in</span> ingredients.<span style="color: black;">iteritems</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:  
...         <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: #483d8b;">&quot; - %s: %s&quot;</span> <span style="color: #66cc66;">%</span> ingredient 
... 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> afficher_recette<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;moukraines à la glaviouse&quot;</span>,  
...                  <span style="color: black;">creme</span>=<span style="color: #483d8b;">&quot;trop&quot;</span>, <span style="color: #808080; font-style: italic;"># on doit donner le nom de ce paramètre   </span>
...                  <span style="color: black;">moukraines</span>= <span style="color: #483d8b;">&quot;suffisamment&quot;</span>, 
...                  <span style="color: black;">glaviouse</span>=<span style="color: #483d8b;">&quot;si disponible&quot;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># mais l'ordre des paramètres importe peu    </span>
moukraines à la glaviouse   
 - glaviouse : si disponible    
 - creme : trop 
 - moukraines : suffisamment</pre></div></div>

<p>Il faut également mettre <code>**</code> après tous les autres arguments. La convention pour nommer ce paramètre est <code>**kwargs</code>, pour « keyword arguments ». Enfin, on peut mélanger tout ça d&#8217;un coup&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">def</span> affichage_hybride<span style="color: black;">&#40;</span>parametre_normal,    
...                       <span style="color: black;">parametre_avec_default</span>=<span style="color: #483d8b;">&quot;valeur par défaut&quot;</span>,   
...                       <span style="color: #66cc66;">*</span>args,    
...                       <span style="color: #66cc66;">**</span>kwargs<span style="color: black;">&#41;</span>:    
...     <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>parametre_normal<span style="color: black;">&#41;</span> 
...     <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>parametre_avec_default<span style="color: black;">&#41;</span>   
...     <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>args<span style="color: black;">&#41;</span> 
...     <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>kwargs<span style="color: black;">&#41;</span>   
... 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> affichage_hybride<span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;param1&quot;</span>, <span style="color: #483d8b;">&quot;param2&quot;</span>, <span style="color: #483d8b;">&quot;infini1&quot;</span>, <span style="color: #483d8b;">&quot;infini2&quot;</span>, kwinfini1=<span style="color: #ff4500;">1</span>, kwinfini2=<span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>  
param1  
param2  
<span style="color: black;">&#40;</span><span style="color: #483d8b;">'infini1'</span>, <span style="color: #483d8b;">'infini2'</span><span style="color: black;">&#41;</span>  
<span style="color: black;">&#123;</span><span style="color: #483d8b;">'kwinfini1'</span>: <span style="color: #ff4500;">1</span>, <span style="color: #483d8b;">'kwinfini2'</span>: <span style="color: #ff4500;">2</span><span style="color: black;">&#125;</span></pre></div></div>

<p><strong>On doit absolument mettre les paramètres dans cet ordre</strong>&nbsp;:   </p>
<ol>
<li>paramètres normaux et obligatoires;
  </li>
<li>paramètres normaux facultatifs (valeur par défaut);
  </li>
<li>paramètres dynamiques;</li>
<li>paramètres dynamiques nommés.
</li>
</ol>
<p>En plus, cela permet en effet de faire jouer les valeurs par défaut de manière très souple&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="c" style="font-family:monospace;"><span style="color: #339933;">&gt;&gt;&gt;</span> affichage_hybride<span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;param tout seul&quot;</span><span style="color: #009900;">&#41;</span>    
param tout seul 
valeur par défaut   
<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>  
<span style="color: #009900;">&#123;</span><span style="color: #009900;">&#125;</span></pre></div></div>

<p>Si vous vous sentez à l&#8217;aise avec tout ça, vous pouvez mélanger plusieurs usages de <code>*</code> d&#8217;un coup. Je vous laisse donc en guise de conclusion un petit combo qui utilise un code précédent&nbsp;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">def</span> multiply<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span>args<span style="color: black;">&#41;</span>:   
...     <span style="color: black;">res</span> = <span style="color: #ff4500;">1</span> 
...     <span style="color: #ff7700;font-weight:bold;">for</span> i <span style="color: #ff7700;font-weight:bold;">in</span> elements_a_multiplier: 
...         <span style="color: black;">res</span> = res <span style="color: #66cc66;">*</span> i   
...     <span style="color: #ff7700;font-weight:bold;">return</span> res  
... 
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>multiply<span style="color: black;">&#40;</span><span style="color: #66cc66;">*</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">*</span><span style="color: #ff4500;">6</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> == <span style="color: #ff4500;">2</span><span style="color: #66cc66;">**</span><span style="color: #ff4500;">6</span><span style="color: black;">&#41;</span>  
<span style="color: #008000;">True</span></pre></div></div>

 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=173&amp;md5=84b006ae43a7e1abd9982de15435aa84" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/operateur-splat-ou-etoile-en-python/feed/</wfw:commentRss>
		<slash:comments>21</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Foperateur-splat-ou-etoile-en-python%2F&amp;language=en_GB&amp;category=text&amp;title=L%26%238217%3Bop%C3%A9rateur+splat+%28l%26%238217%3B%C3%A9toile%3A+%2A%29+en+Python&amp;description=L%26%238217%3Butilisation+du+signe+%C3%A9toile+%28%2A%2C+dit+op%C3%A9rateur+%26%238220%3Bsplat%26%238221%3B%29+en+Python+est+tr%C3%A8s+simple%2C+mais+certains+cas+sont+peu+intuitifs.+Les+nouveaux+venus+ont+souvent+besoin+d%26%238217%3Bun+peu+plus+d%26%238217%3Bexplications+que...&amp;tags=etoile%2Cpython%2Csplat%2Cunpacking%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2012/06/images.jpeg" length="7655" type="image/jpg" />	</item>
	</channel>
</rss>

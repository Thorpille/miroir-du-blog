<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Sam &#38; Max: Python, Django, Git et du cul &#187; best practice</title>
	<atom:link href="http://sametmax.com/tag/best-practice/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Deux développeurs en vadrouille qui se sortent les doigts du code</description>
	<lastBuildDate>Wed, 05 Feb 2014 14:20:37 +0000</lastBuildDate>
	<language>en</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.3.1</generator>
	<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2F&amp;language=en_US&amp;category=text&amp;title=Sam+%26amp%3B+Max%3A+Python%2C+Django%2C+Git+et+du+cul&amp;description=Deux+d%C3%A9veloppeurs+en+vadrouille+qui+se+sortent+les+doigts+du+code&amp;tags=blog" type="text/html" />
		<item>
		<title>Exemples de bons codes Python</title>
		<link>http://sametmax.com/exemples-de-bons-codes-python/</link>
		<comments>http://sametmax.com/exemples-de-bons-codes-python/#comments</comments>
		<pubDate>Tue, 26 Feb 2013 09:47:56 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[best practice]]></category>
		<category><![CDATA[python]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=5127</guid>
		<description><![CDATA[Réponse à un mail qui demande des exemples de bons codes]]></description>
			<content:encoded><![CDATA[<p>Yeah, on a des fannnnnnns !</p>
<blockquote><p>Ça fait quelques semaines que je me suis mis à python. J&#8217;ai commencé par des scripts (tendance sysadmin oblige) puis je me suis lancé dans des choses un (petit) peu plus importantes, notamment influencé par les cours sur la POO. Je tiens d&#8217;ailleurs à vous féliciter sur ce point, même le site du zéro n&#8217;avait jamais réussi à me les faire vraiment comprendre. Et donc, comme tout débutant qui se respecte j&#8217;essaie de faire de mon petit programme un chef d&#8217;œuvre de perfection (et il y a du boulot).</p>
<p>Le truc, c&#8217;est que je ne connais rien aux bonnes pratiques en python (comment commenter utilement les fonctions, les conventions de nommage, les jolies façons de coder, etc&#8230;). Je suis à la recherche d&#8217;exemples sûrs.</p>
<p>Connaissez-vous des librairies ou applications au code exemplaire dont je pourrais m&#8217;inspirer tant au niveau du code lui-même que de l&#8217;API ou de la doc ?</p>
<p>(Allez, vous devez bien en avoir à l&#8217;esprit ^^)</p>
<p>Bref, merci (si c&#8217;est pas pour ça c&#8217;est pour le reste) et bonne soirée !</p></blockquote>
<p>Cher [censored],</p>
<p>Être placé au dessus du site du zéro provoque chez moi une érection incontrôlée. Merci.</p>
<p>Bonne nouvelle, il n&#8217;existe rien de tel que le code parfait, et des tas d&#8217;excellents dev font de la merde quotidiennement, ce qui permet de relativiser face à son niveau.</p>
<p>Maintenant, si je devais donner des exemples de code et doc dont on peut s&#8217;inspirer, je dirais :</p>
<ul>
<li>les modules <a href="https://github.com/sametmax/Bat-belt/blob/master/batbelt/strings.py">strings</a> et <a href="https://github.com/sametmax/Bat-belt/blob/master/batbelt/structs.py">structs</a> de batbelt sont faciles pour commencer et propres. Le reste est moins bon car la lib est encore en alpha (mais intéressante si tu as le temps) et il n&#8217;y a pas de doc. La <a href="https://0bin.readthedocs.org/en/latest/">doc</a> de zerobin en revanche est très bonne pour les utilisateurs (mais le code, bien que pas mauvais, n&#8217;est pas un exemple de best practice).</li>
<li><a href="https://github.com/jaraco/path.py">path.py</a> a un code est très accessible qui tient dans un seul fichier, mais on peut passer beaucoup de temps dessus. Il est plein de subtilités. Les tests unitaires aussi sont simples à aborder.</li>
<li><a href="https://github.com/coleifer/peewee/blob/master/peewee.py">peewee</a> a un code compliqué et abstrait mais très propre. Bien si on veut travailler ses connaissances sur l&#8217;architecture de code.</li>
<li> <a href="https://github.com/kennethreitz/requests">requests</a>. Niveau avancé, mais très abordable pour un si gros projet. Excellent pour voir comment s&#8217;articule un gros truc en plein de tout petits morceaux bien techniques. La doc technique est d&#8217;un bon niveau.</li>
<li>bottle : ne regarde surtout pas le code. Mais leur <a href="http://bottlepy.org/docs/dev/">doc technique</a> est exceptionelle.</li>
<li>le module CSV de la lib standard. Il est dans ton install Python (chez moi dans /usr/lib/python2.7/csv.py). Pas mal pour voir comment ça marche en interne, et c&#8217;est un petit module pas prise de tête. Ça permet aussi de voir que ceux qui suivent les meilleurs pratiques sont pas forcément ceux qui les prêchent.</li>
</ul>
<p>Petit rappel ceci dit : même un bon code a toujours des lacunes. Si tu prends n&#8217;importe quel bout de ces libs et le mets sur un forum, tu auras toujours un râleur pour venir débattre sur ce qu&#8217;il aurait valu mieux faire.</p>
<p>De plus, d&#8217;une manière générale, les gens qui publient de bons code font des trucs un peu plus compliqués qu&#8217;un simple script. Donc tu auras toujours à froncer un peu les sourcils pour comprendre. C&#8217;est normal, ne perd pas courage.</p>
<p>A éviter niveau code : django, bottle, twisted et les frameworks web en général. Les gros projets avec des bindings C de types sqlalchemy, qt, wx , etc. Car là on rentre dans un autre monde.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=5127&amp;md5=c43159b2b3c9b31e25e96435c35b9e9d" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/exemples-de-bons-codes-python/feed/</wfw:commentRss>
		<slash:comments>26</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fexemples-de-bons-codes-python%2F&amp;language=en_GB&amp;category=text&amp;title=Exemples+de+bons+codes+Python&amp;description=Yeah%2C+on+a+des+fannnnnnns+%21+%C3%87a+fait+quelques+semaines+que+je+me+suis+mis+%C3%A0+python.+J%26%238217%3Bai+commenc%C3%A9+par+des+scripts+%28tendance+sysadmin+oblige%29+puis+je+me+suis+lanc%C3%A9...&amp;tags=best+practice%2Cpython%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/02/wtfm_cf7237e5-a580-4e22-a42a-f8597dd6c60b.jpg" length="47542" type="image/jpg" />	</item>
		<item>
		<title>La fonction anonyme appelée immédiatement en Javascript: (function())()</title>
		<link>http://sametmax.com/la-fonction-anonyme-appelee-immediatement-en-javascript-function/</link>
		<comments>http://sametmax.com/la-fonction-anonyme-appelee-immediatement-en-javascript-function/#comments</comments>
		<pubDate>Wed, 02 Jan 2013 17:09:13 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[best practice]]></category>
		<category><![CDATA[javascript]]></category>
		<category><![CDATA[lambda]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=3979</guid>
		<description><![CDATA[Javascript est un langage qui a plein d'idiomes bien à lui. En effet, c'est un langage très puissant, et ausi plein de couilles velues planquées ici et là. Les ninjas JS ont donc créée des astuces pour pallier à ces problèmes, en utilisant la force de leur outil.

Un des gros soucis en JS, c'est qu'il dépend beaucoup des variables globales, qui sont une grosse source d'ennuis en tout genre. Et il est très facile de déclarer ou d'utiliser une variable globale par erreur.

Pour limiter ce problème, on utiliser la technique de la fonction anonyme immédiatement appelée.]]></description>
			<content:encoded><![CDATA[<p>Javascript est un langage qui a plein d&#8217;idiomes bien à lui. En effet, c&#8217;est un langage très puissant, et ausi plein de couilles velues planquées ici et là. Les ninjas JS ont donc créée des astuces pour pallier à ces problèmes, en utilisant la force de leur outil.</p>
<p>Un des gros soucis en JS, c&#8217;est qu&#8217;il dépend beaucoup des variables globales, qui sont une grosse source d&#8217;ennuis en tout genre. Et il est très facile de déclarer ou d&#8217;utiliser une variable globale par erreur.</p>
<p>Pour limiter ce problème, on utilise la technique de la <a href="http://sametmax.com/fonctions-anonymes-en-python-ou-lambda/">fonction anonyme</a> immédiatement appelée. Cela fonctionne comme ceci, au lieu de faire:<br />
pre lang=&#8221;javascript&#8221;><br />
    alert(&#8216;rouge&#8217;);
</pre>
<p>On fait:</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'rouge'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span></pre></div></div>

<h2>Explication pas à pas</h2>
<p>En effet, en Javascript on peut créer une fonction sans lui donner de nom. C'est ce qu'on appelle une fonction anonyme:</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'rouge'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span></pre></div></div>

<p>On peut attribuer cette fonction à une variable.</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #003366; font-weight: bold;">var</span> une_variable_qui_passait_par_la <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span> <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'rouge'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span></pre></div></div>

<p>Et derrière on peut appeler la fonction ainsi:</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;">une_variable_qui_passait_par_la<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></div></div>

<p>Mais dans notre cas, on ne met pas la fonction dans une variable, on l'enferme dans des parenthèses, ce qui garde la référence le temps de l'appeler, et on l'appelle. On fait la même chose que précédement en fait, on saute juste une étape :</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span> <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'rouge'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span><span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span></pre></div></div>

<p>La référence à la fonction est perdue, on ne pourra pas l'appeler de nouveau. Mais on s'en branle fortement, on voulait juste l'appeler une fois de toute façon.</p>
<p>Pour rendre le code plus lisible, on le met sur plusieurs lignes:</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'rouge'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #006600; font-style: italic;">/* on éxécute la fonction cash pistache */</span></pre></div></div>

<p>Maintenant pour comprendre ce que ça fait, il faut juste réaliser que le bout de code ci-dessous fait EXACTEMENT la même chose que le bout de code juste au dessus :</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'route'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></div></div>

<p>Car on déclare la fonction, mais on l'éxécute tout de suite. Donc dans les deux cas, au chargement du script, un aura une alerte immédiatement.</p>
<h2>Mais putain si ça fait la même chose, pourquoi tu nous gonfles avec ça ?</h2>
<p>Parceque dans le cas du dessus ça fait la même chose, mais ça a des propriétés en plus. Vous vous doutez bien qu'on tape pas 4 lignes en trop pour le plaisir (à part en Java).</p>
<p>En effet, en créant une fonction, on crée un scope. Ainsi, tout ce qui est déclaré avec <code>var</code> dans la fonction sera garanti de ne pas être une variable globale. Pas d'effet de bord sur le monde extérieur. Et le monde extérieur n'a PAS accès aux variables déclarées dans la fonction. Par contre la fonction a accès aux variables globales !</p>
<p>Par exemple, dans un navigateur, vous avez toujours accès à l'objet <code>window</code> et l'objet <code>Date</code> partout dans le code.</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #006600; font-style: italic;">/*
    Ici vous avez accès à window et Date
*/</span>
&nbsp;
<span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
&nbsp;
    <span style="color: #006600; font-style: italic;">/* Ceci ne va pas changer l'objet window en dehors de la fonction
        car on redéclare la variable, à l'intérieur du scope de la fonction.
     */</span>
    <span style="color: #003366; font-weight: bold;">var</span> window <span style="color: #339933;">=</span> <span style="color: #3366CC;">'3.1'</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #003366; font-weight: bold;">var</span> rideau <span style="color: #339933;">=</span> <span style="color: #3366CC;">'vista'</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #009966; font-style: italic;">/* Ici vous avez accès à Date */</span>
&nbsp;
    <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">new</span> Date<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
&nbsp;
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #006600; font-style: italic;">/*
    Ici vous n'avez PAS accès à &quot;rideau&quot;
*/</span></pre></div></div>

<p>Il est donc une bonne pratique de mettre TOUT son script dans une fonction qui s'auto-appelle, pour l'isoler du monde exterieur et ne pas pourrir le namespace global. Si on avait pas fait ça, et qu'un autre script définissait aussi <code>rideau</code>, l'un des deux aurait écrasé l'autre. Et dans tous les cas on aurait écrasé <code>window</code>.</p>
<h2>Encore mieux</h2>
<p>Comme on crée un conteneur isolé, on peut faire ce que l'on veut dedans. Et on a deux moyens de communique avec ce conteneur. D'abord, les variables globales. Ensuite, les paramètres de la fonction auto-appelée.</p>
<p>On peut exposer le contenu de la fonction à travers les variables globales. Par exemple, vous faites un générateur de 'pouet', chose importante s'il en est :</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
&nbsp;
    <span style="color: #009966; font-style: italic;">/* ces variables ne sont pas accessibles depuis l'extérieur */</span>
    <span style="color: #003366; font-weight: bold;">var</span> pouetGenerator <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span><span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
    <span style="color: #003366; font-weight: bold;">var</span> variablePrivee <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #009966; font-style: italic;">/* ces fonctions sont accessibles seulement depuis pouetGenerator */</span>
    pouetGenerator.<span style="color: #660066;">fairePouet</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'pouet'</span><span style="color: #009900;">&#41;</span>
    <span style="color: #009900;">&#125;</span>
&nbsp;
    pouetGenerator.<span style="color: #660066;">nePasFairePouet</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>variablePrivee<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
            <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'pas pouet'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span>
    <span style="color: #009900;">&#125;</span>
&nbsp;
    <span style="color: #009966; font-style: italic;">/* On rend notre pouetGenerator accessible au reste du monde */</span>
    window.<span style="color: #660066;">pouetGenerator</span> <span style="color: #339933;">=</span> pouetGenerator<span style="color: #339933;">;</span>
&nbsp;
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #009966; font-style: italic;">/* On peut utiliser notre générateur de pouet partout ailleurs */</span>
pouetGenerator.<span style="color: #660066;">nePasFairePouet</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span></pre></div></div>

<p>En effet, tout ce qui est attaché à <code>window</code> devient une variable globale dans un navigateur. C'est une caractéristique de Javascript dans un navigateur Web: <code>window</code> est un objet accessible partout, et on a accès partout à ses attributs. On a donc notre code parfaitement isolé (la seule chose exposée c'est notre point d'entrée : <code>pouetGenerator</code>). On ne pollue pas le namespace. En prime personne n'a accès aux variables privées comme <code>variablePrivee</code>;</p>
<p>On peut aussi utiliser les paramètres et les valeurs de retour pour cela :</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #006600; font-style: italic;">/* pouetGenerator, déclaré sans &quot;var&quot;, est une variable globale */</span>
pouetGenerator <span style="color: #339933;">=</span> <span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>chaine_du_pouet<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
&nbsp;
    <span style="color: #009966; font-style: italic;">/* ces variables ne sont pas accessibles depuis l'extérieur */</span>
    <span style="color: #003366; font-weight: bold;">var</span> pouetGenerator <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span><span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
    <span style="color: #003366; font-weight: bold;">var</span> variablePrivee <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">true</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #009966; font-style: italic;">/* ces fonctions sont accessibles seulement depuis pouetGenerator */</span>
    pouetGenerator.<span style="color: #660066;">fairePouet</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span>chaine_du_pouet<span style="color: #009900;">&#41;</span>
    <span style="color: #009900;">&#125;</span>
&nbsp;
    pouetGenerator.<span style="color: #660066;">nePasFairePouet</span> <span style="color: #339933;">=</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
        <span style="color: #000066; font-weight: bold;">if</span> <span style="color: #009900;">&#40;</span>variablePrivee<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
            <span style="color: #000066;">alert</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'pas pouet'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
        <span style="color: #009900;">&#125;</span>
    <span style="color: #009900;">&#125;</span>
&nbsp;
    <span style="color: #006600; font-style: italic;">/* On rend notre pouetGenerator accessible au reste du monde
        en la retournant, ce qui va mettre la référence dans le pouetGenerator
        qui est la variable globale.
    */</span>
    <span style="color: #000066; font-weight: bold;">return</span> pouetGenerator<span style="color: #339933;">;</span>
&nbsp;
<span style="color: #009966; font-style: italic;">/* On passe 'pouet' en paramètre, il va se retrouver dans chaine_du_pouet */</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'pouet'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #009966; font-style: italic;">/* On peut utiliser notre générateur de pouet au même niveau */</span>
pouetGenerator.<span style="color: #660066;">nePasFairePouet</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span></pre></div></div>

<p>Il y a deux différences dans ce code. La première, c'est qu'on met la variable à disposition en la retournant plutôt qu'en l'attachant à <code>document</code>. La seconde, c'est qu'on passe <code>'pouet'</code>.</p>
<p>On pourrait se dire que l'interêt est limité, mais considérez l'exempe suivant:</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>$<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
    $<span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'p'</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">css</span><span style="color: #009900;">&#40;</span><span style="color: #3366CC;">'color'</span><span style="color: #339933;">,</span> <span style="color: #3366CC;">'rouge-fluo'</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span>jQuery.<span style="color: #660066;">noConflic</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span></pre></div></div>

<p><code>jQuery.noConflic()</code> restaure <code>$</code> à sa valeur précédente, permettant à d'autres libs d'utiliser <code>$</code> (comme la lib <em>prototype.js</em>). Mais <code>jQuery.noConflic()</code> retourne aussi l'objet <code>jQuery</code>, que l'on passe en paramètre. Ce paramètre est nommé <code>$</code> dans la signature de la fonction. Dans notre fonction, on peut donc QUAND MÊME utiliser <code>$</code> pour faire référence à <code>jQuery</code> car tout ce qui est dans la fonction est isolée du reste du monde. Et le reste du monde peut utiliser <code>$</code> pour autre chose que <code>jQuery</code>.</p>
<h2>Best practice</h2>
<p>Généralement un code de production pour un script complet ressemble donc à ça:</p>

<div class="wp_syntax"><div class="code"><pre class="javascript" style="font-family:monospace;"><span style="color: #339933;">;</span><span style="color: #009900;">&#40;</span><span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>alias<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
<span style="color: #3366CC;">&quot;use strict&quot;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #009966; font-style: italic;">/* tout le code du script va ici */</span>
&nbsp;
<span style="color: #003366; font-weight: bold;">var</span> une_variable_privee<span style="color: #339933;">;</span>
&nbsp;
window.<span style="color: #660066;">une_variable_exposee</span> <span style="color: #339933;">=</span> <span style="color: #3366CC;">'foo'</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#40;</span>truc_a_aliaser<span style="color: #009900;">&#41;</span></pre></div></div>

<p>Notez le <code>;</code> au début qui permet de rajouter votre script à la suite d'un autre script même si celui-ci a  oublié de mettre un <code>;</code> sur sa dernière ligne (utile pour les minifieurs).</p>
<p>Notez aussi le <code>"use strict";</code> qui dit au navigateur que tout ce qui se trouve dans cette fonction devra être traité par un parseur strict qui vous signalera plus d'erreurs de code. Cela ne s'applique qu'à la fonction, laissant le reste du monde le droit d'utiliser du code moins strict.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=3979&amp;md5=560c3870621f5f8fc713149f79122b16" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/la-fonction-anonyme-appelee-immediatement-en-javascript-function/feed/</wfw:commentRss>
		<slash:comments>16</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fla-fonction-anonyme-appelee-immediatement-en-javascript-function%2F&amp;language=en_GB&amp;category=text&amp;title=La+fonction+anonyme+appel%C3%A9e+imm%C3%A9diatement+en+Javascript%3A+%28function%28%29%29%28%29&amp;description=Javascript+est+un+langage+qui+a+plein+d%26%238217%3Bidiomes+bien+%C3%A0+lui.+En+effet%2C+c%26%238217%3Best+un+langage+tr%C3%A8s+puissant%2C+et+ausi+plein+de+couilles+velues+planqu%C3%A9es+ici+et+l%C3%A0.+Les+ninjas...&amp;tags=best+practice%2Cjavascript%2Clambda%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2012/12/mdn-logo-sm.png" length="1243" type="image/jpg" />	</item>
	</channel>
</rss>

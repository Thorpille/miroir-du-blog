<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Sam &#38; Max: Python, Django, Git et du cul &#187; sql</title>
	<atom:link href="http://sametmax.com/tag/sql/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Deux développeurs en vadrouille qui se sortent les doigts du code</description>
	<lastBuildDate>Wed, 05 Feb 2014 14:20:37 +0000</lastBuildDate>
	<language>en</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.3.1</generator>
	<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2F&amp;language=en_US&amp;category=text&amp;title=Sam+%26amp%3B+Max%3A+Python%2C+Django%2C+Git+et+du+cul&amp;description=Deux+d%C3%A9veloppeurs+en+vadrouille+qui+se+sortent+les+doigts+du+code&amp;tags=blog" type="text/html" />
		<item>
		<title>MySQL: créer un utilisateur avec une base de données à son nom sur laquelle il a tous les droits</title>
		<link>http://sametmax.com/mysql-creer-un-utilisateur-avec-une-table-a-son-nom-sur-laquelle-il-a-tous-les-droits/</link>
		<comments>http://sametmax.com/mysql-creer-un-utilisateur-avec-une-table-a-son-nom-sur-laquelle-il-a-tous-les-droits/#comments</comments>
		<pubDate>Mon, 15 Oct 2012 15:07:09 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Administration System]]></category>
		<category><![CDATA[mysql]]></category>
		<category><![CDATA[sql]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=2575</guid>
		<description><![CDATA[Le truc classique, qu'on fait tout le temps, et qu'on oublie toujours comment on a fait la dernière fois.]]></description>
			<content:encoded><![CDATA[<p>Le truc classique, qu&#8217;on fait tout le temps, et qu&#8217;on oublie toujours comment on a fait la dernière fois.</p>
<p>Vu qu&#8217;on a pas toujours PhpMyAdmin installé&#8230;</p>

<div class="wp_syntax"><div class="code"><pre class="sql" style="font-family:monospace;"><span style="color: #993333; font-weight: bold;">CREATE</span> <span style="color: #993333; font-weight: bold;">DATABASE</span> nom_db;
<span style="color: #993333; font-weight: bold;">GRANT</span> <span style="color: #993333; font-weight: bold;">ALL</span> PRIVILEGES <span style="color: #993333; font-weight: bold;">ON</span> nom_db<span style="color: #66cc66;">.*</span> <span style="color: #993333; font-weight: bold;">TO</span> <span style="color: #ff0000;">&quot;nom_utilisateur&quot;</span>@<span style="color: #ff0000;">&quot;localhost&quot;</span> <span style="color: #993333; font-weight: bold;">IDENTIFIED</span> <span style="color: #993333; font-weight: bold;">BY</span> <span style="color: #ff0000;">'mot_de_passe'</span>;
<span style="color: #993333; font-weight: bold;">FLUSH</span> PRIVILEGES;</pre></div></div>

 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=2575&amp;md5=6b6c556e52860854f0f7b0a1e24b8a0e" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/mysql-creer-un-utilisateur-avec-une-table-a-son-nom-sur-laquelle-il-a-tous-les-droits/feed/</wfw:commentRss>
		<slash:comments>11</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fmysql-creer-un-utilisateur-avec-une-table-a-son-nom-sur-laquelle-il-a-tous-les-droits%2F&amp;language=en_GB&amp;category=text&amp;title=MySQL%3A+cr%C3%A9er+un+utilisateur+avec+une+base+de+donn%C3%A9es+%C3%A0+son+nom+sur+laquelle+il+a+tous+les+droits&amp;description=Le+truc+classique%2C+qu%26%238217%3Bon+fait+tout+le+temps%2C+et+qu%26%238217%3Bon+oublie+toujours+comment+on+a+fait+la+derni%C3%A8re+fois.+Vu+qu%26%238217%3Bon+a+pas+toujours+PhpMyAdmin+install%C3%A9%26%238230%3B+CREATE+DATABASE+nom_db%3B+GRANT...&amp;tags=mysql%2Csql%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2012/10/xkcd.png" length="9340" type="image/jpg" />	</item>
		<item>
		<title>Log des requêtes SQL faites par l&#8217;ORM Django en temps réel</title>
		<link>http://sametmax.com/log-des-requetes-sql-faites-par-lorm-django-en-temps-reel/</link>
		<comments>http://sametmax.com/log-des-requetes-sql-faites-par-lorm-django-en-temps-reel/#comments</comments>
		<pubDate>Fri, 16 Mar 2012 17:30:01 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[django]]></category>
		<category><![CDATA[log]]></category>
		<category><![CDATA[orm]]></category>
		<category><![CDATA[sql]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=262</guid>
		<description><![CDATA[Il existe une solution plus simple que  la <code>django-debug-toolbar</code> ou <code>connection.queries</code> pour suivre les requêtes SQL de l'ORM Django.]]></description>
			<content:encoded><![CDATA[<p>Même en recherchant sur les sites spécialisés en anglais, je tombe toujours sur des solutions basées sur la <a href="https://github.com/django-debug-toolbar/django-debug-toolbar">django-debug-toolbar</a>, l&#8217;affichage de <a href="https://docs.djangoproject.com/en/dev/faq/models/#how-can-i-see-the-raw-sql-queries-django-is-running">connection.queries</a> ou l&#8217;usage de <a href="https://github.com/dcramer/django-devserver">devserver</a>. Ça a son utilité (surtout la fabuleuse <code>django-debug-toolbar</code>), mais c&#8217;est compliqué, long à mettre en oeuvre, et pas très pratique. </p>
<p>Il a beaucoup plus simple, et le plus beau, c&#8217;est que Django le propose en natif.</p>
<p>Par default, Django loggue toutes les requêtes SQL dans <em>django.db.backends</em> si <code>DEBUG = True</code>. Il suffit donc de configurer le logger, dans votre <em>settings.py</em>:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">os</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">tempfile</span>
&nbsp;
LOGGING = <span style="color: black;">&#123;</span>
    <span style="color: #483d8b;">'version'</span>: <span style="color: #ff4500;">1</span>,
    <span style="color: #483d8b;">'disable_existing_loggers'</span>: <span style="color: #008000;">False</span>,
    <span style="color: #483d8b;">'formatters'</span>: <span style="color: black;">&#123;</span>
        <span style="color: #483d8b;">'verbose'</span>: <span style="color: black;">&#123;</span>
            <span style="color: #483d8b;">'format'</span>: <span style="color: #483d8b;">'%(levelname)s %(asctime)s %(module)s %(process)d %(thread)d %(message)s'</span>
        <span style="color: black;">&#125;</span>,
        <span style="color: #483d8b;">'simple'</span>: <span style="color: black;">&#123;</span>
            <span style="color: #483d8b;">'format'</span>: <span style="color: #483d8b;">'%(levelname)s %(message)s'</span>
        <span style="color: black;">&#125;</span>,
    <span style="color: black;">&#125;</span>,
    <span style="color: #483d8b;">'handlers'</span>: <span style="color: black;">&#123;</span>
        <span style="color: #483d8b;">'tempfile'</span>: <span style="color: black;">&#123;</span>
            <span style="color: #483d8b;">'level'</span>: <span style="color: #483d8b;">'DEBUG'</span>,
            <span style="color: #483d8b;">'class'</span>: <span style="color: #483d8b;">'logging.handlers.RotatingFileHandler'</span>,
            <span style="color: #483d8b;">'formatter'</span>: <span style="color: #483d8b;">'verbose'</span>,
            <span style="color: #483d8b;">'filename'</span>: <span style="color: #dc143c;">os</span>.<span style="color: black;">path</span>.<span style="color: black;">join</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">tempfile</span>.<span style="color: black;">gettempdir</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>, <span style="color: #483d8b;">'django-debug.log'</span><span style="color: black;">&#41;</span>,
        <span style="color: black;">&#125;</span>,
        <span style="color: #483d8b;">'console'</span>:<span style="color: black;">&#123;</span>
            <span style="color: #483d8b;">'level'</span>:<span style="color: #483d8b;">'DEBUG'</span>,
            <span style="color: #483d8b;">'class'</span>:<span style="color: #483d8b;">'logging.StreamHandler'</span>,
            <span style="color: #483d8b;">'formatter'</span>: <span style="color: #483d8b;">'simple'</span>
        <span style="color: black;">&#125;</span>,
    <span style="color: black;">&#125;</span>,
    <span style="color: #483d8b;">'loggers'</span>: <span style="color: black;">&#123;</span>
        <span style="color: #483d8b;">'django.db.backends'</span>: <span style="color: black;">&#123;</span>
            <span style="color: #483d8b;">'handlers'</span>: <span style="color: black;">&#91;</span><span style="color: #483d8b;">'console'</span>, <span style="color: #483d8b;">'tempfile'</span><span style="color: black;">&#93;</span>,
            <span style="color: #483d8b;">'level'</span>: <span style="color: #483d8b;">'DEBUG'</span>,
            <span style="color: #483d8b;">'propagate'</span>: <span style="color: #008000;">True</span>,
        <span style="color: black;">&#125;</span>,
    <span style="color: black;">&#125;</span>,
<span style="color: black;">&#125;</span></pre></div></div>

<p>Lancez <code>./manage.py shell</code>:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;">In <span style="color: black;">&#91;</span><span style="color: #ff4500;">1</span><span style="color: black;">&#93;</span>: m = Table.<span style="color: black;">objects</span>.<span style="color: #008000;">filter</span><span style="color: black;">&#40;</span>title__isnull=<span style="color: #008000;">False</span><span style="color: black;">&#41;</span>
&nbsp;
In <span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>: m
DEBUG <span style="color: black;">&#40;</span><span style="color: #ff4500;">0.018</span><span style="color: black;">&#41;</span> SELECT <span style="color: #483d8b;">&quot;table&quot;</span>.<span style="color: #483d8b;">&quot;id&quot;</span>, <span style="color: #483d8b;">&quot;table&quot;</span>.<span style="color: #483d8b;">&quot;title&quot;</span>, <span style="color: #483d8b;">&quot;table&quot;</span>.<span style="color: #483d8b;">&quot;original_title&quot;</span> FROM <span style="color: #483d8b;">&quot;table&quot;</span> WHERE <span style="color: #483d8b;">&quot;table&quot;</span>.<span style="color: #483d8b;">&quot;title&quot;</span> IS NOT NULL LIMIT <span style="color: #ff4500;">21</span><span style="color: #66cc66;">;</span> args=<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
Out<span style="color: black;">&#91;</span><span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>: <span style="color: black;">&#91;</span><span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #66cc66;">&lt;</span> Table <span style="color: #008000;">object</span> <span style="color: #66cc66;">&gt;</span>, <span style="color: #483d8b;">'...(remaining elements truncated)...'</span><span style="color: black;">&#93;</span></pre></div></div>

<p>Une version plus verbeuse sera aussi logguée dans un fichier temporaire. Par exemple, sous linux il sera dans <code>/tmp/django-debug.log</code>.</p>
<p>Toutes les requêtes faites par le site Web seront également affichées dans le terminal sur lequel tourne le serveur, et dans le fichier temporaire. </p>
<p>Une fois que vous maitrisez le concept, je vous recommande plutot de mettre le logger <em>django.db.backends</em> dans votre <em>local_settings.py</em>, histoire d&#8217;éviter de l&#8217;avoir en prod:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;">LOGGING<span style="color: black;">&#91;</span><span style="color: #483d8b;">'loggers'</span><span style="color: black;">&#93;</span>.<span style="color: black;">update</span><span style="color: black;">&#40;</span><span style="color: black;">&#123;</span>
        <span style="color: #483d8b;">'django.db.backends'</span>: <span style="color: black;">&#123;</span>
            <span style="color: #483d8b;">'handlers'</span>: <span style="color: black;">&#91;</span><span style="color: #483d8b;">'console'</span>, <span style="color: #483d8b;">'tempfile'</span><span style="color: black;">&#93;</span>,
            <span style="color: #483d8b;">'level'</span>: <span style="color: #483d8b;">'DEBUG'</span>,
            <span style="color: #483d8b;">'propagate'</span>: <span style="color: #008000;">True</span>,
        <span style="color: black;">&#125;</span>,
    <span style="color: black;">&#125;</span>
<span style="color: black;">&#41;</span></pre></div></div>

<p>Autre bénéfice, il suffit de commenter cette partie quand ne souhaite plus afficher autant d&#8217;information.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=262&amp;md5=c35b72c694c7c068607463c4d98e647c" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/log-des-requetes-sql-faites-par-lorm-django-en-temps-reel/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Flog-des-requetes-sql-faites-par-lorm-django-en-temps-reel%2F&amp;language=en_GB&amp;category=text&amp;title=Log+des+requ%C3%AAtes+SQL+faites+par+l%26%238217%3BORM+Django+en+temps+r%C3%A9el&amp;description=M%C3%AAme+en+recherchant+sur+les+sites+sp%C3%A9cialis%C3%A9s+en+anglais%2C+je+tombe+toujours+sur+des+solutions+bas%C3%A9es+sur+la+django-debug-toolbar%2C+l%26%238217%3Baffichage+de%C2%A0connection.queries+ou+l%26%238217%3Busage+de+devserver.+%C3%87a+a+son+utilit%C3%A9+%28surtout%C2%A0la...&amp;tags=django%2Clog%2Corm%2Csql%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2012/03/lumber_from_log_lg.jpg" length="460459" type="image/jpg" />	</item>
	</channel>
</rss>

<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Sam &#38; Max: Python, Django, Git et du cul &#187; datetime</title>
	<atom:link href="http://sametmax.com/tag/datetime/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com</link>
	<description>Deux développeurs en vadrouille qui se sortent les doigts du code</description>
	<lastBuildDate>Wed, 05 Feb 2014 14:20:37 +0000</lastBuildDate>
	<language>en</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.3.1</generator>
	<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2F&amp;language=en_US&amp;category=text&amp;title=Sam+%26amp%3B+Max%3A+Python%2C+Django%2C+Git+et+du+cul&amp;description=Deux+d%C3%A9veloppeurs+en+vadrouille+qui+se+sortent+les+doigts+du+code&amp;tags=blog" type="text/html" />
		<item>
		<title>Les time zones en Python</title>
		<link>http://sametmax.com/les-time-zones-en-python/</link>
		<comments>http://sametmax.com/les-time-zones-en-python/#comments</comments>
		<pubDate>Tue, 15 Oct 2013 18:23:38 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[arrow]]></category>
		<category><![CDATA[datetime]]></category>
		<category><![CDATA[dateutil]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[pytz]]></category>
		<category><![CDATA[timezone]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=7448</guid>
		<description><![CDATA[Je suis tombé sur <a href="http://crsmithdev.com/arrow/">arrow</a>, une lib Python qui résout le problème]]></description>
			<content:encoded><![CDATA[<p>Si vous suivez un peu le blog, vous savez <a href="http://sametmax.com/manipuler-les-dates-et-les-durees-en-python/">comment manipuler les dates en Python</a>. Et c&#8217;est trop cool. Parce que le temps, c&#8217;est quelque chose de difficile en programmation, comme la gestion des monnaies ou la traduction d&#8217;une interface.</p>
<p>Mais notre article ne traite pas des time zones, c&#8217;est à dire de la gestion des fuseaux horaires. La raison est très simple, Sam est une grosse feignasse, et comme c&#8217;est un sujet <a href="http://lucumr.pocoo.org/2011/7/15/eppur-si-muove/">super galère</a>, il l&#8217;a soigneusement évité, vous renvoyant à l&#8217;usage de pytz. Démerdez vous.</p>
<p>Qu&#8217;est-ce qui a changé ? Le sujet est-il devenu plus simple ? Sam a-t-il un regain de motivation ? Le fait de parler de lui à la 3eme personne est-il signe de sénilité ?</p>
<p>Bien sûr que non, c&#8217;est simplement que je suis tombé sur <a href="http://crsmithdev.com/arrow/">arrow</a>, une lib Python qui résout le problème. Pour faire simple, c&#8217;est presque exactement la lib que j&#8217;avais commencé à coder pour la gestion du temps. Sauf que le mec, lui, il l&#8217;a terminé, alors que la mienne, elle est au fin fond d&#8217;un repo git poussiéreux depuis 8 mois.</p>
<p>Bref, laissez tout tomber, n&#8217;installez plus dateutil, pytz et autres libs que j&#8217;ai pu vous recommander par le passé (elle sont incluses et abstraites par arrow). Faites juste :</p>
<p><code>pip install arrow</code></p>
<h2>Tout commence par l&#8217;UTC</h2>
<p>Comme pour la gestion des encodings, la gestion des dates se fait en utilisant une base commune. Pour l&#8217;encoding, c&#8217;est unicode, pour les dates, c&#8217;est UTC.</p>
<p>Donc, si vous prévoyez de gérer différents fuseaux horaires dans votre programme, TOUT votre programme &#8211; j&#8217;ai dit TOUT &#8211; doit manipuler exclusivement des dates en UTC.</p>
<p>Comme avec l&#8217;encoding, l&#8217;idée est la suivante :</p>
<ul>
<li>A l&#8217;entrée de votre programme, vous acceptez des dates avec une timezone. Vous convertissez ces dates vers l&#8217;UTC.</li>
<li>Dans votre programme, vous manipuler uniquement de l&#8217;UTC.</li>
<li>A la sortie du programme, vous renvoyez des dates dans une timezone.</li>
</ul>
<p>Ceci suppose donc que :</p>
<ul>
<li>Vous savez ce qu&#8217;est une entrée et une sortie. Je vous fait un rappel : tout ce qui est pas dans votre programme (query base de données, socket, fichiers, print, input utilisateur, clic, affichage, etc.).</li>
<li>Vous DEVEZ savoir la timezone de ce qui rentre. <strong>Si vous ne le savez pas, vous ne pouvez absolument rien faire</strong> à part afficher à votre utilisateur que vous ne savez pas et le réglage par défaut . Pour la sortie, si vous ne savez pas, vous pouvez sortir de l&#8217;UTC par défaut, ça mange pas de pain. Mais pour l&#8217;entrée, il faut lire la spec, la doc, demandé au collègue, au fournisseur, au client, peut importe, il faut trouver l&#8217;info.</li>
</ul>
<h2>Avec arrow, c&#8217;est simplissime&#8230;</h2>
<p>Si vous créez une date vous même, il suffit de toujours le faire en UTC :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">import</span> arrow
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant = arrow.<span style="color: black;">utcnow</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># heure et date actuelle en UTC</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>maintenant<span style="color: black;">&#41;</span>
<span style="color: #ff4500;">2013</span>-<span style="color: #ff4500;">10</span>-15T17:<span style="color: #ff4500;">15</span>:<span style="color: #ff4500;">19.139000</span>+00:00
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">datetime</span> <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">datetime</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> date_de_sortie_des_goonies = arrow.<span style="color: black;">get</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">datetime</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1985</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">4</span><span style="color: black;">&#41;</span>, <span style="color: #483d8b;">'US/Pacific'</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>date_de_sortie_des_goonies<span style="color: black;">&#41;</span>
<span style="color: #ff4500;">1985</span>-<span style="color: #ff4500;">12</span>-04T00:00:00-08:00
<span style="color: #66cc66;">&gt;&gt;&gt;</span> date_de_sortie_des_goonies = date_de_sortie_des_goonies.<span style="color: black;">to</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'utc'</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>date_de_sortie_des_goonies<span style="color: black;">&#41;</span>
<span style="color: #ff4500;">1985</span>-<span style="color: #ff4500;">12</span>-04T08:00:00+00:00
Là, on a des dates uniquements en UTC.</pre></div></div>

<p>Si vous importez une date, c&#8217;est très simple également :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> arrow.<span style="color: black;">get</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1367900664</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># un timestamp marche..</span>
<span style="color: #66cc66;">&lt;</span>Arrow <span style="color: black;">&#91;</span><span style="color: #ff4500;">2013</span>-05-07T04:<span style="color: #ff4500;">24</span>:<span style="color: #ff4500;">24</span>+00:00<span style="color: black;">&#93;</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> arrow.<span style="color: black;">get</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'1367900664'</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># ... même en string</span>
<span style="color: #66cc66;">&lt;</span>Arrow <span style="color: black;">&#91;</span><span style="color: #ff4500;">2013</span>-05-07T04:<span style="color: #ff4500;">24</span>:<span style="color: #ff4500;">24</span>+00:00<span style="color: black;">&#93;</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> arrow.<span style="color: black;">get</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1367900664.152325</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># ... ou en float</span>
<span style="color: #66cc66;">&lt;</span>Arrow <span style="color: black;">&#91;</span><span style="color: #ff4500;">2013</span>-05-07T04:<span style="color: #ff4500;">24</span>:<span style="color: #ff4500;">24.152325</span>+00:00<span style="color: black;">&#93;</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> arrow.<span style="color: black;">get</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'2013-09-30T15:34:00.000-07:00'</span><span style="color: black;">&#41;</span>.<span style="color: black;">to</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'utc'</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># parser une date standard...</span>
<span style="color: #66cc66;">&lt;</span>Arrow <span style="color: black;">&#91;</span><span style="color: #ff4500;">2013</span>-09-30T22:<span style="color: #ff4500;">34</span>:00+00:00<span style="color: black;">&#93;</span><span style="color: #66cc66;">&gt;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">from</span> dateutil <span style="color: #ff7700;font-weight:bold;">import</span> tz <span style="color: #808080; font-style: italic;"># pour parser une date custo</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> arrow.<span style="color: black;">Arrow</span>.<span style="color: black;">strptime</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'2013-05-05 12:30:45'</span>, <span style="color: #483d8b;">'%Y-%m-%d %H:%M:%S'</span>, tz.<span style="color: black;">gettz</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'Paris/Europe'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&lt;</span>Arrow <span style="color: black;">&#91;</span><span style="color: #ff4500;">2013</span>-05-05T12:<span style="color: #ff4500;">30</span>:<span style="color: #ff4500;">45</span>+00:00<span style="color: black;">&#93;</span><span style="color: #66cc66;">&gt;</span></pre></div></div>

<p>Tout ça renvoie de l&#8217;UTC. </p>
<p>Et quand vous voulez afficher une date, vous pouvez tout simplement la reconvertir vers la timezone de votre choix avec la méthode <code>to()</code> et la formater comme avec <code>format()</code></p>
<h2>Stockage des dates</h2>
<p>Quand on stocke une date (dans une base de données, un fichier, etc), il faut se demander quel est le but du stockage. Si le but est de stocker la date d&#8217;un événement, mettez la date en UTC. Un timestamp suffit, ou alors la représentation YYYY-MM-DD hh:mm:ss. Par contre, si vous voulez stocker une date liée à un événement et un lieu (par exemple un rendez-vous d&#8217;affaire ou le décollage d&#8217;un avion), stockez la date en UTC avec sa timezone dans un champ à côté, sinon vous serez bien baisé quand vous voudrez la ressortir.</p>
<p>Ah oui, et réglez toujours tous vos serveurs sur UTC. Toujours.</p>
<h2>En bonus</h2>
<p>On peut obtenir toutes les infos utiles sans tourner autour du pot :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> a = arrow.<span style="color: black;">utcnow</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>a.<span style="color: #dc143c;">datetime</span><span style="color: black;">&#41;</span>
<span style="color: #ff4500;">2013</span>-<span style="color: #ff4500;">10</span>-<span style="color: #ff4500;">15</span> <span style="color: #ff4500;">17</span>:<span style="color: #ff4500;">48</span>:<span style="color: #ff4500;">28.335000</span>+00:00
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>a.<span style="color: black;">timestamp</span><span style="color: black;">&#41;</span>
<span style="color: #ff4500;">1381859308</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">repr</span><span style="color: black;">&#40;</span>a.<span style="color: black;">naive</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># on accès à l'objet datetime au cas où...</span>
<span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2013</span>, <span style="color: #ff4500;">10</span>, <span style="color: #ff4500;">15</span>, <span style="color: #ff4500;">17</span>, <span style="color: #ff4500;">49</span>, <span style="color: #ff4500;">25</span>, <span style="color: #ff4500;">515000</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>a.<span style="color: black;">tzinfo</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># ... et à l'objet tzinfo</span>
tzutc<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>a.<span style="color: black;">year</span>, a.<span style="color: black;">hour</span><span style="color: black;">&#41;</span>
<span style="color: black;">&#40;</span><span style="color: #ff4500;">2013</span>, <span style="color: #ff4500;">17</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Et on peut faire des replacements et des calculs flous, comme avec dateutil :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> a = arrow.<span style="color: black;">utcnow</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>a.<span style="color: black;">format</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'DD, MMMM'</span>, <span style="color: #dc143c;">locale</span>=<span style="color: #483d8b;">'fr_FR'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
<span style="color: #ff4500;">15</span>, Octobre
<span style="color: #66cc66;">&gt;&gt;&gt;</span> a = a.<span style="color: black;">replace</span><span style="color: black;">&#40;</span>day=<span style="color: #ff4500;">30</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>a.<span style="color: black;">format</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'DD, MMMM'</span>, <span style="color: #dc143c;">locale</span>=<span style="color: #483d8b;">'fr_FR'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
<span style="color: #ff4500;">30</span>, Octobre
<span style="color: #66cc66;">&gt;&gt;&gt;</span> a = a.<span style="color: black;">replace</span><span style="color: black;">&#40;</span>days=+<span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>a.<span style="color: black;">format</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'DD, MMMM'</span>, <span style="color: #dc143c;">locale</span>=<span style="color: #483d8b;">'fr_FR'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
<span style="color: #ff4500;">31</span>, Octobre
<span style="color: #66cc66;">&gt;&gt;&gt;</span> a = a.<span style="color: black;">replace</span><span style="color: black;">&#40;</span>months=-<span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>a.<span style="color: black;">format</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'DD, MMMM'</span>, <span style="color: #dc143c;">locale</span>=<span style="color: #483d8b;">'fr_FR'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
<span style="color: #ff4500;">30</span>, Septembre</pre></div></div>

<p>Faire de l&#8217;affichage relatif :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> before = arrow.<span style="color: black;">utcnow</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: black;">replace</span><span style="color: black;">&#40;</span>hours=-<span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> before.<span style="color: black;">humanize</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">locale</span>=<span style="color: #483d8b;">'Fr_fr'</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
<span style="color: #483d8b;">'il y a 3 heures'</span></pre></div></div>

<p>Bref, arrow, c&#8217;est de la bombe baby !</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=7448&amp;md5=8544577e57bf6731aa84ee26834f36c2" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/les-time-zones-en-python/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fles-time-zones-en-python%2F&amp;language=en_GB&amp;category=text&amp;title=Les+time+zones+en+Python&amp;description=Si+vous+suivez+un+peu+le+blog%2C+vous+savez+comment+manipuler+les+dates+en+Python.+Et+c%26%238217%3Best+trop+cool.+Parce+que+le+temps%2C+c%26%238217%3Best+quelque+chose+de+difficile+en+programmation%2C...&amp;tags=arrow%2Cdatetime%2Cdateutil%2Cpython%2Cpytz%2Ctimezone%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2013/10/tumblr_munp0wYq4t1r539hzo1_500.jpg" length="35324" type="image/jpg" />	</item>
		<item>
		<title>Manipuler les dates et les durées en Python</title>
		<link>http://sametmax.com/manipuler-les-dates-et-les-durees-en-python/</link>
		<comments>http://sametmax.com/manipuler-les-dates-et-les-durees-en-python/#comments</comments>
		<pubDate>Wed, 26 Dec 2012 16:09:47 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[date]]></category>
		<category><![CDATA[datetime]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[timedelta]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=3875</guid>
		<description><![CDATA[Manipuler des dates, c'est chaud. Le calendrier, c'est plein de subtilités comme les années bisextiles, les mois qui ont 4 possibilités de nombre de jours, les semaines qui commencent un dimanche aux US et un lundi en France... Autant dire que faire ça à la mano, c'est pas marrant, marrant.

Avec les modules <code>datetimes</code> et <code>calendar</code>, c'est déjà plus cool.]]></description>
			<content:encoded><![CDATA[<p>Manipuler des dates, c&#8217;est chaud. Le calendrier, c&#8217;est plein de subtilités comme les années bisextiles, les mois qui ont 4 possibilités de nombre de jours, les semaines qui commencent un dimanche aux US et un lundi en France&#8230; Autant dire que faire ça à la mano, c&#8217;est pas marrant, marrant.</p>
<p>Avec les modules <code>datetimes</code> et <code>calendar</code>, c&#8217;est déjà plus cool.</p>
<h2>Date et heure</h2>
<p><code>Datetime</code> est un module qui permet de manipuler des dates et des durées sous forme d&#8217;objets. L&#8217;idée est simple: vous manipulez l&#8217;objet pour faire tous vos calculs, et quand vous avez besoin de l&#8217;afficher, vous formattez l&#8217;objet en chaîne de caractères.</p>
<p>On peut créer artificiellement un objet <code>datetime</code>, ses paramètres sont:</p>
<p><code>datetime(année, mois, jour, heure, minute, seconde, microseconde, fuseaux horaire)</code></p>
<p>Mais seuls &#8220;année&#8221;, &#8220;mois&#8221; et &#8220;jour&#8221; sont obligatoires.</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">datetime</span> <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">datetime</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">datetime</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
<span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Nous sommes ici le premier janvier 2000, à la seconde et la minute zéro, de l&#8217;heure zéro.</p>
<p>On peut bien entendu récupérer l&#8217;heure et la date du jour:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant = <span style="color: #dc143c;">datetime</span>.<span style="color: black;">now</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant
<span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2012</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">24</span>, <span style="color: #ff4500;">18</span>, <span style="color: #ff4500;">20</span>, <span style="color: #ff4500;">4</span>, <span style="color: #ff4500;">534918</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: black;">year</span>
<span style="color: #ff4500;">2012</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: black;">month</span>
<span style="color: #ff4500;">12</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: black;">day</span>
<span style="color: #ff4500;">24</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: black;">hour</span>
<span style="color: #ff4500;">18</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: black;">minute</span>
<span style="color: #ff4500;">20</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: black;">second</span>
<span style="color: #ff4500;">4</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: black;">microsecond</span>
<span style="color: #ff4500;">534918</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: black;">isocalendar</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># année, semaine, jour</span>
<span style="color: black;">&#40;</span><span style="color: #ff4500;">2012</span>, <span style="color: #ff4500;">52</span>, <span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Enfin, si vous souhaitez uniquement vous occuper de la date ou de l&#8217;heure:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">datetime</span> <span style="color: #ff7700;font-weight:bold;">import</span> date, <span style="color: #dc143c;">time</span>, <span style="color: #dc143c;">datetime</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> date<span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
<span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">time</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">12</span><span style="color: black;">&#41;</span>
<span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">time</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">12</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant = <span style="color: #dc143c;">datetime</span>.<span style="color: black;">now</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2012</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">25</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: #dc143c;">time</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">time</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">15</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">16</span>, <span style="color: #ff4500;">704000</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Notez que j&#8217;écris cet article le jour de Noël, en famille. Et que là mon frangin est en train d&#8217;aider ma mère à éplucher des pommes tandis que je les regarde de loin. C&#8217;est mal. Je vais leur donner un coup de main et je reviens.</p>
<p>*Sam épluche les pommes et s&#8217;efforce de se tenir éloigné du débat sur la condition des canards gavés pour leur foie. Il quitte la table discrètement dès le premier usage de wikipédia pour défendre les volatiles*</p>
<p>Back.</p>
<p>Je disais donc&#8230;</p>
<h2>Durée</h2>
<p>En plus de pouvoir récupérer la date du jour, on peut calculer la différence entre deux dates. Par exemple, combien de temps y a-t-il entre aujourd&#8217;hui et le premier jour de l&#8217;an 2000 ?</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> duree = <span style="color: #dc143c;">datetime</span>.<span style="color: black;">now</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> - <span style="color: #dc143c;">datetime</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> duree
<span style="color: #dc143c;">datetime</span>.<span style="color: black;">timedelta</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">4741</span>, <span style="color: #ff4500;">66999</span>, <span style="color: #ff4500;">829132</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Et vous découvrez ici un autre objet: le <code>timedelta</code>. Cet objet représente une durée en jours, secondes et microsecondes.</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> duree.<span style="color: black;">days</span>
<span style="color: #ff4500;">4741</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> duree.<span style="color: black;">seconds</span>
<span style="color: #ff4500;">67007</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> duree.<span style="color: black;">mi</span>
duree.<span style="color: black;">microseconds</span>  duree.<span style="color: #008000;">min</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> duree.<span style="color: black;">microseconds</span>
<span style="color: #ff4500;">943760</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> duree.<span style="color: black;">total_seconds</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># addition de toutes les secondes + les jours</span>
<span style="color: #ff4500;">409689407.94376</span></pre></div></div>

<p>On peut créer son propre <code>timedelta</code>:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> timedelta<span style="color: black;">&#40;</span>days=<span style="color: #ff4500;">3</span>, seconds=<span style="color: #ff4500;">100</span><span style="color: black;">&#41;</span>
<span style="color: #dc143c;">datetime</span>.<span style="color: black;">timedelta</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">3</span>, <span style="color: #ff4500;">100</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Cela permet de répondre à la question : &#8220;Quelle date serons-nous dans 2 jours, 4 heures, 3 minutes, et 12 secondes ?&#8221;:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">datetime</span>.<span style="color: black;">now</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> + timedelta<span style="color: black;">&#40;</span>days=<span style="color: #ff4500;">2</span>, hours=<span style="color: #ff4500;">4</span>, minutes=<span style="color: #ff4500;">3</span>, seconds=<span style="color: #ff4500;">12</span><span style="color: black;">&#41;</span>
<span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2012</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">26</span>, <span style="color: #ff4500;">22</span>, <span style="color: #ff4500;">44</span>, <span style="color: #ff4500;">6</span>, <span style="color: #ff4500;">251071</span><span style="color: black;">&#41;</span></pre></div></div>

<p>A chaque fois, un nouvel objet est retourné. En effet, les objets <code>datetime</code> et <code>timedelta</code> sont immutables. Ainsi si vous voulez utiliser une version légèrement différente d&#8217;un objet <code>datetime</code>, il faudra toujours en créer un nouveau. Par exemple:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant = <span style="color: #dc143c;">datetime</span>.<span style="color: black;">now</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> maintenant.<span style="color: black;">replace</span><span style="color: black;">&#40;</span>year=<span style="color: #ff4500;">1995</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># on créer un nouvel objet</span>
<span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1995</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">25</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">9</span>, <span style="color: #ff4500;">46</span>, <span style="color: #ff4500;">185000</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Vous noterez que je ne parles pas de fuseaux horaire. Et bien c&#8217;est parceque l&#8217;implémentation Python est particulièrement ratée : l&#8217;API est compliquée et les données ne sont pas à jour. Il faut dire que la mesure du temps, contrairement à ce qu&#8217;on pourrait penser, n&#8217;est pas vraiment le truc le plus stable du monde, et des pays <a href="http://www.rfi.fr/asie-pacifique/20111230-iles-samoa-fuseau-horaire">changent régulièrement leur manière de faire</a>.</p>
<p>Donc je trollerai sur fuseaux dans un article plus gluant sur lequel, une fois n&#8217;est pas coutume, je taclerai Python. Restons sur les dates pures.</p>
<h2>Autre modules</h2>
<p>Une fois que vous maitrisez <code>datetime</code>, vous pouvez retourner lire notre article sur le <a href="http://sametmax.com/serialiser-et-parser-une-date-en-python-formats-de-strftimestrptime-et-timestamps/">formatage de date</a>.</p>
<p>Mais ce n&#8217;est pas tout, il y d&#8217;autres modules liées à la gestion du temps en Python.</p>
<p>Dans la lib standard, il y a <a href="http://docs.python.org/2/library/calendar.html?highlight=calendar#calendar">calendar</a>.</p>
<p>Il permet de manipuler un calendrier comme un objet, et itérer sur les jours d&#8217;un mois, les semaines, verifier les caractéristiques d&#8217;un jour en particulier, etc. :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">calendar</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">calendar</span>.<span style="color: black;">mdays</span> <span style="color: #808080; font-style: italic;"># combien de jour par mois ?</span>
<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">31</span>, <span style="color: #ff4500;">28</span>, <span style="color: #ff4500;">31</span>, <span style="color: #ff4500;">30</span>, <span style="color: #ff4500;">31</span>, <span style="color: #ff4500;">30</span>, <span style="color: #ff4500;">31</span>, <span style="color: #ff4500;">31</span>, <span style="color: #ff4500;">30</span>, <span style="color: #ff4500;">31</span>, <span style="color: #ff4500;">30</span>, <span style="color: #ff4500;">31</span><span style="color: black;">&#93;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">calendar</span>.<span style="color: black;">isleap</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># est-ce une année bisextile ?</span>
<span style="color: #008000;">True</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">calendar</span>.<span style="color: black;">weekday</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># quel jour était cette date ?</span>
<span style="color: #ff4500;">5</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">calendar</span>.<span style="color: black;">MONDAY</span>, <span style="color: #dc143c;">calendar</span>.<span style="color: black;">TUESDAY</span>, <span style="color: #dc143c;">calendar</span>.<span style="color: black;">WEDNESDAY</span>, <span style="color: #dc143c;">calendar</span>.<span style="color: black;">THURSDAY</span>, <span style="color: #dc143c;">calendar</span>.<span style="color: black;">FRIDAY</span>, <span style="color: #dc143c;">calendar</span>.<span style="color: black;">SATURDAY</span>, <span style="color: #dc143c;">calendar</span>.<span style="color: black;">SUNDAY</span> 
<span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">3</span>, <span style="color: #ff4500;">4</span>, <span style="color: #ff4500;">5</span>, <span style="color: #ff4500;">6</span><span style="color: black;">&#41;</span></pre></div></div>

<p>On peut instancier un calendrier et itérer dessus:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> cal = <span style="color: #dc143c;">calendar</span>.<span style="color: black;">Calendar</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> cal.<span style="color: black;">getfirstweekday</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #ff4500;">0</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">list</span><span style="color: black;">&#40;</span>cal.<span style="color: black;">iterweekdays</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">3</span>, <span style="color: #ff4500;">4</span>, <span style="color: #ff4500;">5</span>, <span style="color: #ff4500;">6</span><span style="color: black;">&#93;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">list</span><span style="color: black;">&#40;</span>cal.<span style="color: black;">itermonthdays</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> 
<span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">3</span>, <span style="color: #ff4500;">4</span>, <span style="color: #ff4500;">5</span>, <span style="color: #ff4500;">6</span>, <span style="color: #ff4500;">7</span>, <span style="color: #ff4500;">8</span>, <span style="color: #ff4500;">9</span>, <span style="color: #ff4500;">10</span>, <span style="color: #ff4500;">11</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">13</span>, <span style="color: #ff4500;">14</span>, <span style="color: #ff4500;">15</span>, <span style="color: #ff4500;">16</span>, <span style="color: #ff4500;">17</span>, <span style="color: #ff4500;">18</span>, <span style="color: #ff4500;">19</span>, <span style="color: #ff4500;">20</span>, <span style="color: #ff4500;">21</span>, <span style="color: #ff4500;">22</span>, <span style="color: #ff4500;">23</span>, <span style="color: #ff4500;">24</span>, <span style="color: #ff4500;">25</span>, <span style="color: #ff4500;">26</span>, <span style="color: #ff4500;">27</span>, <span style="color: #ff4500;">28</span>, <span style="color: #ff4500;">29</span>, <span style="color: #ff4500;">30</span>, <span style="color: #ff4500;">31</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #008000;">list</span><span style="color: black;">&#40;</span>cal.<span style="color: black;">itermonthdates</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
<span style="color: black;">&#91;</span><span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1999</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">27</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1999</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">28</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1999</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">29</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1999</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">30</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1999</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">31</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">4</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">5</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">6</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">7</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">8</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">9</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">10</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">11</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">12</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">13</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">14</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">15</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">16</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">17</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">18</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">19</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">20</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">21</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">22</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">23</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">24</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">25</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">26</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">27</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">28</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">29</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">30</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">31</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">4</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">5</span><span style="color: black;">&#41;</span>, <span style="color: #dc143c;">datetime</span>.<span style="color: black;">date</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">2</span>, <span style="color: #ff4500;">6</span><span style="color: black;">&#41;</span><span style="color: black;">&#93;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> cal.<span style="color: black;">monthdayscalendar</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2000</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>
<span style="color: black;">&#91;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span>, <span style="color: #ff4500;">2</span><span style="color: black;">&#93;</span>, <span style="color: black;">&#91;</span><span style="color: #ff4500;">3</span>, <span style="color: #ff4500;">4</span>, <span style="color: #ff4500;">5</span>, <span style="color: #ff4500;">6</span>, <span style="color: #ff4500;">7</span>, <span style="color: #ff4500;">8</span>, <span style="color: #ff4500;">9</span><span style="color: black;">&#93;</span>, <span style="color: black;">&#91;</span><span style="color: #ff4500;">10</span>, <span style="color: #ff4500;">11</span>, <span style="color: #ff4500;">12</span>, <span style="color: #ff4500;">13</span>, <span style="color: #ff4500;">14</span>, <span style="color: #ff4500;">15</span>, <span style="color: #ff4500;">16</span><span style="color: black;">&#93;</span>, <span style="color: black;">&#91;</span><span style="color: #ff4500;">17</span>, <span style="color: #ff4500;">18</span>, <span style="color: #ff4500;">19</span>, <span style="color: #ff4500;">20</span>, <span style="color: #ff4500;">21</span>, <span style="color: #ff4500;">22</span>, <span style="color: #ff4500;">23</span><span style="color: black;">&#93;</span>, <span style="color: black;">&#91;</span><span style="color: #ff4500;">24</span>, <span style="color: #ff4500;">25</span>, <span style="color: #ff4500;">26</span>, <span style="color: #ff4500;">27</span>, <span style="color: #ff4500;">28</span>, <span style="color: #ff4500;">29</span>, <span style="color: #ff4500;">30</span><span style="color: black;">&#93;</span>, <span style="color: black;">&#91;</span><span style="color: #ff4500;">31</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#93;</span></pre></div></div>

<p>Comme souvent Python vient aussi avec de très bons modules tierces parties pour manipuler les dates:</p>
<ul>
<li><a href="http://labix.org/python-dateutil">dateutils</a> est un datetime boosté aux hormones qui permet notament de donnée des durées floues comme &#8220;+ 1 mois&#8221; et gérer des événements qui se répètent. Il est dans tous mes projets par défaut.</li>
<li><a href="http://babel.edgewall.org/">babel</a> n&#8217;est pas spécialisé dans les dates mais dans la localisation. Le module possèdes des outils pour formatter des dates selon le format de chaque pays, et aussi avec des formats naturels comme &#8220;il y a une minute&#8221;.</li>
<li><a href="http://pypi.python.org/pypi/pytz">pytz</a> est une implémentation saine de gestion des fuseaux horaires en Python. On y reviendra.</li>
</ul>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=3875&amp;md5=2c31c6c4ce49fa1cef850bad35a7ff8b" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/manipuler-les-dates-et-les-durees-en-python/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fmanipuler-les-dates-et-les-durees-en-python%2F&amp;language=en_GB&amp;category=text&amp;title=Manipuler+les+dates+et+les+dur%C3%A9es+en+Python&amp;description=Manipuler+des+dates%2C+c%26%238217%3Best+chaud.+Le+calendrier%2C+c%26%238217%3Best+plein+de+subtilit%C3%A9s+comme+les+ann%C3%A9es+bisextiles%2C+les+mois+qui+ont+4+possibilit%C3%A9s+de+nombre+de+jours%2C+les+semaines+qui+commencent+un...&amp;tags=date%2Cdatetime%2Cpython%2Ctimedelta%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2012/12/back-to-the-future.jpg" length="519489" type="image/jpg" />	</item>
		<item>
		<title>Sérialiser et parser une date en Python: formats de strftime/strptime et timestamps</title>
		<link>http://sametmax.com/serialiser-et-parser-une-date-en-python-formats-de-strftimestrptime-et-timestamps/</link>
		<comments>http://sametmax.com/serialiser-et-parser-une-date-en-python-formats-de-strftimestrptime-et-timestamps/#comments</comments>
		<pubDate>Mon, 23 Jul 2012 12:00:22 +0000</pubDate>
		<dc:creator>Sam</dc:creator>
				<category><![CDATA[Programmation]]></category>
		<category><![CDATA[date]]></category>
		<category><![CDATA[datetime]]></category>
		<category><![CDATA[parsing]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[time]]></category>

		<guid isPermaLink="false">http://sametmax.com/?p=1272</guid>
		<description><![CDATA[Ça fait 10 ans que j'en fais, et je ne me souviens jamais des lettres à utiliser pour les formats. Pourtant j'utilise tout le temps le <strong>même</strong> format.]]></description>
			<content:encoded><![CDATA[<p>Ça fait 10 ans que j&#8217;en fais, et je ne me souviens jamais des lettres à utiliser pour les formats. Pourtant j&#8217;utilise tout le temps le <strong>même</strong> format: celui de MySQl et JSON par défaut, avec en plus les microsecondes, car l&#8217;odre alphanumérique de ce format est le même que l&#8217;ordre chronologique, ce qui rend son traitement facile.</p>
<p>Je le met ici pour l&#8217;avoir toujours sous la main. Marre de chercher si truc est en minuscule, et marchin en majuscule. Je me fais baiser à chaque fois.</p>
<p>Sérialiser une date pour avoir: année, mois, jour, heure, minute, seconde, microsecondes :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">datetime</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span>.<span style="color: black;">now</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: black;">strftime</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'%Y-%m-%d %H:%M:%S.%f'</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #483d8b;">'2012-07-22 16:19:00.539570'</span></pre></div></div>

<p>A l&#8217;inverse, parser une date:</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span>.<span style="color: black;">strptime</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'2012-07-22 16:19:00.539570'</span>, <span style="color: #483d8b;">'%Y-%m-%d %H:%M:%S.%f'</span><span style="color: black;">&#41;</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2012</span>, <span style="color: #ff4500;">7</span>, <span style="color: #ff4500;">22</span>, <span style="color: #ff4500;">16</span>, <span style="color: #ff4500;">19</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">539570</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Tous les formats sont listés <a href="http://docs.python.org/library/datetime.html?highlight=strftime#strftime-and-strptime-behavior">ici</a>.</p>
<p>Et tant qu&#8217;on y est, le snippet de manipulation de timestamp (qui pour le fun, n&#8217;est pas par défaut dans le module datetime):</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">calendar</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">calendar</span>.<span style="color: black;">timegm</span><span style="color: black;">&#40;</span>d.<span style="color: black;">utctimetuple</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># d'un objet date vers un timestamp</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #ff4500;">1342973940</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span>.<span style="color: black;">fromtimestamp</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1342973940</span><span style="color: black;">&#41;</span> <span style="color: #808080; font-style: italic;"># et l'inverse</span>
<span style="color: #66cc66;">&gt;&gt;&gt;</span> <span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">2012</span>, <span style="color: #ff4500;">7</span>, <span style="color: #ff4500;">22</span>, <span style="color: #ff4500;">18</span>, <span style="color: #ff4500;">19</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Le timestamp est un timestamp basé sur une epoch of 1970 et un format POSIX, <a href="http://stackoverflow.com/a/2582158/9951">avec toute ce que ça implique</a>, et notamment le fait qu&#8217;on perd les microseconde.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=1272&amp;md5=487937b134bc7dfdf98e65e3c4021d57" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content:encoded>
			<wfw:commentRss>http://sametmax.com/serialiser-et-parser-une-date-en-python-formats-de-strftimestrptime-et-timestamps/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
		<atom:link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fserialiser-et-parser-une-date-en-python-formats-de-strftimestrptime-et-timestamps%2F&amp;language=en_GB&amp;category=text&amp;title=S%C3%A9rialiser+et+parser+une+date+en+Python%3A+formats+de+strftime%2Fstrptime+et+timestamps&amp;description=%C3%87a+fait+10+ans+que+j%26%238217%3Ben+fais%2C+et+je+ne+me+souviens+jamais+des+lettres+%C3%A0+utiliser+pour+les+formats.+Pourtant+j%26%238217%3Butilise+tout+le+temps+le+m%C3%AAme+format%3A+celui+de...&amp;tags=date%2Cdatetime%2Cparsing%2Cpython%2Ctime%2Cblog" type="text/html" />
<enclosure url="http://sametmax.com/wp-content/uploads/2012/07/illusiontimeesp1.jpg" length="17560" type="image/jpg" />	</item>
	</channel>
</rss>

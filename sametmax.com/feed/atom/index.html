<?xml version="1.0" encoding="UTF-8"?><feed
  xmlns="http://www.w3.org/2005/Atom"
  xmlns:thr="http://purl.org/syndication/thread/1.0"
  xml:lang="en"
  xml:base="http://sametmax.com/wp-atom.php"
   >
	<title type="text">Sam &#38; Max: Python, Django, Git et du cul</title>
	<subtitle type="text">Deux développeurs en vadrouille qui se sortent les doigts du code</subtitle>

	<updated>2014-02-05T14:20:37Z</updated>

	<link rel="alternate" type="text/html" href="http://sametmax.com" />
	<id>http://sametmax.com/feed/atom/</id>
	<link rel="self" type="application/atom+xml" href="http://sametmax.com/feed/atom/" />

	<generator uri="http://wordpress.org/" version="3.3.1">WordPress</generator>
	<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2F&amp;language=en_US&amp;category=text&amp;title=Sam+%26amp%3B+Max%3A+Python%2C+Django%2C+Git+et+du+cul&amp;description=Deux+d%C3%A9veloppeurs+en+vadrouille+qui+se+sortent+les+doigts+du+code&amp;tags=blog" type="text/html" />
		<entry>
		<author>
			<name>Max</name>
					</author>
		<title type="html"><![CDATA[Virtualenv EnvironmentError: mysql_config not found sous MAC OSX]]></title>
		<link rel="alternate" type="text/html" href="http://sametmax.com/virtualenv-environmenterror-mysql_config-not-found-sous-mac-osx/" />
		<id>http://sametmax.com/?p=8963</id>
		<updated>2014-02-04T11:01:38Z</updated>
		<published>2014-02-04T10:56:18Z</published>
		<category scheme="http://sametmax.com" term="Administration System" /><category scheme="http://sametmax.com" term="Programmation" /><category scheme="http://sametmax.com" term="Web" /><category scheme="http://sametmax.com" term="config" /><category scheme="http://sametmax.com" term="erreur" /><category scheme="http://sametmax.com" term="mysql-python" />		<summary type="html"><![CDATA[Des fois il y a des petites choses comme ça qui devraient s'installer comme un rien et passer innaperçues mais non, ça vous fait une belle erreur et vous passez des heures à vous demander pourquoi ça ne veut pas s'installer. Restons zen...]]></summary>
		<content type="html" xml:base="http://sametmax.com/virtualenv-environmenterror-mysql_config-not-found-sous-mac-osx/"><![CDATA[<p>Comme le post précédent est inutile j&#8217;en fait un autre qui doit concerner au moins 0.00001% de la population.</p>
<p>A vous qui essayez depuis 2 heures de configurer MySQL-python sous votre virtualenv, cet article vous est dédié.</p>
<p>Cette erreur vicieuse m&#8217;arrive à chaque fois que j&#8217;installe MySQL-python dans un nouvel environnement virtuel. Ceci dit vous l&#8217;aurez peut-être sous un autre OS. Sur centos j&#8217;avais qu&#8217;à faire un <em>yum install mysql-devel</em> mais sous Mac c&#8217;est autre chose. Plus de puissance engendre plus de responsabilités&#8230;</p>

<div class="wp_syntax"><div class="code"><pre class="bash" style="font-family:monospace;">&nbsp;
Max $  pip <span style="color: #c20cb9; font-weight: bold;">install</span> MySQL-python
Downloading<span style="color: #000000; font-weight: bold;">/</span>unpacking MySQL-python
  Downloading MySQL-python-1.2.5.zip <span style="color: #7a0874; font-weight: bold;">&#40;</span>108Kb<span style="color: #7a0874; font-weight: bold;">&#41;</span>: 108Kb downloaded
  Running setup.py egg_info <span style="color: #000000; font-weight: bold;">for</span> package MySQL-python
    <span style="color: #c20cb9; font-weight: bold;">sh</span>: mysql_config: <span style="color: #7a0874; font-weight: bold;">command</span> not found
    Traceback <span style="color: #7a0874; font-weight: bold;">&#40;</span>most recent call <span style="color: #c20cb9; font-weight: bold;">last</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>:
      File <span style="color: #ff0000;">&quot;&lt;string&gt;&quot;</span>, line <span style="color: #000000;">14</span>, <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #000000; font-weight: bold;">&lt;</span>module<span style="color: #000000; font-weight: bold;">&gt;</span>
      File <span style="color: #ff0000;">&quot;/Users/Max/.virtualenvs/zooscator/build/MySQL-python/setup.py&quot;</span>, line <span style="color: #000000;">17</span>, <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #000000; font-weight: bold;">&lt;</span>module<span style="color: #000000; font-weight: bold;">&gt;</span>
        metadata, options = get_config<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
      File <span style="color: #ff0000;">&quot;setup_posix.py&quot;</span>, line <span style="color: #000000;">43</span>, <span style="color: #000000; font-weight: bold;">in</span> get_config
        libs = mysql_config<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">&quot;libs_r&quot;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
      File <span style="color: #ff0000;">&quot;setup_posix.py&quot;</span>, line <span style="color: #000000;">25</span>, <span style="color: #000000; font-weight: bold;">in</span> mysql_config
        raise EnvironmentError<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">&quot;%s not found&quot;</span> <span style="color: #000000; font-weight: bold;">%</span> <span style="color: #7a0874; font-weight: bold;">&#40;</span>mysql_config.path,<span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
    EnvironmentError: mysql_config not found
    Complete output from <span style="color: #7a0874; font-weight: bold;">command</span> python setup.py egg_info:
    <span style="color: #c20cb9; font-weight: bold;">sh</span>: mysql_config: <span style="color: #7a0874; font-weight: bold;">command</span> not found
&nbsp;
Traceback <span style="color: #7a0874; font-weight: bold;">&#40;</span>most recent call <span style="color: #c20cb9; font-weight: bold;">last</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>:
&nbsp;
  File <span style="color: #ff0000;">&quot;&lt;string&gt;&quot;</span>, line <span style="color: #000000;">14</span>, <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #000000; font-weight: bold;">&lt;</span>module<span style="color: #000000; font-weight: bold;">&gt;</span>
&nbsp;
  File <span style="color: #ff0000;">&quot;/Users/Max/.virtualenvs/zooscator/build/MySQL-python/setup.py&quot;</span>, line <span style="color: #000000;">17</span>, <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #000000; font-weight: bold;">&lt;</span>module<span style="color: #000000; font-weight: bold;">&gt;</span>
&nbsp;
    metadata, options = get_config<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
&nbsp;
  File <span style="color: #ff0000;">&quot;setup_posix.py&quot;</span>, line <span style="color: #000000;">43</span>, <span style="color: #000000; font-weight: bold;">in</span> get_config
&nbsp;
    libs = mysql_config<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">&quot;libs_r&quot;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
&nbsp;
  File <span style="color: #ff0000;">&quot;setup_posix.py&quot;</span>, line <span style="color: #000000;">25</span>, <span style="color: #000000; font-weight: bold;">in</span> mysql_config
&nbsp;
    raise EnvironmentError<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">&quot;%s not found&quot;</span> <span style="color: #000000; font-weight: bold;">%</span> <span style="color: #7a0874; font-weight: bold;">&#40;</span>mysql_config.path,<span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
&nbsp;
EnvironmentError: mysql_config not found
&nbsp;
<span style="color: #660033;">----------------------------------------</span>
Command python setup.py egg_info failed with error code <span style="color: #000000;">1</span>
Storing <span style="color: #7a0874; font-weight: bold;">complete</span> log <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #000000; font-weight: bold;">/</span>Users<span style="color: #000000; font-weight: bold;">/</span>Max<span style="color: #000000; font-weight: bold;">/</span>.pip<span style="color: #000000; font-weight: bold;">/</span>pip.log</pre></div></div>

<p>Il faut éditer votre fichier <strong>activate</strong> qui se trouve dans le répertoire bin de votre environnement virtuel: ex &#8220;/Users/Max/.virtualenvs/zooscator/bin/activate&#8221;</p>

<div class="wp_syntax"><div class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">vi</span> <span style="color: #000000; font-weight: bold;">/</span>Users<span style="color: #000000; font-weight: bold;">/</span>Max<span style="color: #000000; font-weight: bold;">/</span>.virtualenvs<span style="color: #000000; font-weight: bold;">/</span>zooscator<span style="color: #000000; font-weight: bold;">/</span>bin</pre></div></div>

<p><strong>Trouvez les lignes suivantes et ajoutez:</strong></p>
<blockquote><p>PATH=&#8221;$PATH:/opt/local/lib/mysql5/bin/&#8221;
</p></blockquote>

<div class="wp_syntax"><div class="code"><pre class="bash" style="font-family:monospace;">...
<span style="color: #007800;">_OLD_VIRTUAL_PATH</span>=<span style="color: #ff0000;">&quot;<span style="color: #007800;">$PATH</span>&quot;</span>
<span style="color: #007800;">PATH</span>=<span style="color: #ff0000;">&quot;<span style="color: #007800;">$VIRTUAL_ENV</span>/bin:<span style="color: #007800;">$PATH</span>&quot;</span>
<span style="color: #007800;">PATH</span>=<span style="color: #ff0000;">&quot;<span style="color: #007800;">$PATH</span>:/opt/local/lib/mysql5/bin/&quot;</span>
<span style="color: #7a0874; font-weight: bold;">export</span> PATH
...</pre></div></div>

<p>Chez moi le chemin vers mysql est /opt/local/lib/mysql5/bin/, si vous ne connaissez pas le vôtre utilisez la commande <em>locate</em>: ex <em>locate mysql</em></p>
<p><strong>Une fois le fichier <em>activate</em> édité il faut le resourcer:<br />
</strong></p>

<div class="wp_syntax"><div class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #7a0874; font-weight: bold;">source</span> <span style="color: #000000; font-weight: bold;">/</span>Users<span style="color: #000000; font-weight: bold;">/</span>Max<span style="color: #000000; font-weight: bold;">/</span>.virtualenvs<span style="color: #000000; font-weight: bold;">/</span>zooscator<span style="color: #000000; font-weight: bold;">/</span>bin<span style="color: #000000; font-weight: bold;">/</span>activate</pre></div></div>

<p><strong>Et vous pourrez alors installer MySQL-python tranquillou billou:<br />
</strong></p>

<div class="wp_syntax"><div class="code"><pre class="bash" style="font-family:monospace;">Max $  pip <span style="color: #c20cb9; font-weight: bold;">install</span> MySQL-python
&nbsp;
Downloading<span style="color: #000000; font-weight: bold;">/</span>unpacking MySQL-python
  Running setup.py egg_info <span style="color: #000000; font-weight: bold;">for</span> package MySQL-python
&nbsp;
Installing collected packages: MySQL-python
  Running setup.py <span style="color: #c20cb9; font-weight: bold;">install</span> <span style="color: #000000; font-weight: bold;">for</span> MySQL-python
<span style="color: #7a0874; font-weight: bold;">&#91;</span>....................<span style="color: #7a0874; font-weight: bold;">&#93;</span>
Successfully installed MySQL-python
Cleaning up...</pre></div></div>

<p>Je vais nourir mon cochon d&#8217;Inde.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8963&amp;md5=c153ddb9ef35528707273f7e6d6bc2fe" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content>
		<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fvirtualenv-environmenterror-mysql_config-not-found-sous-mac-osx%2F&amp;language=en_GB&amp;category=text&amp;title=Virtualenv+EnvironmentError%3A+mysql_config+not+found+sous+MAC+OSX&amp;description=Comme+le+post+pr%C3%A9c%C3%A9dent+est+inutile+j%26%238217%3Ben+fait+un+autre+qui+doit+concerner+au+moins+0.00001%25+de+la+population.+A+vous+qui+essayez+depuis+2+heures+de+configurer+MySQL-python+sous...&amp;tags=config%2Cerreur%2Cmysql-python%2Cblog" type="text/html" />
		<link rel="replies" type="text/html" href="http://sametmax.com/virtualenv-environmenterror-mysql_config-not-found-sous-mac-osx/#comments" thr:count="14"/>
		<link rel="replies" type="application/atom+xml" href="http://sametmax.com/virtualenv-environmenterror-mysql_config-not-found-sous-mac-osx/feed/atom/" thr:count="14"/>
		<thr:total>14</thr:total>
	</entry>
		<entry>
		<author>
			<name>Max</name>
					</author>
		<title type="html"><![CDATA[Trouvez l&#8217;intrus&#8230;]]></title>
		<link rel="alternate" type="text/html" href="http://sametmax.com/trouvez-lintrus/" />
		<id>http://sametmax.com/?p=8958</id>
		<updated>2014-02-04T04:22:50Z</updated>
		<published>2014-02-04T04:22:01Z</published>
		<category scheme="http://sametmax.com" term="Cul" /><category scheme="http://sametmax.com" term="NSFW" /><category scheme="http://sametmax.com" term="Philo et culture" /><category scheme="http://sametmax.com" term="intrus" /><category scheme="http://sametmax.com" term="mots-clefs" /><category scheme="http://sametmax.com" term="référencement" />		<summary type="html"><![CDATA[Trouvez l'intrus parmis les mot-clefs qui vous ont ammené ici...]]></summary>
		<content type="html" xml:base="http://sametmax.com/trouvez-lintrus/"><![CDATA[<p>J&#8217;adore les mots-clefs d&#8217;hier. Le troisième en particulier&#8230;</p>
<p>Cependant un intrus s&#8217;est glissé dans le décors, saurez-vous le retrouver ?</p>
<blockquote><p>sexy teacher<br />
sam et max<br />
levrette avec une vache<br />
abreviation escort<br />
escort girj cjm<br />
masturbation feminine video<br />
passe partout fort boyard<br />
video masturbation femme<br />
partouze<br />
maison close pute<br />
scene de masturbation en directe<br />
fellation tuto<br />
fkk allemagne<br />
jeune fille rentre chez elle et se masturbe video francaise<br />
truc de cul hard<br />
fonction exponentielle dans la vie de tous les jours<br />
démonstration de mastubation féminine<br />
club fkk
</p></blockquote>
<p>PS: Moi aussi je peux faire des posts bouches-trous :p<br />
PS2: Je me demande de quelle revue hautement scientifico-intellectuelle on va se faire virer maintenant.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8958&amp;md5=f53226847e96ceb87b8b175ae037c48d" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content>
		<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Ftrouvez-lintrus%2F&amp;language=en_GB&amp;category=text&amp;title=Trouvez+l%26%238217%3Bintrus%26%238230%3B&amp;description=J%26%238217%3Badore+les+mots-clefs+d%26%238217%3Bhier.+Le+troisi%C3%A8me+en+particulier%26%238230%3B+Cependant+un+intrus+s%26%238217%3Best+gliss%C3%A9+dans+le+d%C3%A9cors%2C+saurez-vous+le+retrouver+%3F+sexy+teacher+sam+et+max+levrette+avec+une+vache+abreviation...&amp;tags=intrus%2Cmots-clefs%2Cr%C3%A9f%C3%A9rencement%2Cblog" type="text/html" />
		<link rel="replies" type="text/html" href="http://sametmax.com/trouvez-lintrus/#comments" thr:count="6"/>
		<link rel="replies" type="application/atom+xml" href="http://sametmax.com/trouvez-lintrus/feed/atom/" thr:count="6"/>
		<thr:total>6</thr:total>
	</entry>
		<entry>
		<author>
			<name>Sam</name>
					</author>
		<title type="html"><![CDATA[Les ventes aux enchères publiques]]></title>
		<link rel="alternate" type="text/html" href="http://sametmax.com/les-ventes-aux-encheres-publiques/" />
		<id>http://sametmax.com/?p=8950</id>
		<updated>2014-02-03T17:11:31Z</updated>
		<published>2014-02-03T17:05:01Z</published>
		<category scheme="http://sametmax.com" term="Programmation" />		<summary type="html"><![CDATA[Petite digression de la ligne éditoriale, billet d&#8217;humeur, des fois il faut écrire ce qui sort. Quand j&#8217;étais gosse mon père m&#8217;avait trainé à des ventes aux enchères, et c&#8217;était une vraie corvée : rester assis sur place pendant des heures pour un môme, c&#8217;est complètement con (pensez à l&#8217;école&#8230;) et mon pouvoir d&#8217;achat était [...]]]></summary>
		<content type="html" xml:base="http://sametmax.com/les-ventes-aux-encheres-publiques/"><![CDATA[<p>Petite digression de la ligne éditoriale, billet d&#8217;humeur, des fois il faut écrire ce qui sort.</p>
<p>Quand j&#8217;étais gosse mon père m&#8217;avait trainé à des ventes aux enchères, et c&#8217;était une vraie corvée : rester assis sur place pendant des heures pour un môme, c&#8217;est complètement con (pensez à l&#8217;école&#8230;) et mon pouvoir d&#8217;achat était négligeable. En plus on ne pouvait même pas toucher les objets.</p>
<p>Mais en grandissant, le premier cheveux blanc arrive, on se met à aimer les cornichons et les vides greniers. Et on fini par retourner aux enchères.</p>
<p>Pour ceux qui ne savent pas, il existe ce qu&#8217;on appelle des enchères publiques, dans lesquelles des personnes physiques ou morales, souvent endettées, parfois carrément en faillite, vendent leurs biens. On y trouve aussi quantité d&#8217;objets non réclamés à la poste. L&#8217;avantage de la chose, c&#8217;est qu&#8217;on trouve des objets de toutes sortes de domaines, potentiellement à un tiers du prix conseillé et possiblement neufs.</p>
<p>Ça se passe ainsi : on se pointe à l&#8217;exposition, dans laquelle on a le droit de regarder les choses qui vont être en vente. Ça peut aller de l&#8217;écran plat au four à pain de boulanger en passant par une caravane, des bijoux, du matériel d&#8217;escalade et une collection de cartes pokémon.</p>
<p>En générale quand on arrive, on sait où regarder car maintenant, magie de l&#8217;internet, on a un listing en ligne des biens vendus des jours avant la vente sur les sites des <a href="http://commissaires-priseurs.com/trouver-un-commissaire-priseur-judiciaire/">commissaires priseurs</a> ou des <a href="http://www.conseildesventes.fr/sites/default/files/annuaire-cvv.pdf">OVV</a>. Dans tous les cas, on peut obtenir la liste imprimée sur place, mais certaines salles le facturent une somme symbolique.</p>
<p>Tout le monde peut se pointer, c&#8217;est publique, et tout le monde se pointe. Une enchère est socialement très transversale : vous avez des vieux, des jeunes, des jaunes, des blancs, des chauves, des moustachus, des pros, des amateurs, des élégants, des dépareillés&#8230; Mais le profile type est un homme de plus de 35 ans.</p>
<p>Dans beaucoup de salles, on a pas le droit d&#8217;approcher les objets, exposés derrière des barrières, et groupés par lots numérotés. Quand on est intéressé par un lot, on le signale à un assistant qui va vous le chercher (sauf si c&#8217;est un bateau, évidement) pour que vous l&#8217;examiniez sous ses yeux.</p>
<p>Au bout d&#8217;un temps prévu à l&#8217;avance, on va donner un chèque en blanc et une pièce d&#8217;identité pour récupérer un numéro d&#8217;enchérisseur sur un petit panneau. Ceci dit si vous ne le faites pas, on vous laisse souvent enchérir quand même à main levée, et on vous donne le panneau à la première enchère remportée.</p>
<p>Ensuite on s&#8217;assoie, un mec avec un costume datant du temps de votre grand père monte sur un podium avec un marteau et répète à tout le monde une bonne 30aine de fois qu&#8217;il lui faut du silence. Il recommencera tout au long de la vente, c&#8217;est une tradition.</p>
<p>Là, l&#8217;équipe commencent à présenter les lots, on annonce le prix de départ et chacun lève joyeusement son petit panneau ou sa mimine pour enchérir. Pour des petits lots, on enchérie par tranches de 2, 5, 10, 20 ou 50 euros. La taille des tranche peut augmenter au fur et à mesure que l&#8217;enchère augmente. Si vous enchérissez sur un bien bien plus cher, l&#8217;enchère peut monter par tranche de 100, 500, 1000&#8230; Si vous êtes dans le domaine du luxe, les tranches sont un mois ou un an de salaire pour vous.</p>
<p>Si il n&#8217;y a pas d&#8217;acheteur, le commissaire priseur va proposer un prix à la baisse. Hé oui, la mise à prix peut diminuer.</p>
<p>La vente peut durer des heures. Ma dernière vente a duré 3h, avec une 1h d&#8217;expo, 1/2h pour y aller, 1/2h pour en revenir, soit 5h monopolisées en plein lundi. Tout le monde ne peut pas se le permettre. Heureusement aujourd&#8217;hui, on peut enchérir en ligne, sans avoir à se déplacer. Même si personnellement je préfère voir les lots en direct, car c&#8217;est dur de se faire une idée.</p>
<p>Histoire que vous puissiez évaluer le contenu d&#8217;une vente, voici un extrait (il y avait des <strong>centaines</strong> de lots, ce ne sont quelques uns) de ce qui est parti à la dernière.</p>
<table>
<tbody>
<tr>
<td>Lot</td>
<td>Prix de départ</td>
<td>Adjugé pour</td>
<td>Prix frais compris</td>
<td>Prix en magasin</td>
<td>Notes</td>
</tr>
<tr>
<td>Carton de 100 clés USB</td>
<td>40</td>
<td>426</td>
<td>511,2</td>
<td>?</td>
<td>Je n&#8217;ai pas vérifié la taille des clés</td>
</tr>
<tr>
<td><a href="http://www.darty.com/nav/achat/informatique/ordinateur_portable-portable/portable/asus_touch_taichi31-cx010h.html">PC ASUS TAICHI 30</a></td>
<td>300</td>
<td>600</td>
<td>720</td>
<td>1207
</td>
<td>Ce genre de matos part assez cher, mais notez que c&#8217;est du neuf. Presque 500€ d&#8217;économisé sur l&#8217;achat d&#8217;un portable de ce genre, ce n&#8217;est pas rien.
</td>
</tr>
<tr>
<td>Carton de 80 montres fantasies</td>
<td>100</td>
<td>220</td>
<td>264</td>
<td>?</td>
<td>«&nbsp;fantasie&nbsp;» = casio, diesel, etc.<br />
Acheté par un mec fashion qui voulait sans doute une montre par jour à<br />
porter.</td>
</tr>
<tr>
<td><a href="http://www.territoirewhisky.fr/fr/nos-whiskies/825-chivas-regal-25-ans.html">2 bouteilles de Chivas 25 ans d&#8217;age</a></td>
<td>?</td>
<td>210</td>
<td>252</td>
<td>508
</td>
<td>
</td>
</tr>
<tr>
<td>20 bouteilles de liqueurs</td>
<td>100</td>
<td>100</td>
<td>120</td>
<td>?</td>
<td>Le lot est vraiment parti pour rien, ça fait<br />
partie de ces «&nbsp;coups de bol&nbsp;» car ça valait 20 fois ce prix<br />
si ont souhaite le vendre en magasin.</td>
</tr>
<tr>
<td>12 bouteilles apéro</td>
<td>50</td>
<td>100</td>
<td>120</td>
<td>?</td>
<td>Type «&nbsp;vodka, manzana, pastis, cointreau,<br />
etc&nbsp;». Pour un BDE, c&#8217;est intéressant.</td>
</tr>
<tr>
<td><a href="http://www.marionnaud.fr/Marionnaud/Marques/CHANEL/PARFUMS-FEMME/N%C2%B05/Eau-de-Parfum/p/BP_100005086">Parfum Chanel N°5, 200ml</a></td>
<td>50</td>
<td>115</td>
<td>138</td>
<td>177
</td>
<td>Ce genre de produit part à des prix bien moins intéressant. Les acheteurs à petit budgets sont généralement<br />
les moins bons en enchères, ils &#8220;tentent le coup&#8221; sur un produit coup de coeur et montent les prix beaucoup trop haut, sans stratégie d&#8217;achat.</td>
</tr>
<tr>
<td><a href="http://www.priceminister.com/offer/buy/75258602/Xp-Copie-Stratocaster-Bl-Guitare-Electrique-Xp-Instrument.html">Guitar Electrique XP</a> + <a href="http://haytrade.fr/catalogue/3-GClass.pdf">Guitar<br />
accoustique STOL</a></td>
<td>80</td>
<td>80</td>
<td>96</td>
<td>
</td>
<td>Même si les instruments ne sont pas de qualités<br />
incroyables, c&#8217;est bien plus rentable de les acheter ici. Surtout que<br />
beaucoup de gens abandonnent la musique en cours de route. Il y a aussi quelques pièces de très grande qualité. Deux luth sont partis à 1300 euros.</td>
</tr>
<tr>
<td><a href="http://www.sebim-instrument.com/index.php?route=product/product&#038;path=31_143&#038;product_id=7152">Violon Taille Sebim taille ½</a></td>
<td>50</td>
<td>60</td>
<td>72</td>
<td>?
</td>
<td>?
</td>
</tr>
<tr>
<td><a href="http://www.airsoftworld.net/warrior-l96-mk-3-sniper-rifle-and-bi-pod-black.html">Fusil Sniper Airsoft MB01</a></td>
<td>40</td>
<td>65</td>
<td>78</td>
<td>175
</td>
<td>Ce genre de matos ultra spécialisé est rare, et<br />
du coup il y a moins de connaisseurs et on peut tomber sur des lots très sympas.</td>
</tr>
</tbody>
</table>
<p>Notez que le prix sur lequel on enchérie n&#8217;est pas celui qu&#8217;on paie. C&#8217;est la grande enculade des ventes aux enchères, puisque ces frais additionnels doivent être calculés de tête en permanence. Et plein de gens ne le font pas, transformant votre enchère &#8220;bonne affaire&#8221; en &#8220;achat au supermarcher&#8221;. Mémé a gagné, elle vous regarde en souriant victorieusement, et vous êtes dégoutés car vous avez raté un super prix, et elle a acheté plus cher que le prix sur le bon coin parce qu&#8217;elle est nul en calcul mental. C&#8217;est très chiant, mais c&#8217;est la jeu ma pauv&#8217; lucette.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8950&amp;md5=73c611e7473f1647314bf0f3c051e2a2" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content>
		<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fles-ventes-aux-encheres-publiques%2F&amp;language=en_GB&amp;category=text&amp;title=Les+ventes+aux+ench%C3%A8res+publiques&amp;description=Petite+digression+de+la+ligne+%C3%A9ditoriale%2C+billet+d%26%238217%3Bhumeur%2C+des+fois+il+faut+%C3%A9crire+ce+qui+sort.+Quand+j%26%238217%3B%C3%A9tais+gosse+mon+p%C3%A8re+m%26%238217%3Bavait+train%C3%A9+%C3%A0+des+ventes+aux+ench%C3%A8res%2C+et+c%26%238217%3B%C3%A9tait...&amp;tags=blog" type="text/html" />
		<link rel="replies" type="text/html" href="http://sametmax.com/les-ventes-aux-encheres-publiques/#comments" thr:count="6"/>
		<link rel="replies" type="application/atom+xml" href="http://sametmax.com/les-ventes-aux-encheres-publiques/feed/atom/" thr:count="6"/>
		<thr:total>6</thr:total>
	</entry>
		<entry>
		<author>
			<name>foxmask</name>
						<uri>http://www.foxmask.info/</uri>
					</author>
		<title type="html"><![CDATA[Python a le don d&#8217;Ubiquité : Multiprocessing]]></title>
		<link rel="alternate" type="text/html" href="http://sametmax.com/python-ubiuite-multiprocessing/" />
		<id>http://sametmax.com/?p=8939</id>
		<updated>2014-02-02T16:41:23Z</updated>
		<published>2014-02-02T16:41:23Z</published>
		<category scheme="http://sametmax.com" term="Programmation" /><category scheme="http://sametmax.com" term="multiprocessing" /><category scheme="http://sametmax.com" term="python" />		<summary type="html"><![CDATA[Ceci est un post invité de Foxmask posté sous licence creative common 3.0 unported. Tout récemment j&#8217;ai voulu donner un coup de fouet à mon script de traitement de Trigger Happy (que je fais tourner sur ma &#8220;raspberry pi&#8221; parce que chuis un w4rl0rdZ:P) que j&#8217;estimais être trop long dans ses traitements de données. Actuellement [...]]]></summary>
		<content type="html" xml:base="http://sametmax.com/python-ubiuite-multiprocessing/"><![CDATA[<blockquote><p>Ceci est un post invité de <a href="http://sametmax.com/author/foxmask" target="_blank">Foxmask </a>posté sous licence <a href="http://creativecommons.org/licenses/by/3.0/" target="_blank">creative common 3.0 unported</a>.</p></blockquote>
<p>Tout récemment j&#8217;ai voulu donner un coup de fouet à mon <a href="https://github.com/foxmask/django-th/blob/d91e443795429c85decf0ccf5e1f8470df7d11c4/fire.py">script de traitement</a> de <a href="http://www.foxmask.info/tag/triggerhappy/">Trigger Happy</a> (que je fais tourner sur ma &#8220;raspberry pi&#8221; parce que chuis un w4rl0rdZ:P) que j&#8217;estimais être trop long dans ses traitements de données.</p>
<p>Actuellement avec <a href="https://pypi.python.org/pypi/django_th/">Trigger Happy</a>, j&#8217;ai 30 sources de données (essentiellement des flux rss), que je parcours, et quand un nouvel item arrive, je l&#8217;envoi à pétaouchnock (Evernote ;) Le tout prend <strong>7min</strong>, soit 14secondes par source. La loose totale.</p>
<p>Voici le corps du délit :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;">#!/usr/bin/env python</span>
<span style="color: #808080; font-style: italic;"># -*- coding: utf-8 -*-</span>
<span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">__future__</span> <span style="color: #ff7700;font-weight:bold;">import</span> unicode_literals
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">os</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">datetime</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">time</span>
&nbsp;
<span style="color: #dc143c;">os</span>.<span style="color: black;">environ</span>.<span style="color: black;">setdefault</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;DJANGO_SETTINGS_MODULE&quot;</span>, <span style="color: #483d8b;">&quot;django_th.settings&quot;</span><span style="color: black;">&#41;</span>
<span style="color: #ff7700;font-weight:bold;">from</span> django_th.<span style="color: black;">services</span> <span style="color: #ff7700;font-weight:bold;">import</span> default_provider
<span style="color: #ff7700;font-weight:bold;">from</span> django_th.<span style="color: black;">models</span> <span style="color: #ff7700;font-weight:bold;">import</span> TriggerService
<span style="color: #ff7700;font-weight:bold;">from</span> django.<span style="color: black;">utils</span>.<span style="color: black;">log</span> <span style="color: #ff7700;font-weight:bold;">import</span> getLogger
&nbsp;
<span style="color: #808080; font-style: italic;"># create logger</span>
logger = getLogger<span style="color: black;">&#40;</span><span style="color: #483d8b;">'django_th.trigger_happy'</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> go<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    <span style="color: #483d8b;">&quot;&quot;&quot;
        run the main process
    &quot;&quot;&quot;</span>
    trigger = TriggerService.<span style="color: black;">objects</span>.<span style="color: #008000;">filter</span><span style="color: black;">&#40;</span>status=<span style="color: #008000;">True</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">if</span> trigger:
        <span style="color: #ff7700;font-weight:bold;">for</span> service <span style="color: #ff7700;font-weight:bold;">in</span> trigger:
<span style="color: black;">&#91;</span>...<span style="color: black;">&#93;</span>
    <span style="color: #ff7700;font-weight:bold;">else</span>:
        <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: #483d8b;">&quot;No trigger set by any user&quot;</span>
&nbsp;
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> main<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    default_provider.<span style="color: black;">load_services</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #808080; font-style: italic;"># let's go</span>
    go<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">if</span> __name__ == <span style="color: #483d8b;">&quot;__main__&quot;</span>:
&nbsp;
    main<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Mais avant que je ne me penche sur le code du script pour l&#8217;améliorer, je me suis dit que plutôt que de chercher à corriger un problème, autant chercher la source de celui-ci d&#8217;abord (normal hein).</p>
<p>Un HTOP m&#8217;a révélé :</p>
<ol>
<li>que le CPU était à 100% tout le temps, que le script tourne ou pas</li>
<li>quye la raison était double : rabittmq et celery&#8230; </li>
</ol>
<p>Une fois shootés ces derniers, tout va pour le mieux :P<br />
Je ne dis pas que ceux ci sont de la merde, mais que, pour mon cas, la crontab se suffit à elle-même.</p>
<p>Donc une fois désinstallés c&#8217;est 2 (sur)consommateurs de ressources, je relance le script pour tomber à un temps de traitement à <strong>5mn</strong></p>

<div class="wp_syntax"><div class="code"><pre class="shell" style="font-family:monospace;">2014-02-02 14:40:51,693 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News Sam et Max nothing new
2014-02-02 14:40:53,865 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News de Numerama nothing new
2014-02-02 14:40:56,013 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de La Ferme du Web nothing new
2014-02-02 14:41:01,005 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - flux de Paulds nothing new
2014-02-02 14:41:20,098 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux d'un Odieux Connard nothing new
2014-02-02 14:41:22,142 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Strict minimum nothing new
2014-02-02 14:41:25,868 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Humeurs Illustrées nothing new
2014-02-02 14:41:33,497 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux du Journalisme Total nothing new
2014-02-02 14:41:35,658 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Kernel Panic nothing new
2014-02-02 14:41:44,897 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de AngularJS nothing new
2014-02-02 14:41:49,016 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Odeon nothing new
2014-02-02 14:41:54,186 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Nicolargo nothing new
2014-02-02 14:42:12,525 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de JEEK nothing new
2014-02-02 14:42:21,349 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Recher nothing new
2014-02-02 14:42:31,266 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Un blog d'adminsys Libres nothing new
2014-02-02 14:42:35,824 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - flux de Le bloc-notes de Gee nothing new
2014-02-02 14:42:36,647 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de mere code (atom) nothing new
2014-02-02 14:42:39,616 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Alex Mac Caw nothing new
2014-02-02 14:42:42,985 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Yearofmoo Articles nothing new
2014-02-02 14:43:42,732 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News Novapost nothing new
2014-02-02 14:43:46,722 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News Les Numériques nothing new
2014-02-02 14:43:58,303 INFO fire 5142 date 2014-02-02 13:00:00 &gt;= date triggered 2014-02-02 09:02:36 title Test du Quechua Phone 5, le smartphone des montagnards ?
2014-02-02 14:44:08,010 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News Frandroid = 1 new data
2014-02-02 14:44:17,624 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de TechCrunch Mobile nothing new
2014-02-02 14:44:20,339 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux Django annonces nothing new
2014-02-02 14:44:20,744 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - La Hyène - Python nothing new
2014-02-02 14:44:24,237 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News de PCInpact nothing new
2014-02-02 14:44:29,055 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - PointGPhone nothing new
2014-02-02 14:44:31,299 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - HumanCoders Python nothing new
2014-02-02 14:44:52,751 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - HauteFeuille Lab (python) nothing new
2014-02-02 14:44:58,850 INFO fire 5142 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Python Plone Planet nothing new</pre></div></div>

<p>Comme je suis un éternel insatisfait de bibi, j&#8217;ai cherché <a href="http://sametmax.com/remplacer-les-threads-avec-le-module-multiprocessing-en-python/">des moyens</a> <a href="http://www.hautefeuille.eu/python-parallelism-multiprocessing.html">un peu partout</a>, jusqu&#8217;à ce que Sam me souffle une suggestion ;)</p>
<p>A présent donc <a href="https://github.com/foxmask/django-th/blob/master/fire.py">une version modifiée pour exploiter le multiprocessing</a> est la suivante :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;">#!/usr/bin/env python</span>
<span style="color: #808080; font-style: italic;"># -*- coding: utf-8 -*-</span>
<span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">__future__</span> <span style="color: #ff7700;font-weight:bold;">import</span> unicode_literals
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">os</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">datetime</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">time</span>
<span style="color: #dc143c;">os</span>.<span style="color: black;">environ</span>.<span style="color: black;">setdefault</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;DJANGO_SETTINGS_MODULE&quot;</span>, <span style="color: #483d8b;">&quot;th.settings&quot;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">from</span> django_th.<span style="color: black;">services</span> <span style="color: #ff7700;font-weight:bold;">import</span> default_provider
<span style="color: #ff7700;font-weight:bold;">from</span> django_th.<span style="color: black;">models</span> <span style="color: #ff7700;font-weight:bold;">import</span> TriggerService
<span style="color: #ff7700;font-weight:bold;">from</span> django.<span style="color: black;">utils</span>.<span style="color: black;">log</span> <span style="color: #ff7700;font-weight:bold;">import</span> getLogger
&nbsp;
<span style="color: #808080; font-style: italic;"># create logger</span>
logger = getLogger<span style="color: black;">&#40;</span><span style="color: #483d8b;">'django_th.trigger_happy'</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> go<span style="color: black;">&#40;</span>service<span style="color: black;">&#41;</span>:
    <span style="color: #483d8b;">&quot;&quot;&quot;
        run the main process
    &quot;&quot;&quot;</span>
    <span style="color: black;">&#91;</span>...<span style="color: black;">&#93;</span>
&nbsp;
&nbsp;
<span style="color: #ff7700;font-weight:bold;">def</span> main<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    default_provider.<span style="color: black;">load_services</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #808080; font-style: italic;"># let's go</span>
    trigger = TriggerService.<span style="color: black;">objects</span>.<span style="color: #008000;">filter</span><span style="color: black;">&#40;</span>status=<span style="color: #008000;">True</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">if</span> trigger:
        <span style="color: #ff7700;font-weight:bold;">from</span> multiprocessing <span style="color: #ff7700;font-weight:bold;">import</span> Pool
        pool = Pool<span style="color: black;">&#40;</span>processes=<span style="color: #ff4500;">5</span><span style="color: black;">&#41;</span>
        result = pool.<span style="color: #008000;">map</span><span style="color: black;">&#40;</span>go, trigger<span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">else</span>:
        <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: #483d8b;">&quot;No trigger set by any user&quot;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">if</span> __name__ == <span style="color: #483d8b;">&quot;__main__&quot;</span>:
&nbsp;
    main<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></div></div>

<p>fait tomber le temps de traitement à &#8230; <strong>1min</strong> &#8230;:</p>

<div class="wp_syntax"><div class="code"><pre class="shell" style="font-family:monospace;">$ date &amp;&amp; ./fire.sh &amp;&amp; date 
dimanche 2 février 2014, 14:58:38 (UTC+0100)
2014-02-02 14:58:48,221 INFO fire 5334 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de La Ferme du Web nothing new
2014-02-02 14:58:48,243 INFO fire 5336 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Humeurs Illustrées nothing new
2014-02-02 14:58:48,256 INFO fire 5337 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Kernel Panic nothing new
2014-02-02 14:58:48,283 INFO fire 5333 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News Sam et Max nothing new
2014-02-02 14:58:48,907 INFO fire 5335 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux d'un Odieux Connard nothing new
2014-02-02 14:58:49,267 INFO fire 5334 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - flux de Paulds nothing new
2014-02-02 14:58:49,446 INFO fire 5336 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux du Journalisme Total nothing new
2014-02-02 14:58:49,713 INFO fire 5333 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News de Numerama nothing new
2014-02-02 14:58:49,847 INFO fire 5335 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Strict minimum nothing new
2014-02-02 14:58:50,209 INFO fire 5334 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Odeon nothing new
2014-02-02 14:58:50,353 INFO fire 5337 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de AngularJS nothing new
2014-02-02 14:58:50,830 INFO fire 5333 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Un blog d'adminsys Libres nothing new
2014-02-02 14:58:51,338 INFO fire 5336 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de JEEK nothing new
2014-02-02 14:58:51,396 INFO fire 5334 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Nicolargo nothing new
2014-02-02 14:58:51,476 INFO fire 5337 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Yearofmoo Articles nothing new
2014-02-02 14:58:51,735 INFO fire 5333 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - flux de Le bloc-notes de Gee nothing new
2014-02-02 14:58:52,148 INFO fire 5335 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de mere code (atom) nothing new
2014-02-02 14:58:52,640 INFO fire 5336 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Recher nothing new
2014-02-02 14:58:52,971 INFO fire 5335 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Alex Mac Caw nothing new
2014-02-02 14:58:53,416 INFO fire 5334 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News Les Numériques nothing new
2014-02-02 14:58:53,474 INFO fire 5333 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de TechCrunch Mobile nothing new
2014-02-02 14:58:53,870 INFO fire 5337 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News Novapost nothing new
2014-02-02 14:58:54,072 INFO fire 5335 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - PointGPhone nothing new
2014-02-02 14:58:54,316 INFO fire 5333 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux Django annonces nothing new
2014-02-02 14:58:54,853 INFO fire 5336 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - La Hyène - Python nothing new
2014-02-02 14:58:55,111 INFO fire 5335 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - HumanCoders Python nothing new
2014-02-02 14:58:55,222 INFO fire 5334 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News Frandroid nothing new
2014-02-02 14:58:55,380 INFO fire 5337 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - HauteFeuille Lab (python) nothing new
2014-02-02 14:58:55,696 INFO fire 5336 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - News de PCInpact nothing new
2014-02-02 14:59:02,214 INFO fire 5337 user: foxmask - provider: ServiceRss - consummer: ServiceEvernote - Flux de Python Plone Planet nothing new
dimanche 2 février 2014, 14:59:02 (UTC+0100)</pre></div></div>

<p>Comme on l&#8217;aura remarqué la différence entre les 2 versions est l&#8217;appel fait à a fonction go </p>
<p>avant :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> main<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    default_provider.<span style="color: black;">load_services</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #808080; font-style: italic;"># let's go</span>
    go<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></div></div>

<p>après :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">def</span> main<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    default_provider.<span style="color: black;">load_services</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #808080; font-style: italic;"># let's go</span>
    trigger = TriggerService.<span style="color: black;">objects</span>.<span style="color: #008000;">filter</span><span style="color: black;">&#40;</span>status=<span style="color: #008000;">True</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">if</span> trigger:
        <span style="color: #ff7700;font-weight:bold;">from</span> multiprocessing <span style="color: #ff7700;font-weight:bold;">import</span> Pool
        pool = Pool<span style="color: black;">&#40;</span>processes=<span style="color: #ff4500;">5</span><span style="color: black;">&#41;</span>
        result = pool.<span style="color: #008000;">map</span><span style="color: black;">&#40;</span>go, trigger<span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">else</span>:
        <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: #483d8b;">&quot;No trigger set by any user&quot;</span></pre></div></div>

<p>du coup l&#8217;appel de la fonction &#8220;go&#8221; implique de changer sa signature en lui filant comme <a href="http://sametmax.com/la-difference-entre-parametres-et-arguments/">argument</a> &#8220;trigger&#8221; (le QuerySet de l&#8217;appli Django)</p>
<p>A présent donc <strong>pool.map</strong> fait l&#8217;itération des données trouvées dans le modele <strong>TriggerService</strong> et exécute tout le tintouin. *<:o)</p>
<p>ps : @Sam : chose promise chose dûe ;)</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8939&amp;md5=9114c0c05f7ef60e6f4fb45b22129faf" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content>
		<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fpython-ubiuite-multiprocessing%2F&amp;language=en_GB&amp;category=text&amp;title=Python+a+le+don+d%26%238217%3BUbiquit%C3%A9+%3A+Multiprocessing&amp;description=Ceci+est+un+post+invit%C3%A9+de+Foxmask+post%C3%A9+sous+licence+creative+common+3.0+unported.+Tout+r%C3%A9cemment+j%26%238217%3Bai+voulu+donner+un+coup+de+fouet+%C3%A0+mon+script+de+traitement+de+Trigger...&amp;tags=multiprocessing%2Cpython%2Cblog" type="text/html" />
		<link rel="replies" type="text/html" href="http://sametmax.com/python-ubiuite-multiprocessing/#comments" thr:count="6"/>
		<link rel="replies" type="application/atom+xml" href="http://sametmax.com/python-ubiuite-multiprocessing/feed/atom/" thr:count="6"/>
		<thr:total>6</thr:total>
	</entry>
		<entry>
		<author>
			<name>Sam</name>
					</author>
		<title type="html"><![CDATA[Un objet proxy : ce que c&#8217;est et à quoi ça sert]]></title>
		<link rel="alternate" type="text/html" href="http://sametmax.com/un-objet-proxy-ce-que-cest-et-a-quoi-ca-sert/" />
		<id>http://sametmax.com/?p=8076</id>
		<updated>2014-02-01T17:18:13Z</updated>
		<published>2014-02-01T17:18:13Z</published>
		<category scheme="http://sametmax.com" term="Programmation" /><category scheme="http://sametmax.com" term="class" /><category scheme="http://sametmax.com" term="objet" /><category scheme="http://sametmax.com" term="proxy" /><category scheme="http://sametmax.com" term="python" />		<summary type="html"><![CDATA[Un objet proxy est un objet qui prend un <strong>autre</strong> objet en paramètre et le sauvegarde dans un de ses attributs. Quand on appelle les méthodes du proxy, le proxy appelle la même méthode de l'objet qu'il a en attribut, et retourne le résultat. Quand on set/get/delete un attribut du proxy, il fait la même chose sur l'autre objet.]]></summary>
		<content type="html" xml:base="http://sametmax.com/un-objet-proxy-ce-que-cest-et-a-quoi-ca-sert/"><![CDATA[<p>Un objet proxy est un objet qui prend un <strong>autre</strong> objet en paramètre et le sauvegarde dans un de ses attributs. Quand on appelle les méthodes du proxy, le proxy appelle la même méthode de l&#8217;objet qu&#8217;il a en attribut, et retourne le résultat. Quand on set/get/delete un attribut du proxy, il fait la même chose sur l&#8217;autre objet.</p>
<p>Voilà une implémentation très basique d&#8217;un objet proxy en Python :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">class</span> Proxy<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__init__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, obj<span style="color: black;">&#41;</span>:
        <span style="color: #808080; font-style: italic;"># L'objet passé en paramètre est</span>
        <span style="color: #808080; font-style: italic;"># sauvegardé dans un attribut.</span>
        <span style="color: #808080; font-style: italic;"># On le fait en utilisant </span>
        <span style="color: #808080; font-style: italic;"># object.__setattr__, qui est le</span>
        <span style="color: #808080; font-style: italic;"># __setattr__ du parent, et non directement</span>
        <span style="color: #808080; font-style: italic;"># en faisant self._obj = obj</span>
        <span style="color: #808080; font-style: italic;"># afin d'éviter une boucle infinie car</span>
        <span style="color: #808080; font-style: italic;"># nous écrasons __setattr__ plus bas.</span>
        <span style="color: #008000;">object</span>.<span style="color: #0000cd;">__setattr__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, <span style="color: #483d8b;">&quot;_obj&quot;</span>, obj<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># On écrase les méthodes magiques __getattribute__</span>
    <span style="color: #808080; font-style: italic;"># (qui est appelée quand on faire self.nom_attribut), </span>
    <span style="color: #808080; font-style: italic;"># __delattr__ (qui est appelée quand on fait </span>
    <span style="color: #808080; font-style: italic;"># del self.nom_attribut) et __setattr__ (qui est </span>
    <span style="color: #808080; font-style: italic;"># appelée quand on fait self.nom_attribut = truc)</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__getattribute__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, name<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">getattr</span><span style="color: black;">&#40;</span><span style="color: #008000;">object</span>.<span style="color: #0000cd;">__getattribute__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, <span style="color: #483d8b;">&quot;_obj&quot;</span><span style="color: black;">&#41;</span>, name<span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__delattr__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, name<span style="color: black;">&#41;</span>:
        <span style="color: #008000;">delattr</span><span style="color: black;">&#40;</span><span style="color: #008000;">object</span>.<span style="color: #0000cd;">__getattribute__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, <span style="color: #483d8b;">&quot;_obj&quot;</span><span style="color: black;">&#41;</span>, name<span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__setattr__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, name, value<span style="color: black;">&#41;</span>:
        <span style="color: #008000;">setattr</span><span style="color: black;">&#40;</span><span style="color: #008000;">object</span>.<span style="color: #0000cd;">__getattribute__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, <span style="color: #483d8b;">&quot;_obj&quot;</span><span style="color: black;">&#41;</span>, name, value<span style="color: black;">&#41;</span></pre></div></div>

<p>Ca s&#8217;utilise comme ceci :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">class</span> UnObjetOrdinnaire<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
&nbsp;
    attribut = <span style="color: #483d8b;">'VALEUR !'</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> methode<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, param<span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> param <span style="color: #66cc66;">*</span> <span style="color: #ff4500;">2</span>
&nbsp;
&nbsp;
objet_ordinnaire = UnObjetOrdinnaire<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;"># on passe l'objet ordinnaire au proxy</span>
objet_proxy = Proxy<span style="color: black;">&#40;</span>objet_ordinnaire<span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Accéder à des méthodes et attribut</span>
<span style="color: #808080; font-style: italic;"># du proxy accède à ceux de l'objet</span>
<span style="color: #808080; font-style: italic;"># derrière le proxy</span>
<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>objet_proxy.<span style="color: black;">attribut</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;">## VALEUR !</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>objet_proxy.<span style="color: black;">methode</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">3</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;">## 6</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Modifier l'objet proxy modifie</span>
<span style="color: #808080; font-style: italic;"># l'objet derrière le proxy</span>
objet_proxy.<span style="color: black;">attribut</span> = <span style="color: #483d8b;">'une autre valeur'</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>objet_ordinnaire.<span style="color: black;">attribut</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;">## une autre valeur</span></pre></div></div>

<p>Pour un exemple vraiment à l&#8217;épreuve des balles, il faut prendre en compte tout un tas de <a href="http://code.activestate.com/recipes/496741-object-proxying/">cas particuliers</a>, ce qui fait qu&#8217;il est bien plus rentable d&#8217;utiliser une <a href="https://pypi.python.org/pypi/ProxyTypes">lib solide</a> pour ça.</p>
<p><strong>Attention, un objet proxy peut très bien avoir des méthodes qui n&#8217;appellent pas celles de l&#8217;objet derrière. On même avoir des méthodes qui appellent des méthodes qui n&#8217;ont pas le même nom, ou plusieurs méthodes&#8230;</strong> Ce que vous voyez en exemple est un proxy très basique.</p>
<h2>Pourquoi voudrait-on obtenir ce résultat ?</h2>
<p>Plusieurs design patterns font appel à des objets proxy. Par exemple, le design pattern &#8220;adapter&#8221; consiste à créer un objet proxy qui accepte plusieurs types d&#8217;objets en paramètres afin de présenter toujours la même interface.</p>
<p>Imaginez que vous ayez plusieurs objets qui servent à s&#8217;authentifier :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;">&nbsp;
<span style="color: #ff7700;font-weight:bold;">class</span> Login<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
&nbsp;
    _is_logged = <span style="color: #008000;">False</span> 
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> is_logged<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._is_logged
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> login<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, <span style="color: #dc143c;">email</span>, password<span style="color: black;">&#41;</span>:
        <span style="color: #008000;">self</span>._is_logged = <span style="color: #008000;">True</span>
&nbsp;
&nbsp;
<span style="color: #ff7700;font-weight:bold;">class</span> LoginWithUsername<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
&nbsp;
    _is_logged = <span style="color: #008000;">False</span> 
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> is_logged<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._is_logged
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> login<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, username, password<span style="color: black;">&#41;</span>:
        <span style="color: #008000;">self</span>._is_logged = <span style="color: #008000;">True</span>
&nbsp;
&nbsp;
<span style="color: #ff7700;font-weight:bold;">class</span> SignIn<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
&nbsp;
    _is_logged = <span style="color: #008000;">False</span> 
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> is_logged<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._is_logged
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> signin<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, <span style="color: #dc143c;">email</span>, password<span style="color: black;">&#41;</span>:
        <span style="color: #008000;">self</span>._is_logged = <span style="color: #008000;">True</span>
&nbsp;
&nbsp;
<span style="color: #ff7700;font-weight:bold;">class</span> LoginWithKey<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
&nbsp;
    _is_logged = <span style="color: #008000;">False</span> 
&nbsp;
    key = <span style="color: #483d8b;">&quot;jfjkdlmqfjdmqsjdk&quot;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> is_logged<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">self</span>._is_logged
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> login<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, username<span style="color: black;">&#41;</span>:
        <span style="color: #008000;">self</span>._is_logged = <span style="color: #008000;">True</span></pre></div></div>

<p>Et vous avez un algo de parsing, qui attend un objet d&#8217;authentification. Si vous mettez le code qui permet de choisir la bonne API dans l&#8217;algo de parsing, vous liez l&#8217;algo (qui n&#8217;a rien à voir avec l&#8217;authentification) à toutes ces implémentations.</p>
<p>Une des manières de faire, est d&#8217;utiliser un adaptateur, dont  voici une esquisse :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">class</span> AuthAdapter<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
&nbsp;
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__init__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, obj<span style="color: black;">&#41;</span>:
        <span style="color: #008000;">object</span>.<span style="color: #0000cd;">__setattr__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, <span style="color: #483d8b;">&quot;_obj&quot;</span>, obj<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__getattribute__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, name<span style="color: black;">&#41;</span>:
&nbsp;
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            <span style="color: #808080; font-style: italic;"># Si l'attribut existe sur le proxy, on l'utilise</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">object</span>.<span style="color: #0000cd;">__getattribute__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, name<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">AttributeError</span>:
            <span style="color: #808080; font-style: italic;"># Sinon on tente le coup sur l'objet derrière le proxy</span>
            <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">getattr</span><span style="color: black;">&#40;</span><span style="color: #008000;">object</span>.<span style="color: #0000cd;">__getattribute__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, <span style="color: #483d8b;">&quot;_obj&quot;</span><span style="color: black;">&#41;</span>, name<span style="color: black;">&#41;</span>
&nbsp;
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> login<span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, id_=<span style="color: #008000;">None</span>, secret=<span style="color: #008000;">None</span><span style="color: black;">&#41;</span>:
        <span style="color: #808080; font-style: italic;"># Le login est différent pour chaque classe,</span>
        <span style="color: #808080; font-style: italic;"># donc on s'arrange avec.</span>
        <span style="color: #ff7700;font-weight:bold;">try</span>:
            <span style="color: #008000;">self</span>._obj.<span style="color: black;">login</span><span style="color: black;">&#40;</span>id_, secret<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">AttributeError</span>:
            <span style="color: #008000;">self</span>._obj.<span style="color: black;">signin</span><span style="color: black;">&#40;</span>id_, secret<span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">except</span> <span style="color: #008000;">TypeError</span>:
            <span style="color: #008000;">self</span>._obj.<span style="color: black;">login</span><span style="color: black;">&#40;</span>id_<span style="color: black;">&#41;</span></pre></div></div>

<p>En gros, si on essaye d&#8217;appeler <code>login()</code>, il va lisser les contours et nous donner toujours la même interface, même si derrière l&#8217;objet peut marcher complètement différement. En revanche, si on appelle n&#8217;importe quel autre attribut ou méthode (par exemple <code>is_logged</code>, mais il pourrait y en avoir des dizaines d&#8217;autres dans la vrai vie vivante), ça tape directement dans l&#8217;objet derrière le proxy.</p>
<p>Donc si j&#8217;applique l&#8217;adaptateur systématiquement, quelle que soit la classe derrière, le comportement est toujours le même : j&#8217;appelle <code>login(un id, un secret)</code>, et il se logge.</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;">all_auth = <span style="color: black;">&#40;</span>Login, LoginWithUsername, SignIn, LoginWithKey<span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">for</span> auth <span style="color: #ff7700;font-weight:bold;">in</span> all_auth:
    <span style="color: #808080; font-style: italic;"># 'auth' est une des 4 classes de login. On l'instancie et</span>
    <span style="color: #808080; font-style: italic;"># on met l'instance derrière le proxy</span>
    auth = AuthAdapter<span style="color: black;">&#40;</span>auth<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;Testing '%s'&quot;</span> <span style="color: #66cc66;">%</span> auth.__class__.__name__<span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;Is logged : %s&quot;</span> <span style="color: #66cc66;">%</span> auth.<span style="color: black;">is_logged</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
    <span style="color: #808080; font-style: italic;"># Le login se passe toujours de la même manière, quelle que soit la classe</span>
    auth.<span style="color: black;">login</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'id'</span>, <span style="color: #483d8b;">'secret'</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;Is logged after logging : %s&quot;</span> <span style="color: #66cc66;">%</span> auth.<span style="color: black;">is_logged</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></pre></div></div>

<p> Comme d&#8217;habitude, ceci est un exemple naval. Il est bateau quoi. Mais cela vous démontre le principe.</p>
<p> Le design pattern façade ressemble à l&#8217;adapter, en fait c&#8217;est une spécialisation de l&#8217;adapter. Il s&#8217;agit juste d&#8217;exposer une interface plus simple, de l&#8217;objet derrière le proxy.</p>
<p>Un proxy peut aussi servir à hacker une lib. Par exemple, la lib attend un objet d&#8217;une ancienne version d&#8217;une autre lib dont l&#8217;auteur a déprécié un attribut. Avec un proxy, vous pouvez toujours faire semblant que l&#8217;attribut est toujours là : enrobez l&#8217;objet dans un proxy qui possède cet attribut, tout le reste de l&#8217;API sera la même.</p>
<p>Un proxy peut également être utile si vous voulez effectuer des actions quand l&#8217;objet est manipulé.</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">logging</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">class</span> ProxyLogger<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__init__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, obj<span style="color: black;">&#41;</span>:
        <span style="color: #008000;">object</span>.<span style="color: #0000cd;">__setattr__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, <span style="color: #483d8b;">&quot;_obj&quot;</span>, obj<span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">def</span> <span style="color: #0000cd;">__getattribute__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, name<span style="color: black;">&#41;</span>:
        obj = <span style="color: #008000;">object</span>.<span style="color: #0000cd;">__getattribute__</span><span style="color: black;">&#40;</span><span style="color: #008000;">self</span>, <span style="color: #483d8b;">&quot;_obj&quot;</span><span style="color: black;">&#41;</span>
        <span style="color: #808080; font-style: italic;"># On lance un warning à chaque accès à un attribut de l'objet</span>
        <span style="color: #808080; font-style: italic;"># derrière le proxy</span>
        <span style="color: #dc143c;">logging</span>.<span style="color: black;">warning</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;%s.%s has been called&quot;</span> <span style="color: #66cc66;">%</span> <span style="color: black;">&#40;</span>obj.__class__.__name__, name<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">return</span> <span style="color: #008000;">getattr</span><span style="color: black;">&#40;</span>obj, name<span style="color: black;">&#41;</span></pre></div></div>

<p>Maintenant, supposons que vous avez un objet d&#8217;une lib externe (que vous ne pouvez donc pas modifier) sur lequel vous avez besoin d&#8217;infos :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">class</span> ObjetExterne<span style="color: black;">&#40;</span><span style="color: #008000;">object</span><span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">def</span> ahahah<span style="color: black;">&#40;</span><span style="color: #008000;">self</span><span style="color: black;">&#41;</span>:
        <span style="color: #ff7700;font-weight:bold;">pass</span>
&nbsp;
o = ProxyLogger<span style="color: black;">&#40;</span>ObjetExterne<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
o.<span style="color: black;">ahahah</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
<span style="color: #808080; font-style: italic;">## WARNING:root:ObjetExterne.ahahah has been called</span></pre></div></div>

<p>Vous pouvez refiler le proxy à n&#8217;importe quel objet de sa lib d&#8217;origine, si le proxy est bien fait, elle ne vera pas la différence.</p>
<p>On finit sur une note culture, puisque le pattern decorator utilise souvent aussi un proxy. Cette fois d&#8217;une fonction sur un autre objet (en générale une autre fonction). Mais le principe est le même. Donc quand vous voyez <a href="http://sametmax.com/comprendre-les-decorateurs-python-pas-a-pas-partie-1/">@un_decorateur</a>, il est peut être en train d&#8217;appliquer un proxy à la fonction.</p>
<p>D&#8217;ailleurs on dit souvent que le proxy <strong>décore</strong> l&#8217;objet qui est derrière. </p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8076&amp;md5=c70995e246355b07b339e3e26fe0c923" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content>
		<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fun-objet-proxy-ce-que-cest-et-a-quoi-ca-sert%2F&amp;language=en_GB&amp;category=text&amp;title=Un+objet+proxy+%3A+ce+que+c%26%238217%3Best+et+%C3%A0+quoi+%C3%A7a+sert&amp;description=Un+objet+proxy+est+un+objet+qui+prend+un+autre+objet+en+param%C3%A8tre+et+le+sauvegarde+dans+un+de+ses+attributs.+Quand+on+appelle+les+m%C3%A9thodes+du+proxy%2C+le+proxy...&amp;tags=class%2Cobjet%2Cproxy%2Cpython%2Cblog" type="text/html" />
		<link rel="replies" type="text/html" href="http://sametmax.com/un-objet-proxy-ce-que-cest-et-a-quoi-ca-sert/#comments" thr:count="1"/>
		<link rel="replies" type="application/atom+xml" href="http://sametmax.com/un-objet-proxy-ce-que-cest-et-a-quoi-ca-sert/feed/atom/" thr:count="1"/>
		<thr:total>1</thr:total>
	</entry>
		<entry>
		<author>
			<name>Sam</name>
					</author>
		<title type="html"><![CDATA[Python, meilleur nul part, excellent partout]]></title>
		<link rel="alternate" type="text/html" href="http://sametmax.com/python-meilleur-nul-part-excellent-partout/" />
		<id>http://sametmax.com/?p=8328</id>
		<updated>2014-01-31T13:57:51Z</updated>
		<published>2014-01-31T13:57:51Z</published>
		<category scheme="http://sametmax.com" term="Programmation" /><category scheme="http://sametmax.com" term="et python" /><category scheme="http://sametmax.com" term="python" />		<summary type="html"><![CDATA[J'aime Python parce qu'il est très bon à X. Presque tous les X. En fait, il existe très peu de X pour lequel Python n'est pas bon.]]></summary>
		<content type="html" xml:base="http://sametmax.com/python-meilleur-nul-part-excellent-partout/"><![CDATA[<p>Je ne sais pas si vous l&#8217;aviez compris, mais <a href="http://sametmax.com/10-raisons-pour-lesquelles-je-suis-toujours-marie-a-python/">j&#8217;aime bien Python</a>. J&#8217;ai essayé de vous le cacher jusqu&#8217;ici, mais je sais que mon secret ne tiendra pas longtemps, alors j&#8217;avoues tout.</p>
<p>Je n&#8217;aime pas Python parce que c&#8217;est le meilleur langage pour X. Je ne pense pas que Python soit le meilleur langage pour quoi que ce soit. Regex ? Perl est meilleur ? IA ? Lisp est meilleur. Embarqué ? C est meilleur. Asynchrone ? Javascript est meilleur.</p>
<p>Non. J&#8217;aime Python parce qu&#8217;il est très bon à X. Presque tous les X. En fait, il existe très peu de X pour lequel Python n&#8217;est pas bon.</p>
<p>Python est excellent pour analyser du texte, pour faire un site Web (même asynchrone), de l&#8217;administration système, des interfaces graphiques, du calcul scientifique, de la 3D, des crawlers, etc. Pas le meilleur. Mais très bon.</p>
<p>Et ceci est fantastique. Cela veut dire que si je commence un projet, n&#8217;importe quel projet, je sais que je peux le commencer en Python. Je ne serai pas bloqué plus tard par tel ou tel besoin. Je sais que je pourrai m&#8217;en sortir agréablement avec Python.</p>
<p>Vous faites un site en JS ? Pour le sysadmin, il va falloir un autre langage.</p>
<p>Des scripts de maintenance en Perl ? J&#8217;espère que vous n&#8217;aurez pas besoin d&#8217;une UI.</p>
<p>Un crawler en PHP ? Pour l&#8217;analyse des données récupérer, vous aller vous amuser&#8230;</p>
<p>De l&#8217;extraction de data en Ruby ? Pourvu qu&#8217;il ne faille pas traiter plusieurs To.</p>
<p>Ce n&#8217;est pas que vous ne pourrez pas. Ils sont tous Turring complet après tout. Mais vous allez vraiment galérer.</p>
<p>Aucun langage n&#8217;est parfait, et Python n&#8217;est pas une exception. </p>
<p>Mais ce qui est génial, c&#8217;est que dans 90% des cas, vous pouvez avoir une solution propre et efficace en Python au problématique que vous ne savez même pas encore que vous aurez. Et le jour où vous atteindrez la limite, alors oui, vous pourrez utiliser une autre techno pour le faire. Mais juste pour cette partie. La plupart du temps ce sera une partie très réduite. En en plus, Python pourra probablement s&#8217;interfacer nativement avec le code de l&#8217;autre langage.</p>
<p>Il y a des tas de raisons de ne pas choisir Python bien entendu, mais probablement la meilleure raison de le choisir, c&#8217;est qu&#8217;il y a peu de chance de se planter.</p>
<p>Bon, évidement si vous voulez écrire un driver de carte graphique&#8230;</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8328&amp;md5=b40c02594ee4a3fe706c3f4f7474a092" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content>
		<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fpython-meilleur-nul-part-excellent-partout%2F&amp;language=en_GB&amp;category=text&amp;title=Python%2C+meilleur+nul+part%2C+excellent+partout&amp;description=Je+ne+sais+pas+si+vous+l%26%238217%3Baviez+compris%2C+mais+j%26%238217%3Baime+bien+Python.+J%26%238217%3Bai+essay%C3%A9+de+vous+le+cacher+jusqu%26%238217%3Bici%2C+mais+je+sais+que+mon+secret+ne+tiendra+pas+longtemps%2C+alors...&amp;tags=et+python%2Cpython%2Cblog" type="text/html" />
		<link rel="replies" type="text/html" href="http://sametmax.com/python-meilleur-nul-part-excellent-partout/#comments" thr:count="26"/>
		<link rel="replies" type="application/atom+xml" href="http://sametmax.com/python-meilleur-nul-part-excellent-partout/feed/atom/" thr:count="26"/>
		<thr:total>26</thr:total>
	</entry>
		<entry>
		<author>
			<name>Sam</name>
					</author>
		<title type="html"><![CDATA[ERROR:  invalid locale name avec PostGres]]></title>
		<link rel="alternate" type="text/html" href="http://sametmax.com/error-invalid-locale-name-avec-postgres/" />
		<id>http://sametmax.com/?p=8743</id>
		<updated>2014-01-30T13:12:02Z</updated>
		<published>2014-01-30T13:12:02Z</published>
		<category scheme="http://sametmax.com" term="Administration System" /><category scheme="http://sametmax.com" term="locale" /><category scheme="http://sametmax.com" term="posgres" />		<summary type="html"><![CDATA[Oui, j'avais besoin d'un poste bouche-trou.]]></summary>
		<content type="html" xml:base="http://sametmax.com/error-invalid-locale-name-avec-postgres/"><![CDATA[<p>Il suffit de redémarrer PostGres.</p>
<p>Ca arrive quand on met à jour ses locales et que des services tournent. Ils ne reçoivent pas l&#8217;information, et utilisent l&#8217;ancienne locale.</p>
<p>Oui, j&#8217;avais besoin d&#8217;un poste bouche-trou.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8743&amp;md5=a3e3d51b364d4cb9428bd1922787d2e5" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content>
		<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Ferror-invalid-locale-name-avec-postgres%2F&amp;language=en_GB&amp;category=text&amp;title=ERROR%3A++invalid+locale+name+avec+PostGres&amp;description=Il+suffit+de+red%C3%A9marrer+PostGres.+Ca+arrive+quand+on+met+%C3%A0+jour+ses+locales+et+que+des+services+tournent.+Ils+ne+re%C3%A7oivent+pas+l%26%238217%3Binformation%2C+et+utilisent+l%26%238217%3Bancienne+locale.+Oui%2C+j%26%238217%3Bavais...&amp;tags=locale%2Cposgres%2Cblog" type="text/html" />
		<link rel="replies" type="text/html" href="http://sametmax.com/error-invalid-locale-name-avec-postgres/#comments" thr:count="8"/>
		<link rel="replies" type="application/atom+xml" href="http://sametmax.com/error-invalid-locale-name-avec-postgres/feed/atom/" thr:count="8"/>
		<thr:total>8</thr:total>
	</entry>
		<entry>
		<author>
			<name>Sam</name>
					</author>
		<title type="html"><![CDATA[Solution de l&#8217;exercice d&#8217;hier sur shadow]]></title>
		<link rel="alternate" type="text/html" href="http://sametmax.com/solution-de-lexercice-dhier-sur-shadow/" />
		<id>http://sametmax.com/?p=8917</id>
		<updated>2014-01-29T15:28:19Z</updated>
		<published>2014-01-29T15:25:53Z</published>
		<category scheme="http://sametmax.com" term="Programmation" /><category scheme="http://sametmax.com" term="exercice" /><category scheme="http://sametmax.com" term="password" /><category scheme="http://sametmax.com" term="python" /><category scheme="http://sametmax.com" term="unix" />		<summary type="html"><![CDATA[Ça va de soit, mais ça va mieux en le disant, ceci n'est pas la solution unique, mais une solution possible parmi d'autres.]]></summary>
		<content type="html" xml:base="http://sametmax.com/solution-de-lexercice-dhier-sur-shadow/"><![CDATA[<p>Ça va de soit, mais ça va mieux en le disant, ceci n&#8217;est pas la solution unique de l&#8217;<a href="http://sametmax.com/cest-lheure-de-faire-de-lexercice/#comment-19118">exercice d&#8217;hier</a>, mais une solution possible parmi d&#8217;autres.</p>
<p>On note l&#8217;usage de <a href="http://docs.python.org/2/library/crypt.html?highlight=crypt#crypt">crypt</a>, qui évite de se faire chier à trouver le bon algo de hashing et gère le salt automatiquement. <a href="http://docs.python.org/2/library/spwd.html?highlight=spwd#spwd">spwd</a>, c&#8217;est vraiment pour le grosses larves comme moi qui veulent même pas faire un <code>split</code>.</p>
<p>Et c&#8217;est du Python 3, yo dog !</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> io
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">os</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">crypt</span>
<span style="color: #ff7700;font-weight:bold;">import</span> spwd
&nbsp;
<span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">urllib</span>.<span style="color: black;">request</span> <span style="color: #ff7700;font-weight:bold;">import</span> FancyURLopener
<span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">zipfile</span> <span style="color: #ff7700;font-weight:bold;">import</span> ZipFile
&nbsp;
PASSWORDS_SOURCE = <span style="color: #483d8b;">&quot;http://xato.net/files/10k%20most%20common.zip&quot;</span>
PASSWORDS_LIST = <span style="color: #483d8b;">'10k most common.txt'</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Le fichier ZIP est derrière cloudflare, qui vous ferme la porte au nez si</span>
<span style="color: #808080; font-style: italic;"># vous n'avez pas de User-Agent. On va donc créer un UrlOpener, un objet qui</span>
<span style="color: #808080; font-style: italic;"># ouvre des ressources en utilisant leurs URLs, qui a un User-Agent 'TA MERE'.</span>
<span style="color: #808080; font-style: italic;"># CloudFlare ne check pas que le UA est valide.</span>
<span style="color: #ff7700;font-weight:bold;">class</span> FFOpener<span style="color: black;">&#40;</span>FancyURLopener<span style="color: black;">&#41;</span>:
   version = <span style="color: #483d8b;">'TA MERE'</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># Si le dictionnaire de passwords n'est pas là, on le télécharge</span>
<span style="color: #808080; font-style: italic;"># via FFOpener().open(PASSWORDS_SOURCE).read(). C'est verbeux, c'est urllib.</span>
<span style="color: #808080; font-style: italic;"># Normalement je ferais ça avec requests. Ensuite on lui donne une interface</span>
<span style="color: #808080; font-style: italic;"># file-like object avec io.BytesIO pour que ZipFile puisse le traiter en mémoire</span>
<span style="color: #808080; font-style: italic;"># sans avoir à le sauvegarder dans un vrai fichier sur le disque, et on</span>
<span style="color: #808080; font-style: italic;"># extrait le ZIP.</span>
<span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #dc143c;">os</span>.<span style="color: black;">path</span>.<span style="color: black;">isfile</span><span style="color: black;">&#40;</span>PASSWORDS_LIST<span style="color: black;">&#41;</span>:
    ZipFile<span style="color: black;">&#40;</span>io.<span style="color: black;">BytesIO</span><span style="color: black;">&#40;</span>FFOpener<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>.<span style="color: #008000;">open</span><span style="color: black;">&#40;</span>PASSWORDS_SOURCE<span style="color: black;">&#41;</span>.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>.<span style="color: black;">extractall</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># On extrait les mots de passe de la liste sous forme de tuple car c'est rapide</span>
<span style="color: #808080; font-style: italic;"># à lire. Un petit rstrip vire les sauts de ligne.</span>
passwords = <span style="color: #008000;">tuple</span><span style="color: black;">&#40;</span>l.<span style="color: black;">rstrip</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span> <span style="color: #ff7700;font-weight:bold;">for</span> l <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">open</span><span style="color: black;">&#40;</span>PASSWORDS_LIST<span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;"># spwd.getspall() nous évite de parser le fichier shadow à la main.</span>
<span style="color: #ff7700;font-weight:bold;">for</span> entry <span style="color: #ff7700;font-weight:bold;">in</span> spwd.<span style="color: black;">getspall</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>:
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'Processing password for user &quot;%s&quot;: '</span> <span style="color: #66cc66;">%</span> entry.<span style="color: black;">sp_nam</span>, end=<span style="color: #483d8b;">''</span><span style="color: black;">&#41;</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># Pas de hash ? On gagne du temps avec 'continue'</span>
    <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #ff7700;font-weight:bold;">not</span> <span style="color: #483d8b;">'$'</span> <span style="color: #ff7700;font-weight:bold;">in</span> entry.<span style="color: black;">sp_pwd</span>:
        <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'no password hash to process.'</span><span style="color: black;">&#41;</span>
        <span style="color: #ff7700;font-weight:bold;">continue</span>
&nbsp;
    <span style="color: #808080; font-style: italic;"># On teste chaque password avec la fonction crypt, qui accepte en deuxième</span>
    <span style="color: #808080; font-style: italic;"># paramètre le hash du mot de passe complet. Pas besoin de se faire chier</span>
    <span style="color: #808080; font-style: italic;"># à le spliter, il va analyser les '$' et se démerder avec ça. On a juste</span>
    <span style="color: #808080; font-style: italic;"># à comparer le résultat avec le hash d'origine.</span>
    <span style="color: #ff7700;font-weight:bold;">for</span> <span style="color: #dc143c;">pwd</span> <span style="color: #ff7700;font-weight:bold;">in</span> passwords:
        <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #dc143c;">crypt</span>.<span style="color: #dc143c;">crypt</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">pwd</span>, entry.<span style="color: black;">sp_pwd</span><span style="color: black;">&#41;</span> == entry.<span style="color: black;">sp_pwd</span>:
            <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'password is &quot;%s&quot;.'</span> <span style="color: #66cc66;">%</span> <span style="color: #dc143c;">pwd</span><span style="color: black;">&#41;</span>
            <span style="color: #808080; font-style: italic;"># On break pour gagner quelques tours de boucles, et pouvoir</span>
            <span style="color: #808080; font-style: italic;"># utiliser la condition 'else'.</span>
            <span style="color: #ff7700;font-weight:bold;">break</span>
    <span style="color: #ff7700;font-weight:bold;">else</span>:
        <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'fail to break password.'</span><span style="color: black;">&#41;</span></pre></div></div>

<p><a href="https://github.com/sametmax/codes-des-articles/blob/master/2014/janvier/crack_shadow.py">Télécharger le code.</a></p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8917&amp;md5=a1783918d5efb8552ac4659f4ae50c32" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content>
		<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fsolution-de-lexercice-dhier-sur-shadow%2F&amp;language=en_GB&amp;category=text&amp;title=Solution+de+l%26%238217%3Bexercice+d%26%238217%3Bhier+sur+shadow&amp;description=%C3%87a+va+de+soit%2C+mais+%C3%A7a+va+mieux+en+le+disant%2C+ceci+n%26%238217%3Best+pas+la+solution+unique+de+l%26%238217%3Bexercice+d%26%238217%3Bhier%2C+mais+une+solution+possible+parmi+d%26%238217%3Bautres.+On+note+l%26%238217%3Busage+de...&amp;tags=exercice%2Cpassword%2Cpython%2Cunix%2Cblog" type="text/html" />
		<link rel="replies" type="text/html" href="http://sametmax.com/solution-de-lexercice-dhier-sur-shadow/#comments" thr:count="9"/>
		<link rel="replies" type="application/atom+xml" href="http://sametmax.com/solution-de-lexercice-dhier-sur-shadow/feed/atom/" thr:count="9"/>
		<thr:total>9</thr:total>
	</entry>
		<entry>
		<author>
			<name>Sam</name>
					</author>
		<title type="html"><![CDATA[C&#8217;est l&#8217;heure de faire de l&#8217;exercice]]></title>
		<link rel="alternate" type="text/html" href="http://sametmax.com/cest-lheure-de-faire-de-lexercice/" />
		<id>http://sametmax.com/?p=8910</id>
		<updated>2014-02-05T11:37:03Z</updated>
		<published>2014-01-28T16:19:48Z</published>
		<category scheme="http://sametmax.com" term="Programmation" /><category scheme="http://sametmax.com" term="bcrypt" /><category scheme="http://sametmax.com" term="mot de pass" /><category scheme="http://sametmax.com" term="password" /><category scheme="http://sametmax.com" term="python" /><category scheme="http://sametmax.com" term="sha" /><category scheme="http://sametmax.com" term="unix" />		<summary type="html"><![CDATA[Créer un script de brute force de passwords Unix par dictionnaire.]]></summary>
		<content type="html" xml:base="http://sametmax.com/cest-lheure-de-faire-de-lexercice/"><![CDATA[<p>Le <a href="http://sametmax.com/petit-exercice-en-python/">dernier exercice</a> avait bien été apprécié, alors je remet ça.</p>
<p>Consigne :</p>
<p><em><br />
Créer un script de brute force de passwords Unix par dictionnaire.</p>
<p>Puisqu&#8217;on est pas non plus des Kevin Mitnick en puissance, on va supposer que vous êtes connectés sur la machine, que vous avez les droits root dessus et que vous avez localisé les mots de passe comme étant dans &#8220;/etc/shadow&#8221;.</p>
<p>Votre script va vérifier si il possède un dictionnaire de mots de passe. Si ce n&#8217;est pas le cas, il va télécharger celui-ci et le décompresser : <a href="http://xato.net/files/10k%20most%20common.zip">http://xato.net/files/10k%20most%20common.zip.</a></p>
<p>Ensuite vous parcourez le fichier shadow, et vous essayez de trouver quel mot de passe se cache  derrière chaque hash. Si il n&#8217;y a pas de hash, vous pouvez ignorer l&#8217;utilisateur.</p>
<p>Exemple de sortie:</p>
<pre>
Processing password for user "root": no password hash to process.
Processing password for user "daemon": no password hash to process.
Processing password for user "bin": no password hash to process.
Processing password for user "sys": no password hash to process.
Processing password for user "www-data": no password hash to process.
Processing password for user "sam": fail to break password.
Processing password for user "test": password is "cheese".
Processing password for user "messagebus": no password hash to process.
Processing password for user "avahi-autoipd": no password hash to process.
Processing password for user "avahi": no password hash to process.
...</pre>
<p></em></p>
<p>Afin de simplifier l&#8217;exercice, il n&#8217;est pas demandé de gestion d&#8217;erreur ou de passage en a paramètre du script.</p>
<p>Comme d&#8217;habitude, il n&#8217;y a pas de solution ultimate de la mort qui tue, c&#8217;est juste pour le fun.</p>
<p><a href="http://sametmax.com/solution-de-lexercice-dhier-sur-shadow/">La soluce demain.</a></p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8910&amp;md5=31cd416f11850ac5dcbd198c2c995342" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content>
		<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fcest-lheure-de-faire-de-lexercice%2F&amp;language=en_GB&amp;category=text&amp;title=C%26%238217%3Best+l%26%238217%3Bheure+de+faire+de+l%26%238217%3Bexercice&amp;description=Le+dernier+exercice+avait+bien+%C3%A9t%C3%A9+appr%C3%A9ci%C3%A9%2C+alors+je+remet+%C3%A7a.+Consigne+%3A+Cr%C3%A9er+un+script+de+brute+force+de+passwords+Unix+par+dictionnaire.+Puisqu%26%238217%3Bon+est+pas+non+plus+des...&amp;tags=bcrypt%2Cmot+de+pass%2Cpassword%2Cpython%2Csha%2Cunix%2Cblog" type="text/html" />
		<link rel="replies" type="text/html" href="http://sametmax.com/cest-lheure-de-faire-de-lexercice/#comments" thr:count="28"/>
		<link rel="replies" type="application/atom+xml" href="http://sametmax.com/cest-lheure-de-faire-de-lexercice/feed/atom/" thr:count="28"/>
		<thr:total>28</thr:total>
	</entry>
		<entry>
		<author>
			<name>Sam</name>
					</author>
		<title type="html"><![CDATA[Cog, l&#8217;anti langage de template Python]]></title>
		<link rel="alternate" type="text/html" href="http://sametmax.com/cog-lanti-langage-de-template-python/" />
		<id>http://sametmax.com/?p=8903</id>
		<updated>2014-01-27T17:45:38Z</updated>
		<published>2014-01-27T17:45:38Z</published>
		<category scheme="http://sametmax.com" term="Programmation" /><category scheme="http://sametmax.com" term="cog" /><category scheme="http://sametmax.com" term="python" /><category scheme="http://sametmax.com" term="template" />		<summary type="html"><![CDATA[<a href="http://nedbatchelder.com/code/cog/">Cog</a> est un outil Python en ligne de commande qui permet d'insérer du code Python dans un fichier, afin qu'il génère une partie de ce fichier]]></summary>
		<content type="html" xml:base="http://sametmax.com/cog-lanti-langage-de-template-python/"><![CDATA[<p><a href="http://nedbatchelder.com/code/cog/">Cog</a> est un outil Python en ligne de commande qui permet d&#8217;insérer du code Python dans un fichier, afin qu&#8217;il génère une partie de ce fichier.</p>
<p>A priori, ça ressemble à un langage de template. Là où ça diffère, c&#8217;est que cog ne cherche pas à générer un fichier différent, il insère le code généré dans le fichier original, et garde le code de génération.</p>
<p>Exemple, vous avez envie d&#8217;insérer un warning en haut de plusieurs fichiers de code. Vos choix :</p>
<ul>
<li>Copier-coller le warning.</li>
<li>Créer un script de build qui insère le warning.</li>
</ul>
<p>L&#8217;alternative des bricoleurs qui ont juste besoin de quelques insertions, c&#8217;est Cog. Par exemple, votre fichier contient :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;"># [[[cog for l in open('warning.txt'): cog.out(&quot;# &quot; + l) ]]]</span>
<span style="color: #808080; font-style: italic;"># [[[end]]]</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">import</span> vostrucs
&nbsp;
vostrucs.<span style="color: black;">faire_vos_machins</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></div></div>

<p>Après un <code>cog.py -r votre_fichier.py</code>, votre fichier sera :</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;"># [[[cog for l in open('warning.txt'): cog.out(&quot;# &quot; + l) ]]]</span>
<span style="color: #808080; font-style: italic;"># Attention, ceci est un avertissmement super important.</span>
<span style="color: #808080; font-style: italic;"># Ce logiciel ne vient avec aucune garantie. Il vomira dans votre salon.</span>
<span style="color: #808080; font-style: italic;"># Violera votre femme, lui collera l'hépatite C et offrira un CD de one direction</span>
<span style="color: #808080; font-style: italic;"># à vos enfants.</span>
<span style="color: #808080; font-style: italic;"># [[[end]]]</span>
&nbsp;
<span style="color: #ff7700;font-weight:bold;">import</span> vostrucs
&nbsp;
vostrucs.<span style="color: black;">faire_vos_machins</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre></div></div>

<p>cog vient avec plusieurs options, par exemple la possibilité de retirer le code de génération ou de lire le précédent texte généré depuis le code de génération.</p>
<p>La véritable force de l&#8217;outil c&#8217;est qu&#8217;il peut utiliser n&#8217;importe quel module Python, et donc générer du texte à partir d&#8217;un contenu en ligne ou un fichier CSV. Il est d&#8217;ailleurs né parce que l&#8217;auteur était codeur C et avait besoin de générer du code à partir d&#8217;un fichier XML.</p>
<p>Le seul défaut de Cog, c&#8217;est que c&#8217;est verbeux. Et moche.</p>
 <p><a href="http://sametmax.com/?flattrss_redirect&amp;id=8903&amp;md5=c0ca287d24dbc08e6b0640087a6ec7fa" title="Flattr" target="_blank"><img src="http://sametmax.com/wp-content/plugins/flattr/img/flattr-badge-large.png" alt="flattr this!"/></a></p>]]></content>
		<link rel="payment" title="Flattr this!" href="https://flattr.com/submit/auto?user_id=sam_et_max&amp;popout=1&amp;url=http%3A%2F%2Fsametmax.com%2Fcog-lanti-langage-de-template-python%2F&amp;language=en_GB&amp;category=text&amp;title=Cog%2C+l%26%238217%3Banti+langage+de+template+Python&amp;description=Cog+est+un+outil+Python+en+ligne+de+commande+qui+permet+d%26%238217%3Bins%C3%A9rer+du+code+Python+dans+un+fichier%2C+afin+qu%26%238217%3Bil+g%C3%A9n%C3%A8re+une+partie+de+ce+fichier.+A+priori%2C+%C3%A7a+ressemble...&amp;tags=cog%2Cpython%2Ctemplate%2Cblog" type="text/html" />
		<link rel="replies" type="text/html" href="http://sametmax.com/cog-lanti-langage-de-template-python/#comments" thr:count="4"/>
		<link rel="replies" type="application/atom+xml" href="http://sametmax.com/cog-lanti-langage-de-template-python/feed/atom/" thr:count="4"/>
		<thr:total>4</thr:total>
	</entry>
	</feed>

<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
		>
<channel>
	<title>Comments on: Mesurer les performances d&#8217;un snippet Python</title>
	<atom:link href="http://sametmax.com/mesurer-les-performances-dun-snippet-python/feed/" rel="self" type="application/rss+xml" />
	<link>http://sametmax.com/mesurer-les-performances-dun-snippet-python/</link>
	<description>Deux développeurs en vadrouille qui se sortent les doigts du code</description>
	<lastBuildDate>Mon, 02 Dec 2013 10:54:05 +0000</lastBuildDate>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>http://wordpress.org/?v=3.3.1</generator>
	<item>
		<title>By: Etienne</title>
		<link>http://sametmax.com/mesurer-les-performances-dun-snippet-python/#comment-10013</link>
		<dc:creator>Etienne</dc:creator>
		<pubDate>Wed, 12 Jun 2013 12:17:59 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=6369#comment-10013</guid>
		<description>@ Badeu
T&#039;as raison, l&#039;opcode est pas identique.

Mais il y a un problème avec:
&lt;code&gt;## Long dictionaries
## Default merge strategy
## 1 54.5233860016
## 3 70.213809967&lt;/code&gt;

Chez moi c&#039;est plutôt de l&#039;ordre de :
&lt;code&gt;## Long dictionaries
## Default merge strategy
## 1 78.3221180439
## 3 77.8049631119&lt;/code&gt;
Un léger avantage pour dmerge3</description>
		<content:encoded><![CDATA[<p>@ Badeu<br />
T&#8217;as raison, l&#8217;opcode est pas identique.</p>
<p>Mais il y a un problème avec:<br />
<code>## Long dictionaries<br />
## Default merge strategy<br />
## 1 54.5233860016<br />
## 3 70.213809967</code></p>
<p>Chez moi c&#8217;est plutôt de l&#8217;ordre de :<br />
<code>## Long dictionaries<br />
## Default merge strategy<br />
## 1 78.3221180439<br />
## 3 77.8049631119</code><br />
Un léger avantage pour dmerge3</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Badeu</title>
		<link>http://sametmax.com/mesurer-les-performances-dun-snippet-python/#comment-10008</link>
		<dc:creator>Badeu</dc:creator>
		<pubDate>Wed, 12 Jun 2013 10:05:43 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=6369#comment-10008</guid>
		<description>Quand on regarde d&#039;un peu plus près au code généré, il n&#039;est pas tout à fait identique entre &lt;em&gt;dmerge1&lt;/em&gt; et &lt;em&gt;dmerge3&lt;/em&gt;. 

pour &lt;em&gt;dmerge1&lt;/em&gt;, &lt;em&gt;d&lt;/em&gt; est accédé avec des &lt;strong&gt;LOAD_DEREF&lt;/strong&gt; et &lt;strong&gt;STORE_DEREF&lt;/strong&gt;, pour &lt;em&gt;dmerge3&lt;/em&gt; avec des &lt;strong&gt;LOAD_FAST&lt;/strong&gt; et &lt;strong&gt;STORE_FAST&lt;/strong&gt; Ce qui semble logique vu que le générateur fait une closure sur &lt;em&gt;d&lt;/em&gt; dans &lt;em&gt;dmerge1&lt;/em&gt;.

Je reste juste étonné de l&#039;impact que ça a.</description>
		<content:encoded><![CDATA[<p>Quand on regarde d&#8217;un peu plus près au code généré, il n&#8217;est pas tout à fait identique entre <em>dmerge1</em> et <em>dmerge3</em>. </p>
<p>pour <em>dmerge1</em>, <em>d</em> est accédé avec des <strong>LOAD_DEREF</strong> et <strong>STORE_DEREF</strong>, pour <em>dmerge3</em> avec des <strong>LOAD_FAST</strong> et <strong>STORE_FAST</strong> Ce qui semble logique vu que le générateur fait une closure sur <em>d</em> dans <em>dmerge1</em>.</p>
<p>Je reste juste étonné de l&#8217;impact que ça a.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: kontre</title>
		<link>http://sametmax.com/mesurer-les-performances-dun-snippet-python/#comment-9984</link>
		<dc:creator>kontre</dc:creator>
		<pubDate>Tue, 11 Jun 2013 17:24:19 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=6369#comment-9984</guid>
		<description>My bad, j&#039;ai bêtement zappé un return.
[mauvaise foi] Mais aussi la bonne pratique de n&#039;avoir qu&#039;un point de sortie n&#039;est pas respectée, on s&#039;y perd ! [/mauvaise foi]</description>
		<content:encoded><![CDATA[<p>My bad, j&#8217;ai bêtement zappé un return.<br />
[mauvaise foi] Mais aussi la bonne pratique de n&#8217;avoir qu&#8217;un point de sortie n&#8217;est pas respectée, on s&#8217;y perd ! [/mauvaise foi]</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Etienne</title>
		<link>http://sametmax.com/mesurer-les-performances-dun-snippet-python/#comment-9954</link>
		<dc:creator>Etienne</dc:creator>
		<pubDate>Tue, 11 Jun 2013 10:41:14 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=6369#comment-9954</guid>
		<description>@ Kontre, Badeu

Comme il s&#039;agit de la &quot;Default merge strategy&quot;, le code passe pas par le générateur de &lt;code&gt;dmerge1&lt;/code&gt; ou le &lt;code&gt;for&lt;/code&gt; de &lt;code&gt;dmerge3&lt;/code&gt;. Donc le problème est pas là.

J&#039;ai essayé ça avec le code copié ci-dessus (les versions avec les expressions génératrices):
&lt;pre lang=&quot;python&quot;&gt;if __name__ == &quot;__main__&quot;:
    import random
    import timeit

    print(&#039;Generate test dicts&#039;)
    d3 = {random.randint(0, 10000000): &#039;d1&#039; for x in xrange(1000000)}
    d4 = {random.randint(0, 10000000): &#039;d2&#039; for x in xrange(1000000)}
    print(&quot;Start timing&quot;)
    setup = &#039;&#039;&#039;from __main__ import (dmerge1, dmerge2, dmerge3, dmerge4,
       d3, d4)&#039;&#039;&#039;
    print (&quot;Long dictionaries&quot;)
    print (&quot;Default merge strategy&quot;)
    print (&quot;1&quot;, timeit.timeit(&quot;dmerge1(d3, d4)&quot;, setup=setup, number=100))
    print (&quot;3&quot;, timeit.timeit(&quot;dmerge3(d3, d4)&quot;, setup=setup, number=100))

## Generate test dicts
## Start timing
## Long dictionaries
## Default merge strategy
## 1 79.4722130299
## 3 79.2059469223&lt;/pre&gt;
Les résultats sont identiques (ouf...). Donc le problème est de ton côté: soit le code des deux fonctions est pas identique, soit les conditions des deux tests sont pas les mêmes.</description>
		<content:encoded><![CDATA[<p>@ Kontre, Badeu</p>
<p>Comme il s&#8217;agit de la &#8220;Default merge strategy&#8221;, le code passe pas par le générateur de <code>dmerge1</code> ou le <code>for</code> de <code>dmerge3</code>. Donc le problème est pas là.</p>
<p>J&#8217;ai essayé ça avec le code copié ci-dessus (les versions avec les expressions génératrices):</p>

<div class="wp_syntax"><div class="code"><pre class="python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">if</span> __name__ == <span style="color: #483d8b;">&quot;__main__&quot;</span>:
    <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">random</span>
    <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">timeit</span>
&nbsp;
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'Generate test dicts'</span><span style="color: black;">&#41;</span>
    d3 = <span style="color: black;">&#123;</span><span style="color: #dc143c;">random</span>.<span style="color: black;">randint</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">10000000</span><span style="color: black;">&#41;</span>: <span style="color: #483d8b;">'d1'</span> <span style="color: #ff7700;font-weight:bold;">for</span> x <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">xrange</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1000000</span><span style="color: black;">&#41;</span><span style="color: black;">&#125;</span>
    d4 = <span style="color: black;">&#123;</span><span style="color: #dc143c;">random</span>.<span style="color: black;">randint</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">10000000</span><span style="color: black;">&#41;</span>: <span style="color: #483d8b;">'d2'</span> <span style="color: #ff7700;font-weight:bold;">for</span> x <span style="color: #ff7700;font-weight:bold;">in</span> <span style="color: #008000;">xrange</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1000000</span><span style="color: black;">&#41;</span><span style="color: black;">&#125;</span>
    <span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;Start timing&quot;</span><span style="color: black;">&#41;</span>
    setup = <span style="color: #483d8b;">''</span><span style="color: #483d8b;">'from __main__ import (dmerge1, dmerge2, dmerge3, dmerge4,
       d3, d4)'</span><span style="color: #483d8b;">''</span>
    <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;Long dictionaries&quot;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;Default merge strategy&quot;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;1&quot;</span>, <span style="color: #dc143c;">timeit</span>.<span style="color: #dc143c;">timeit</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;dmerge1(d3, d4)&quot;</span>, setup=setup, number=<span style="color: #ff4500;">100</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">print</span> <span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;3&quot;</span>, <span style="color: #dc143c;">timeit</span>.<span style="color: #dc143c;">timeit</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;dmerge3(d3, d4)&quot;</span>, setup=setup, number=<span style="color: #ff4500;">100</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span>
&nbsp;
<span style="color: #808080; font-style: italic;">## Generate test dicts</span>
<span style="color: #808080; font-style: italic;">## Start timing</span>
<span style="color: #808080; font-style: italic;">## Long dictionaries</span>
<span style="color: #808080; font-style: italic;">## Default merge strategy</span>
<span style="color: #808080; font-style: italic;">## 1 79.4722130299</span>
<span style="color: #808080; font-style: italic;">## 3 79.2059469223</span></pre></div></div>

<p>Les résultats sont identiques (ouf&#8230;). Donc le problème est de ton côté: soit le code des deux fonctions est pas identique, soit les conditions des deux tests sont pas les mêmes.</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: kontre</title>
		<link>http://sametmax.com/mesurer-les-performances-dun-snippet-python/#comment-9932</link>
		<dc:creator>kontre</dc:creator>
		<pubDate>Mon, 10 Jun 2013 21:14:24 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=6369#comment-9932</guid>
		<description>C&#039;est le même algo mais ça ne fait pas la même chose : les générateurs sont plus rapides que les boucles for génériques. C&#039;est relativement logique : c&#039;est moins général, il y a moins de cas différents, donc on peut plus optimiser.

On a toujours des surprises avec le profiling...</description>
		<content:encoded><![CDATA[<p>C&#8217;est le même algo mais ça ne fait pas la même chose : les générateurs sont plus rapides que les boucles for génériques. C&#8217;est relativement logique : c&#8217;est moins général, il y a moins de cas différents, donc on peut plus optimiser.</p>
<p>On a toujours des surprises avec le profiling&#8230;</p>
]]></content:encoded>
	</item>
	<item>
		<title>By: Badeu</title>
		<link>http://sametmax.com/mesurer-les-performances-dun-snippet-python/#comment-9921</link>
		<dc:creator>Badeu</dc:creator>
		<pubDate>Mon, 10 Jun 2013 09:40:19 +0000</pubDate>
		<guid isPermaLink="false">http://sametmax.com/?p=6369#comment-9921</guid>
		<description>Moralité, la prochaine fois je pousserai pas du code écrit en 10 secondes et pas testé.

Par contre un truc me turlupine toujours. Parce qu&#039;au final en réessayant d&#039;optimiser après la première série de tests de perf sur github, je suis aussi arrivé à la solution du deuxième dmerge1 (et je me disais putain ça va tout arracher c&#039;est obligatoire !! quelle naiveté)

&lt;code&gt;
## Long dictionaries
## Default merge strategy
## 1 54.5233860016
## 3 70.213809967
&lt;/code&gt;

WTF ?! J&#039;ai exécuté les tests de performances un paquet de fois, et ça se vérifie toujours. Pourtant dans ce cas, le code de dmerge1 et dmerge3 est identique.</description>
		<content:encoded><![CDATA[<p>Moralité, la prochaine fois je pousserai pas du code écrit en 10 secondes et pas testé.</p>
<p>Par contre un truc me turlupine toujours. Parce qu&#8217;au final en réessayant d&#8217;optimiser après la première série de tests de perf sur github, je suis aussi arrivé à la solution du deuxième dmerge1 (et je me disais putain ça va tout arracher c&#8217;est obligatoire !! quelle naiveté)</p>
<p><code><br />
## Long dictionaries<br />
## Default merge strategy<br />
## 1 54.5233860016<br />
## 3 70.213809967<br />
</code></p>
<p>WTF ?! J&#8217;ai exécuté les tests de performances un paquet de fois, et ça se vérifie toujours. Pourtant dans ce cas, le code de dmerge1 et dmerge3 est identique.</p>
]]></content:encoded>
	</item>
</channel>
</rss>
